
<body>
  <div class="container">
<link rel="stylesheet" href="style.css">


<h1 id="setting-up">Setting Up</h1>
<h2 id="introduction">Introduction</h2>
<hr>
<p>Before beginning any penetration testing engagement, it is essential to set up a reliable and efficient working environment. This involves organizing tools, configuring systems, and ensuring that all necessary resources are ready for use. By establishing a well-structured testing infrastructure early on, we can reduce downtime, minimize errors, and streamline the assessment process. In this module, we will explore the foundational technologies and configurations that support this goal, focusing on virtualization and setting up the proper environment for our testing activities.</p>
<p>Assume that our company was commissioned by a new customer (Inlanefreight) to perform an external and internal penetration test. As already mentioned, proper Operating System preparation is required before conducting any penetration test. Our customer provides us with internal systems that we should prepare before the engagement so that the penetration testing activities commence without delays. For this, we have to prepare the necessary operating systems accordingly and efficiently.</p>
<hr>
<h3 id="penetration-testing-stages-situations">Penetration Testing Stages &amp; Situations</h3>
<p>Every penetration test is different in terms of scope, expected results, and environment, depending on the customer&#39;s service line and infrastructure. Apart from the different penetration testing stages we usually go through; our activities can vary depending on the type of penetration test, which can either extend or limit our working environment and capabilities.</p>
<p>For example, if we are performing an internal penetration test, in most cases, we are provided with an internal host from which we can work. Suppose this host has internet access (which is usually the case). In that case, we need a corresponding Virtual Private Server (VPS) with our tools to access and download the related penetration testing resources quickly.</p>
<p>Testing may be performed remotely or on-site, depending on the client&#39;s preference. If remote, we will typically ship them a device with our penetration testing distro of choice pre-installed, or provide them with a custom VM that will call back to our infrastructure via OpenVPN. The client will elect to either host an image (that we must log into and customize a bit on day one) and give us SSH access (via IP whitelisting), or provide us with VPN access directly into their network. Some clients will prefer not to host any image and provide VPN access, in which case we are free to test from our own local Linux and Windows VMs.</p>
<p>When traveling on-site to a client, it is essential to have both a customized and fully up-to-date Linux and Windows VM. Certain tools work best (or only) on Linux, and having a Windows VM makes specific tasks (such as enumerating Active Directory) much easier and more efficient. Regardless of the setup chosen, we must guide our clients on the pros and cons and help guide them towards the best possible solution based on their network and requirements.</p>
<p>This is yet another area of penetration testing in which we must be versatile and adaptable as subject matter experts. We must make sure we are fully prepared on day 1 with the proper tools to provide the client with the best possible value and an in-depth assessment. Every environment is different, and we never know what we will encounter once we begin enumerating the network and uncovering issues. We will have to compile/install tools or download specific scripts to our attack VM during almost every assessment we perform. Having our tools set up in the best way possible will ensure that we don&#39;t waste time in the initial days of the assessment. Ideally, we should only have to make changes to our assessment VMs for specific scenarios we encounter during the assessment.</p>
<hr>
<h3 id="setup-efficiency">Setup &amp; Efficiency</h3>
<p>Over time, we all gather different experiences and collections of tools that we are most familiar with. Being structured is of paramount importance, as it increases our efficiency in penetration testing. The need to search for individual resources and their dependencies before the engagement even starts can be removed entirely by having access to a prebaked, organized, and structured environment. Doing so requires preparation and knowledge of different operating systems, which will develop with time.</p>
<p>Efficiency is what many people want and expect. However, many people today rely on a tremendous amount of tools, to the point where the system becomes slow and no longer works properly. This is not surprising given the large number of applications and solutions offered today. Beginners in particular are overwhelmed when every source of information has 50 different opinions. These are all relevant and depend on the individual case, which is not a bad thing.</p>
<p>But beginners or even experienced people often look for other solutions when their work spectrum or responsibilities in their working environment change. Then there is another difficult aspect: migrating from the old to the new.</p>
<p>This often requires a great deal of effort and time and still does not guarantee that this investment will reflect the value. Therefore, with this module we want to create the essential setup in which we create a working environment for ourselves that we know inside out, can configure ourselves and adapt independently.</p>
<hr>
<h2 id="organization">Organization</h2>
<hr>
<p>As we have already seen in the <code>Learning Process</code> module, organization plays a significant role in our penetration tests. It does not matter what type of penetration test it is. Having a working environment that we can navigate almost blindly saves a tremendous amount of time researching resources that we are already familiar with and have invested our time learning. These sources can be found within a few minutes, but once we have an extensive list of resources required for each assessment and include installation, this results in a few hours of pure preparation.</p>
<p>Corporate environments usually consist of heterogeneous networks (hosts/servers having different Operating Systems). Therefore, it makes sense to organize hosts and servers based on their OS. If we organize our structure according to penetration testing stages and the targets’ Operating System, then a sample folder structure could look as follows.</p>
<p><strong>Organization</strong></p>
<p>Code: sessoin</p>
<pre><code class="lang-shell-sessoin"><span class="hljs-symbol">Cry0l1t3</span>@htb[/htb]$ tree ..

└── <span class="hljs-symbol">Penetration</span>-<span class="hljs-symbol">Testing</span>
    │
    ├── <span class="hljs-symbol">Pre</span>-<span class="hljs-symbol">Engagement</span>
    │       └── ...
    ├── <span class="hljs-symbol">Linux</span>
    │   ├── <span class="hljs-symbol">Information</span>-<span class="hljs-symbol">Gathering</span>
    │   │   └── ...
    │   ├── <span class="hljs-symbol">Vulnerability</span>-<span class="hljs-symbol">Assessment</span>
    │   │   └── ...
    │   ├── <span class="hljs-symbol">Exploitation</span>
    │   │   └── ...
    │   ├── <span class="hljs-symbol">Post</span>-<span class="hljs-symbol">Exploitation</span>
    │   │   └── ...
    │   └── <span class="hljs-symbol">Lateral</span>-<span class="hljs-symbol">Movement</span>
    │       └── ...
    ├── <span class="hljs-symbol">Windows</span>
    │   ├── <span class="hljs-symbol">Information</span>-<span class="hljs-symbol">Gathering</span>
    │   │   └── ...
    │   ├── <span class="hljs-symbol">Vulnerability</span>-<span class="hljs-symbol">Assessment</span>
    │   │   └── ...
    │   ├── <span class="hljs-symbol">Exploitation</span>
    │   │   └── ...
    │   ├── <span class="hljs-symbol">Post</span>-<span class="hljs-symbol">Exploitation</span>
    │   │   └── ...
    │   └── <span class="hljs-symbol">Lateral</span>-<span class="hljs-symbol">Movement</span>
    │       └── ...
    ├── <span class="hljs-symbol">Reporting</span>
    │   └── ...
    └── <span class="hljs-symbol">Results</span>
        └── ...
</code></pre>
<p>If we are specialized in specific penetration testing fields, we can, of course, reorganize the structure according to these fields. We are all free to develop a system with which we are familiar, and in fact, it is recommended that we do so. Everyone works differently and has their strengths and weaknesses. If we work in a team, we should develop a structure that each team member is familiar with. Take this example as a starting point for creating your system.</p>
<p>&#x20; Organization</p>
<pre><code class="lang-shell-session">Cry0l1t3@htb[/htb]$ tree ..

└── Penetration-Testing
    │
    ├── Pre-Engagement
    │       └── ...
    ├── Network-Pentesting
    │       ├── Linux
    │       │   ├── Information-Gathering
    │        │   │   └── ...
    │       │   ├── Vulnerability-Assessment
    │       │   │    └── ...
    │       │    └── ...
    │       │        └── ...
    │        ├── Windows
    │         │   ├── Information-Gathering
    │        │   │   └── ...
    │        │   └── ...
    │       └── ...
    ├── WebApp-Pentesting
    │       └── ...
    ├── Social-Engineering
    │       └── ...
    ├── .......
    │       └── ...
    ├── Reporting
    │   └── ...
    └── Results
        └── ...
</code></pre>
<p>Proper organization helps us in both keeping track of everything and finding errors in our processes. During our studies here, we will come across many different fields that we can use to expand and enhance our understanding of the cybersecurity domain. Not only can we save the cheatsheets or scripts provided within Modules in Academy, but we can also keep notes regarding all phases of a penetration test we will come across in HTB Academy to ensure that no critical steps are missed in future engagements. We recommend starting with small structures, especially when entering the penetration testing field. Organizing based on the Operating System is, therefore, more suitable for newcomers.</p>
<p>While organizing things for ourselves or an entire team, we should make sure that we all work according to a specific procedure. Everyone should know how where they fit in and where each member fits in throughout the entire penetration testing process. There should also be a common understanding regarding the activities of each member. Otherwise, things may end up in the wrong subdirectory, or evidence necessary for reporting could be lost or corrupted.</p>
<hr>
<h3 id="bookmarks">Bookmarks</h3>
<p>Numerous browser add-ons exist that can significantly enhance both our penetration testing activities and efficiency. Having to reinstall them over and over again takes time and slows us down unnecessarily. Thankfully Firefox offers add-on and bookmark synchronization after creating and using a Firefox account. All add-ons installed using this account are automatically installed and synchronized when we log in again. The same applies to any saved bookmarks. Therefore, logging in with a Firefox account will be enough to transfer everything from a prefabricated environment to a new one.</p>
<p>We should be cautious not to store any resources containing potentially sensitive information or private resources. We should always keep in mind that third parties could view these stored resources. Therefore, customer-related bookmarks should never be saved. A list of bookmarks should always be created with a single principle:</p>
<ul>
<li><strong><code>This list will be seen by third parties sooner or later.</code></strong></li>
</ul>
<p>For this reason, we should create an account for penetration testing purposes only. If our bookmark list must be edited and extended, then the safest route is to store the list locally and import it to the pentesting account. Once we have done this, we should change our private one (the non-pentesting one).</p>
<hr>
<h3 id="password-manager">Password Manager</h3>
<p>One other essential component for us is password managers. Password managers can prove helpful not only for personal purposes but also for penetration tests. One of the most common vulnerabilities or attack methods within a network is &quot;password reuse&quot;. We often try to use found or decrypted passwords and usernames to log in to multiple systems and services within the company network through this attack. It is still quite common to come across credentials that can be used to access several services or servers, making our work easier and offering us more opportunities for attack. There are three main problems with passwords:</p>
<ol>
<li><code>Complexity</code></li>
<li><code>Re-usage</code></li>
<li><code>Remembering</code></li>
</ol>
<p><strong>1. Complexity</strong></p>
<p>The first problem with passwords is complexity and remembering it. It is already a challenge for standard users to create a complex password, as they are often associated with content that users know and can remember. NordPass has created a list of the most commonly used passwords that we can view <a href="https://nordpass.com/most-common-passwords-list/">here</a>. We can see here that these passwords can be guessed within seconds without any special preparations, such as password mutation.</p>
<p><strong>2. Re-usage</strong></p>
<p>Once the user has created and memorized a complex password, only two problems remain. Remembering a complex and hard-to-guess password is still within the realm of possibility for a standard user. The second problem is that this password is then used for all services, which allows us to work across several components of the company&#39;s infrastructure. To prevent this, the user would have to create and remember complex passwords <code>for all</code> services used.</p>
<p><strong>3. Remembering</strong></p>
<p>This brings us to the third problem with passwords. If a standard user uses several dozen services, human nature forces them to become lazy. Very few will make an effort actually to <code>remember</code> all passwords. If a user creates multiple passwords, the risk of forgetting them or mixing them up with other password components is high if a secure password-keeping solution is not used.</p>
<p><code>Password Managers</code> solve all problems mentioned above not only for standard users but also for penetration testers. We work with dozens, if not hundreds, of different services and servers for which we need a new, strong, and complex password every time. Some providers include the following, but are not limited to:</p>
<table>
<thead>
<tr>
<th><a href="https://1password.com/"><strong>1Password</strong></a></th>
<th><a href="https://www.lastpass.com/"><strong>LastPass</strong></a></th>
<th><a href="https://www.keepersecurity.com/"><strong>Keeper</strong></a></th>
<th><a href="https://bitwarden.com/"><strong>Bitwarden</strong></a></th>
<th><a href="https://proton.me/pass">Proton Pass</a></th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>Another advantage to this is that we only have to remember one password to access all of our other passwords. One of the most recommended is <code>Proton Pass</code>, which offers a free plan and are Plus plan with an integrated 2FA, secure vault, dark web monitoring.</p>
<hr>
<h3 id="updates-automation">Updates &amp; Automation</h3>
<p>We should continually update the components we have organized before starting a new penetration test. This applies to the operating system we use and all the Github collections we will collect and use over time. It is highly recommended to record all the resources and their sources in a file to more easily automate them later. Any automation scripts can also be saved in Proton, Github, or your own server with your self-hosted applications to download them directly when needed.</p>
<p>When we create automated scripts, they are operating system-dependent. For example, we can work with Bash, Python, and PowerShell. Creating automation scripts is a good exercise for learning and practicing scripting and can also help us prepare and even reinstall a system more efficiently. We will find more tools, practical explanations, and cheat sheets when learning new methods and technologies. It is recommended that we keep those in a record and keep the entries up to date.</p>
<hr>
<h3 id="note-taking">Note Taking</h3>
<p>Note-taking is another essential part of our penetration testing because we accumulate a lot of different information, results, and ideas that are difficult to remember all at once. There are five different main types of information that need to be noted down:</p>
<ol>
<li>Newly discovered information</li>
<li>Ideas for further tests and processing</li>
<li>Scan results</li>
<li>Logging</li>
<li>Screenshots</li>
</ol>
<p><strong>1. Discovered Information</strong></p>
<p>By &quot;discovered information&quot; we mean general information—such as new IP addresses, usernames, passwords, source code—that we identified and are related to the penetration testing engagement and process. This is information that we can use against our target company. We often obtain such information through OSINT, active scans, and manual analysis of the given information resources and services.</p>
<p><strong>2. Processing</strong></p>
<p>We will acquire huge amounts of information, of all different types, during our penetration testing engagements. This requires that we be able to adapt our approach. The info we obtain may give us ideas for subsequent steps to take, while other vulnerabilities or misconfigurations may be forgotten or overlooked. Therefore, we should get in the habit of noting down everything we see that should be investigated as part of the assessment. Notion.so, Anytype, Obsidian and Xmind are very suitable for this.</p>
<p><a href="https://notion.so/">Notion.so</a> is a fancy online markdown editor that offers many different functions and gives us the ability to shape our ideas and thoughts according to our preferences.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/notion.png" alt="Notion interface displaying &#39;Acme Inc.&#39; workspace with sections for Team and Policies, shown on desktop and mobile."></p>
<p><a href="https://www.xmind.net/">Xmind</a> is an excellent mind map editor that can visualize relevant information components and processes very well.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/xmind.png" alt="XMind interface showing a mind map with customization options for topic shape, fill color, and border width."></p>
<p><a href="https://obsidian.md/">Obsidian</a> is a powerful knowledge base that works on top of a local folder of plain text Markdown files.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/obsidian.png" alt="VS Code with Foam extension showing a roadmap document, file explorer, and markdown link graph."></p>
<p><strong>3. Results</strong></p>
<p>The results we get after our scans and penetration testing steps are significant. With such a large amount of information in a short time, one can quickly feel overwhelmed. It is not easy at first to filter out the most critical pieces of information. This is something that will come with experience and practice. Only through practice, our eyes can be trained to recognize the essential small fragments of information. Nevertheless, we should keep all information and results not to miss something meaningful and because a piece of information may prove helpful later in the engagement. Besides, these results are also often used for documentation. For this, we can use <a href="https://github.com/GhostManager/Ghostwriter">GhostWriter</a> or <a href="https://github.com/pwndoc/pwndoc">Pwndoc</a>. These allow us to generate our documentation and have a clear overview of the steps we have taken.</p>
<p><strong>GhostWriter</strong></p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/ghostwriter.png" alt="Ghostwriter dashboard with navigation menu and calendar view for March 7-13, 2021."></p>
<p><strong>Pwndoc</strong></p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/pwndoc.png" alt="Pwndoc interface showing sections for general information, network scan, and findings, with a penetration test form."></p>
<p><strong>4. Logging</strong></p>
<p>Logging is essential for both documentation and our protection. If third parties attack the company during our penetration test and damage occurs, we can prove that the damage did not result from our activities. For this, we can use the tools <code>script</code> and <code>date</code>. <code>Date</code> can be used to display the exact date and time of each command in our command line. With the help of <code>script</code>, every command and the subsequent result is saved in a background file. To display the date and time, we can replace the <code>PS1</code> variable in our <code>.bashrc</code> file with the following content.</p>
<p><strong>PS1</strong></p>
<p>Code: bash</p>
<pre><code class="lang-bash">PS1="<span class="hljs-symbol">\[</span><span class="hljs-symbol">\0</span>33[1;32m<span class="hljs-symbol">\]</span><span class="hljs-symbol">\3</span>42<span class="hljs-symbol">\2</span>24<span class="hljs-symbol">\2</span>00<span class="hljs-symbol">\$</span>([[ <span class="hljs-symbol">\$</span>(/opt/vpnbash.sh) == *<span class="hljs-symbol">\"</span>10.<span class="hljs-symbol">\"</span>* ]] &amp;&amp; echo <span class="hljs-symbol">\"</span>[<span class="hljs-symbol">\[</span><span class="hljs-symbol">\0</span>33[1;34m<span class="hljs-symbol">\]</span><span class="hljs-symbol">\$</span>(/opt/vpnserver.sh)<span class="hljs-symbol">\[</span><span class="hljs-symbol">\0</span>33[1;32m<span class="hljs-symbol">\]</span>]<span class="hljs-symbol">\3</span>42<span class="hljs-symbol">\2</span>24<span class="hljs-symbol">\2</span>00[<span class="hljs-symbol">\[</span><span class="hljs-symbol">\0</span>33[1;37m<span class="hljs-symbol">\]</span><span class="hljs-symbol">\$</span>(/opt/vpnbash.sh)<span class="hljs-symbol">\[</span><span class="hljs-symbol">\0</span>33[1;32m<span class="hljs-symbol">\]</span>]<span class="hljs-symbol">\3</span>42<span class="hljs-symbol">\2</span>24<span class="hljs-symbol">\2</span>00<span class="hljs-symbol">\"</span>)[<span class="hljs-symbol">\[</span><span class="hljs-symbol">\0</span>33[1;37m<span class="hljs-symbol">\]</span><span class="hljs-symbol">\u</span><span class="hljs-symbol">\[</span><span class="hljs-symbol">\0</span>33[01;32m<span class="hljs-symbol">\]</span>@<span class="hljs-symbol">\[</span><span class="hljs-symbol">\0</span>33[01;34m<span class="hljs-symbol">\]</span><span class="hljs-symbol">\h</span><span class="hljs-symbol">\[</span><span class="hljs-symbol">\0</span>33[1;32m<span class="hljs-symbol">\]</span>]<span class="hljs-symbol">\3</span>42<span class="hljs-symbol">\2</span>24<span class="hljs-symbol">\2</span>00[<span class="hljs-symbol">\[</span><span class="hljs-symbol">\0</span>33[1;37m<span class="hljs-symbol">\]</span><span class="hljs-symbol">\w</span><span class="hljs-symbol">\[</span><span class="hljs-symbol">\0</span>33[1;32m<span class="hljs-symbol">\]</span>]<span class="hljs-symbol">\n</span><span class="hljs-symbol">\[</span><span class="hljs-symbol">\0</span>33[1;32m<span class="hljs-symbol">\]</span><span class="hljs-symbol">\3</span>42<span class="hljs-symbol">\2</span>24<span class="hljs-symbol">\2</span>24<span class="hljs-symbol">\3</span>42<span class="hljs-symbol">\2</span>24<span class="hljs-symbol">\2</span>00<span class="hljs-symbol">\3</span>42<span class="hljs-symbol">\2</span>24<span class="hljs-symbol">\2</span>00<span class="hljs-symbol">\3</span>42<span class="hljs-symbol">\2</span>25<span class="hljs-symbol">\2</span>74 [<span class="hljs-symbol">\[</span><span class="hljs-symbol">\e</span>[01;33m<span class="hljs-symbol">\]</span>$(date +<span class="hljs-variable">%D-%</span>r)<span class="hljs-symbol">\[</span><span class="hljs-symbol">\e</span>[01;32m<span class="hljs-symbol">\]</span>]<span class="hljs-symbol">\\</span>$ <span class="hljs-symbol">\[</span><span class="hljs-symbol">\e</span>[0m<span class="hljs-symbol">\]</span>"
</code></pre>
<p><strong>Date</strong></p>
<p>&#x20; Organization</p>
<pre><code class="lang-shell-session">─<span class="hljs-string">[eu-academy-1]</span>─<span class="hljs-string">[10.10.14.2]</span>─<span class="hljs-string">[Cry0l1t3@htb]</span>─<span class="hljs-string">[~]</span>
└──╼ <span class="hljs-string">[03/21/21-01:45:04 PM]</span>$
</code></pre>
<p>To start logging with <code>script</code> (for Linux) and <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.host/start-transcript?view=powershell-7.1">Start-Transcript</a> (for Windows), we can use the following command and rename it according to our needs. It is recommended to define a certain format in advance after saving the individual logs. One option is using the format <code>&lt;date&gt;-&lt;start time&gt;-&lt;name&gt;.log</code>.</p>
<p><strong>Script</strong></p>
<p>&#x20; Organization</p>
<pre><code class="lang-shell-session">Cry0l1t3<span class="hljs-symbol">@htb[</span>/htb]$ script <span class="hljs-number">03</span><span class="hljs-number">-21</span><span class="hljs-number">-2021</span><span class="hljs-number">-0200</span>pm-exploitation.<span class="hljs-built_in">log</span>
Cry0l1t3<span class="hljs-symbol">@htb[</span>/htb]$ &lt;ALL THE COMMANDS&gt;
Cry0l1t3<span class="hljs-symbol">@htb[</span>/htb]$ <span class="hljs-keyword">exit</span>
</code></pre>
<p><strong>Start-Transcript</strong></p>
<p>&#x20; Organization</p>
<pre><code class="lang-powershell-session">C:<span class="hljs-symbol">\&gt;</span> Start-Transcript -Path "C:<span class="hljs-symbol">\P</span>entesting<span class="hljs-symbol">\0</span>3-21-2021-0200pm-exploitation.log"

Transcript started, output file is C:<span class="hljs-symbol">\P</span>entesting<span class="hljs-symbol">\0</span>3-21-2021-0200pm-exploitation.log

C:<span class="hljs-symbol">\&gt;</span> ...SNIP...
C:<span class="hljs-symbol">\&gt;</span> Stop-Transcript
</code></pre>
<p>This will automatically sort our logs in the correct order, and we will no longer have to examine them manually. This also makes it more straightforward for our team members to understand what steps have been taken and when.</p>
<p>Another significant advantage is that we can later analyze our approach to optimize our process. If we repeat one or two steps repeatedly and use them in combination, it may be worthwhile to examine these steps with the help of a simple script to save time.</p>
<p>In addition, most tools offer the possibility to save the results in separate files. It is highly recommended always to use these functions because the results can also change. Therefore, if specific results seem to have changed, we can compare the current results with the previous ones. There are also terminal emulators, such as <a href="https://github.com/tmux/tmux/wiki">Tmux</a> and <a href="https://ghostty.org/">Ghostty</a>, which allow, among other things, to log all commands and output automatically. If we come across a tool that does not allow us to log the output, we can work with redirections and the program tee. This would look like this:</p>
<p><strong>Linux Output Redirection</strong></p>
<p>&#x20; Organization</p>
<pre><code class="lang-shell-session">Cry0l1t3@htb[<span class="hljs-regexp">/htb]$ ./custom</span>-tool.py <span class="hljs-number">10.129</span>.<span class="hljs-number">28.119</span> <span class="hljs-meta">&gt;&gt; </span>logs.custom-tool
</code></pre>
<p>&#x20; Organization</p>
<pre><code class="lang-shell-session">Cry0l1t3@htb[/htb]$ ./custom-tool.py <span class="hljs-number">10.129</span><span class="hljs-number">.28</span><span class="hljs-number">.119</span> | tee -a logs.custom-tool
</code></pre>
<h4 id="windows-output-redirection">Windows Output Redirection</h4>
<p>&#x20; Organization</p>
<pre><code class="lang-powershell-session"><span class="hljs-selector-tag">C</span>:\&gt; .\<span class="hljs-selector-tag">custom-tool</span><span class="hljs-selector-class">.ps1</span> 10<span class="hljs-selector-class">.129</span><span class="hljs-selector-class">.28</span><span class="hljs-selector-class">.119</span> &gt; <span class="hljs-selector-tag">logs</span><span class="hljs-selector-class">.custom-tool</span>
</code></pre>
<p>&#x20; Organization</p>
<pre><code class="lang-powershell-session"><span class="hljs-keyword">C</span>:\&gt; .\custom-tool.ps1 <span class="hljs-number">10.129</span><span class="hljs-number">.28</span><span class="hljs-number">.119</span> | <span class="hljs-keyword">Out</span>-<span class="hljs-keyword">File</span> -<span class="hljs-keyword">Append</span> logs.custom-tool
</code></pre>
<p><strong>5. Screenshots</strong></p>
<p>Screenshots serve as a momentary record and represent proof of results obtained, necessary for the Proof-Of-Concept and our documentation. One of the best tools for this is <a href="https://github.com/flameshot-org/flameshot">Flameshot</a>. It has all the essential functions that we need to quickly edit our screenshots without using an additional editing program. We can install it using our APT package manager or via download from Github.</p>
<p><strong>Flameshot</strong></p>
<p><img src="https://raw.githubusercontent.com/flameshot-org/flameshot/master/data/img/preview/animatedUsage.gif" alt="GIF showcasing the usage of Flameshot."></p>
<p>Sometimes, however, we cannot show all the necessary steps in one or more screenshots. We can use an application called <a href="https://github.com/phw/peek">Peek</a> and create GIFs that record all the required actions for us.</p>
<p><strong>Peek</strong></p>
<p><img src="https://raw.githubusercontent.com/phw/peek/master/data/screenshots/peek-recording-itself.gif" alt="GIF showcasing the usage of Peek."></p>
<hr>
<h2 id="virtualization">Virtualization</h2>
<hr>
<p><code>Virtualization</code> is an abstraction of physical computing resources. Both hardware and software components can be abstracted. A computer component created as part of virtualization is referred to as a virtual or logical component and can be used precisely as its physical counterpart. The main advantage of virtualization is the abstraction layer between the physical resource and the virtual image. This is the basis of various cloud services, which are becoming increasingly important in everyday business. Note that virtualization must be distinguished from the concepts of simulation and emulation.</p>
<p>By enabling physical computing resources—such as hardware, software, storage, and network components—to be represented and accessed in a virtual form, virtualization allows these resources to be distributed to different users in a flexible and demand-driven manner. This approach is intended to improve the overall utilization of computing resources. One of its key goals is to enable the execution of applications on systems that would not normally support them. In the context of virtualization, we typically distinguish between:</p>
<ul>
<li>Hardware virtualization</li>
<li>Application virtualization</li>
<li>Storage virtualization</li>
<li>Data virtualization</li>
<li>Network virtualization</li>
</ul>
<p>Hardware virtualization refers to technologies that allow hardware components to be accessed independently of their physical form through the use of <a href="https://en.wikipedia.org/wiki/Hypervisor">hypervisor</a> software. The best-known example of this is the <code>virtual machine (VM)</code>. A VM is a virtual computer that behaves like a physical computer, from its hardware to the operating system. Virtual machines run as virtual guest systems on one or more physical systems referred to as <code>hosts</code>. VirtualBox can also be enhanced with <code>VirtualBox Guest Additions</code>, which are a set of drivers and system applications designed to enhance the performance and usability of guest operating systems with VirtualBox.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/techhoundscom.jpg" alt="Diagram of hardware virtualization stack with layers: Application, Guest OS, Virtual Hardware, Hypervisor, and Hardware (CPU, Memory, NIC, Disk)."></p>
<hr>
<h3 id="virtual-machines">Virtual Machines</h3>
<p>A <code>virtual machine (VM)</code> is a virtual operating system that runs on a host system (an actual physical computer system). Several VMs isolated from each other can be operated in parallel. The physical hardware resources of the host system are allocated via <code>hypervisors</code>. This is a sealed-off, virtualized environment with which several guest systems can be operated, independent of the operating system, in parallel, on one physical computer. The VMs act independently of each other and do not influence each other. A hypervisor manages the hardware resources, and from the virtual machine&#39;s point of view, allocated computing power, RAM, hard disk capacity, and network connections are exclusively available.</p>
<p>From the application perspective, an operating system installed within the VM behaves as if installed directly on the hardware. It is not apparent to the applications or the operating system that they are running in a virtual environment. Virtualization is usually associated with performance loss for the VM because the intermediate virtualization layer itself requires resources. VMs offer numerous advantages over running an operating system or application directly on a physical system. The most important benefits are:</p>
<ol>
<li>Applications and services of a VM do not interfere with each other</li>
<li>Complete independence of the guest system from the host system&#39;s operating system and the underlying physical hardware</li>
<li>VMs can be moved or cloned to other systems by simple copying</li>
<li>Hardware resources can be dynamically allocated via the hypervisor</li>
<li>Better and more efficient utilization of existing hardware resources</li>
<li>Shorter provisioning times for systems and applications</li>
<li>Simplified management of virtual systems</li>
<li>Higher availability of VMs due to independence from physical resources</li>
</ol>
<hr>
<h3 id="introduction-to-virtualbox">Introduction to VirtualBox</h3>
<p>An excellent and free alternative to VMware Workstation Pro is <a href="https://www.virtualbox.org/">VirtualBox</a>. With VirtualBox, hard disks are emulated in container files called Virtual Disk Images (<code>VDI</code>). Aside from VDI format, VirtualBox can also handle hard disk files from VMware virtualization products (<code>.vmdk</code>), the <code>Virtual Hard Disk</code> format (<code>.vhd</code>), and others. We can also convert these external formats using the VBoxManage command-line tool that is part of VirtualBox. We can install VirtualBox from the command line, or download the installation file from the <a href="https://www.virtualbox.org/wiki/Downloads">official website</a> and install it manually.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/virt1.png" alt="VirtualBox homepage highlighting open source virtualization for personal and enterprise use, with a download button for binaries and platform packages."></p>
<p>VirtualBox is very common in private use. The installation is easy and usually requires no additional configuration for it to launch. We can download VirtualBox from their homepage: <a href="https://www.virtualbox.org/">https://www.virtualbox.org/</a></p>
<p><strong>VirtualBox Download</strong></p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/virt2.png" alt="VirtualBox download page for version 7.1.8 platform packages and extension pack, with links for different operating systems and license information."></p>
<p>Alternatively, with Ubuntu Linux we can use the following commands to install both VirtualBox and the extension pack simultaneously:</p>
<p><strong>VirtualBox Installation</strong></p>
<p>&#x20; Virtualization</p>
<pre><code class="lang-shell-session"><span class="hljs-selector-tag">cry0l1t3</span>@<span class="hljs-keyword">htb</span>[/<span class="hljs-keyword">htb</span>]$ sudo apt install virtualbox virtualbox-ext-pack -y
</code></pre>
<p><img src="https://academy.hackthebox.com/storage/modules/87/virt3.png" alt="Oracle VirtualBox Manager welcome screen with options for Basic and Expert modes, and toolbar for managing virtual machines."></p>
<p>The VirtualBox extension pack enhances the overall functionality of VirtualBox with the following features:</p>
<ul>
<li>USB 2.0/3.0 support</li>
<li>VirtualBox RDP</li>
<li>Disk Encryption</li>
<li>PXE Boot</li>
<li>NVMe support</li>
</ul>
<hr>
<h3 id="proxmox">Proxmox</h3>
<p>Proxmox is an open-source, enterprise-grade server virtualization and management platform which utilizies Kernel-based Virtual Machine (KVM) for full virtualization and Linux Containers (LXC) for container-based virtualization. This software is used in businesses and large data centers.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/virt4.png" alt="Proxmox homepage highlighting Virtual Environment, Backup Server, and Mail Gateway with new versions, emphasizing enterprise-grade solutions."></p>
<p>Proxmox provides three main solutions which can be downloaded <a href="https://proxmox.com/en/downloads">here</a>:</p>
<ul>
<li>Proxmox Virtual Environment</li>
<li>Proxmox Backup Server</li>
<li>Proxmox Mail Gateay</li>
</ul>
<p><strong>Proxmox VE ISO Download</strong></p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/virt5.png" alt="Proxmox VE 8.4 ISO Installer download page showing version 8.4-1, file size 1.57 GB, last updated April 9, 2025, with download and torrent options."></p>
<p>This software allows us to build and simulate entire networks, including complex setups using any type of virtual machine or container you can think of. We can download the Proxmox VE ISO file and install it on VirtualBox to experiment with it without the need for additional hardware resources.</p>
<p>After the download completes, we can create a new VM and assign the ISO image to it. Be sure to assign at least 4GB RAM and 2 CPUs for the Proxmox VM.</p>
<h4 id="proxmox-ve-installation">Proxmox VE Installation</h4>
<p><img src="https://academy.hackthebox.com/storage/modules/87/virt6.png" alt="VirtualBox &#39;Create Virtual Machine&#39; screen for setting up a new VM with fields for name, folder, ISO image, and OS type."></p>
<p>Once everything is set up, we should double check all the stats. If everything looks good, we now can start the VM.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/virt7.png" alt="Oracle VirtualBox Manager showing Proxmox VM details: powered off, 4096 MB memory, 3 processors, IDE storage, and NAT network adapter."></p>
<p>When the VM boots up, we&#39;re greeted with the Proxmox Virtual Environment screen. Now, we can select the option to install Proxmox VE using the graphical interface.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/virt8.png" alt="Proxmox installation screen with options for graphical and terminal UI installation, and advanced options."></p>
<p>Pay close attention throughout the duration of the setup, and make sure to read everything through the installation. Once it&#39;s installed, you will see the login screen, along with management webpage&#39;s URL.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/virt9.png" alt="Proxmox Virtual Environment login screen with URL for web configuration and root login prompt.&quot;"></p>
<p>The same credentials you used during the installation will be used to log into the web dashboard. Your credentials will be <code>root:&lt;your password&gt;</code>.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/virt10.png" alt="Proxmox VE login screen with fields for username, password, realm, and language selection."></p>
<p>At this point, you should see all the configuration options for your virtualized “Datacenter”. This is where you can upload VMs, containers, create networks, and much more. Those VMs and containers will be inside virtualized Proxmox environment and do not need to be added independently to VirtualBox.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/virt11.png" alt="Proxmox VE 8.4 dashboard showing server view with node and storage details, including disk, memory, and CPU usage."></p>
<hr>
<h2 id="linux">Linux</h2>
<hr>
<p>Linux is the most widely used operating system for penetration testing. As such, we must be proficient with it (or at the very least, familiar). When setting up an operating system for this purpose, it is best to establish a standardized configuration that consistently results in an environment we are comfortable working with.</p>
<p>Suppose we are asked to perform a penetration test to test both the network&#39;s internal and external security. If we have not yet prepared a dedicated system, now is the time to do so. Otherwise, we risk wasting valuable time during the engagement on setup and configuration, time that could be better spent testing various components of the network. However, before we prepare a system, we need to look at the available penetration testing distributions.</p>
<hr>
<h3 id="penetration-testing-distributions">Penetration Testing Distributions</h3>
<p>There are many different distributions we can use, all of which have different advantages and disadvantages. Many people ask themselves which system is the best. Nevertheless, what many do not understand is that it is a personal decision. This means that it depends primarily on our own needs and desires, which is the best for us. The tools available on these operating systems can be installed on pretty much any distribution, so we should instead ask ourselves what we expect from this Linux distribution. The best penetration testing distributions are characterized by their large/active community and detailed documentation. Among the most popular include, but not limited to:</p>
<table>
<thead>
<tr>
<th><a href="https://www.parrotsec.org/">ParrotOS</a> (<code>Pwnbox</code>)</th>
<th><a href="https://www.kali.org/">Kali Linux</a></th>
<th><a href="https://blackarch.org/">BlackArch</a></th>
<th><a href="https://linux.backbox.org/">BackBox</a></th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>In this scenario, we will deal with <a href="https://www.parrotsec.org/download/">ParrotOS Security</a> as our penetration testing distribution of choice. Let&#39;s select the category <code>Live</code> to get a full version of the operating system.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/lin1.png" alt="Parrot OS selection screen with options: Live for removable storage, Virtual for virtual machines, and IoT for embedded devices."></p>
<p>Next, we see three different editions of ParrotOS</p>
<ul>
<li>Security - for penetration tests</li>
<li>Home - for general purposes</li>
<li>HTB - your own personalized Pwnbox</li>
</ul>
<p>In this case, we will select the HTB edition. Feel free to follow along.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/lin2.png" alt="Parrot OS selection screen with options: Security for penetration testing, Home for general use, and HTB for Pwnbox hacking cloud."></p>
<p>After that, you will see the download button and the default credentials, in case you want to use it without installation.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/lin3.png" alt="Hack The Box Edition page with Pwnbox download options, default credentials, and version details."></p>
<hr>
<h3 id="vm-setup">VM Setup</h3>
<p>Before installing our ParrotOS Security operating system, we need to <code>create a VM</code> (in VirtualBox in this example). Here, we also specify which installation file will be used for the operating system (<code>.iso</code> file).</p>
<p><strong>ParrotOS ISO</strong></p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/lin4.png" alt="Oracle VirtualBox Manager screen for creating a virtual machine with ParrotOS, showing fields for name, folder, and ISO image."></p>
<p>Since VirtualBox does not recognize every operating system by default, it may not correctly detect ParrotOS. Therefore, we need to manually specify which distribution it is based on—in this case, <code>Debian</code>.</p>
<p>We also need to assign a <code>name</code> for the VM with the label we want for it, and then set the <code>path</code> where it will be stored.</p>
<p>After that, we can set the <code>maximum size</code> of the VM. It is recommended to allocate more than 20 GB, since the VM will grow as we install packages and applications during setup and use.</p>
<p><strong>OS Size</strong></p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/lin5.png" alt="VirtualBox screen for creating a virtual hard disk with options for file location, size, and type."></p>
<hr>
<h3 id="parrotos-installation">ParrotOS Installation</h3>
<p>Once we have created our VM, we can start it and get to the GRUB menu to select our options. Since we want to <code>install ParrotOS</code>, we should select that option. Once we click on the VM window, our mouse will be trapped there, meaning that our mouse cannot leave the window. To move the mouse freely again, we have to press <code>[Right CTRL]</code> (the default hotkey in most cases). However, we should verify this key combination in the VirtualBox window under <code>Preferences &gt; Virtual Machine &gt; Hot Key Combo</code>.</p>
<p>Note: We can design all the steps according to our needs. However, we should stick to the given selection for uniformity in the steps shown to get the same result.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/lin6.png" alt="Parrot OS boot menu with options: Try/Install, Advanced Modes, and Failsafe Modes."></p>
<p>Once you click on <code>Try / Install</code>, you&#39;ll enter the live mode of ParrotOS. This mode lets you explore and test the system without installing it. When you click <code>Install Debian</code>, the installation process begins. We are then prompted to choose our language, location, keyboard layout, and partitioning method.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/lin7.png" alt="Parrot OS 6.3 Calamares installer screen with a warning about insufficient memory, requiring at least 4 GiB."></p>
<p>Since we want to encrypt our data and information on the VM using <a href="https://en.wikipedia.org/wiki/Logical_volume_management">Logical Volume Manager</a> (<code>LVM</code>), we should select the &quot;<code>Encrypt system</code>&quot; option. It is also recommended to create a <code>Swap (no Hibernate)</code> for our system.</p>
<p><code>LVM</code> is a partitioning scheme. Mainly used in Unix and Linux environments, it provides a level of abstraction between disks, partitions, and file systems. Using LVM, it is possible to form dynamically changeable partitions which extend over several disks. After selecting LVM, we&#39;ll be prompted to enter a username, hostname, and password.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/lin8.png" alt="Parrot OS user setup screen with fields for name, login name, computer name, and password."></p>
<p>Once we have made all the required entries, we can confirm them and start configuring <code>LVM</code>.</p>
<hr>
<h3 id="luks-encryption">LUKS Encryption</h3>
<p><code>LVM</code> acts as an additional layer between physical storage and the operating system’s logical storage. LVM supports the organization of logical volumes into RAID arrays to protect against hard disk failure. Unlike RAID, however, the LVM concept does not provide redundancy. While primarily used in Linux and Unix, similar features exist in Windows (<a href="https://docs.microsoft.com/en-us/windows-server/storage/storage-spaces/overview">Storage Spaces</a>) and macOS (<a href="https://en.wikipedia.org/wiki/Core_Storage">CoreStorage</a>)</p>
<p>Once we get to the partitioning step, we will be asked for an <code>encryption passphrase</code>. We should keep in mind that this passphrase should be <code>very strong</code> and must be stored securely, ideally with a password manager. We will then have to re-enter the passphrase to confirm that no mistakes were made.</p>
<p><strong>LVM Passphrase</strong></p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/lin9.png" alt="Partition setup screen with options to erase disk or manually partition. Checkbox for &#39;Encrypt system&#39; is selected with a password field filled. Current partition shows 19.99 GiB unpartitioned. After partitioning: 17.99 GiB for &#39;Parrot&#39; and 2.00 GiB for &#39;swap&#39;."></p>
<p>After setting the passphrase, we will get an overview of all the partitions that have been created and configured. Other options will also be made available to us, as shown above. If no further configurations are needed, we can finish partitioning and apply the changes.</p>
<p>The operating system will now begin installing, and when it completes, the virtual machine will automatically restart. Upon reboot, we’ll be prompted to enter the encryption passphrase we created earlier to unlock the encrypted system and proceed with booting.</p>
<p><strong>LVM Unlock Partition</strong></p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/lin10.png" alt="GRUB loading screen prompting for passphrase for hd0, msdos1."></p>
<p>If we have entered the passphrase correctly, then the operating system will boot up completely, and we will be able to log in. Here we enter the password for the username we have created.</p>
<p><strong>First Login</strong></p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/lin11.png" alt="Login screen with user &#39;cry0l1t3&#39; selected and password field ready for input."></p>
<hr>
<h3 id="updates-apt-package-manager">Updates &amp; APT Package Manager</h3>
<p>Now that we have installed the operating system, we need to bring it up to date. For this, we will use the <code>APT</code> package management tool. The <code>advanced packaging toolkit</code> (<code>APT</code>) is a package management system that originated in the Debian operating system (which uses <code>dpkg</code> for the management of .deb packages under the hood). Package managers are used to search, update, and install program packages and dependencies. APT uses repositories (thus package sources), which are deposited in the directory <code>/etc/apt/sources.list</code> (in our case for ParrotOS: <code>/etc/apt.sources.list.d/parrot.list</code>).</p>
<p><strong>ParrotOS Sources List</strong></p>
<p>&#x20; Linux</p>
<pre><code class="lang-shell-session">┌─[cry0l1t3@parrot]─[~]
└──╼ $ <span class="hljs-keyword">cat</span> /etc/apt/sources.<span class="hljs-keyword">list</span>.d/parrot.<span class="hljs-keyword">list</span> | <span class="hljs-keyword">grep</span> -v <span class="hljs-string">"#"</span>

<span class="hljs-keyword">deb</span> http<span class="hljs-variable">s:</span>//<span class="hljs-keyword">deb</span>.parrot.<span class="hljs-keyword">sh</span>/parrot lory main contrib non-free non-free-firmware

<span class="hljs-keyword">deb</span> http<span class="hljs-variable">s:</span>//<span class="hljs-keyword">deb</span>.parrot.<span class="hljs-keyword">sh</span>/direct/parrot lory-security main contrib non-free non-free-firmware

<span class="hljs-keyword">deb</span> http<span class="hljs-variable">s:</span>//<span class="hljs-keyword">deb</span>.parrot.<span class="hljs-keyword">sh</span>/parrot lory-backports main contrib non-free non-free-firmware
</code></pre>
<p>Here, the package manager can access a list of HTTP and FTP servers, which it then uses to obtain the packages for installation. If packages are searched for, they are automatically loaded from the list of available repositories. Since program versions can be compared quickly and loaded automatically from the repositories list, updating existing program packages under APT is relatively easy and comfortable.</p>
<p><strong>Updating ParrotOS</strong></p>
<p>&#x20; Linux</p>
<pre><code class="lang-shell-session">┌─[cry0l1t3@parrotos]─[~]
└──╼ $ sudo apt <span class="hljs-keyword">update</span> -y &amp;&amp; sudo apt <span class="hljs-keyword">full</span>-<span class="hljs-keyword">upgrade</span> -y &amp;&amp; sudo apt autoremove -y &amp;&amp; sudo apt autoclean -y
[sudo] <span class="hljs-keyword">password</span> <span class="hljs-keyword">for</span> cry0l1t3: **********************

Hit:<span class="hljs-number">1</span> https://deb.parrot.sh/parrot <span class="hljs-keyword">rolling</span> InRelease
Hit:<span class="hljs-number">2</span> https://deb.parrot.sh/parrot <span class="hljs-keyword">rolling</span>-<span class="hljs-keyword">security</span> InRelease
Reading <span class="hljs-keyword">package</span> lists... Done
Building dependency tree
Reading state information... Done
<span class="hljs-number">2310</span> packages can be upgraded. Run <span class="hljs-string">'apt list --upgradable'</span> <span class="hljs-keyword">to</span> see them.
Reading <span class="hljs-keyword">package</span> lists... Done
Building dependency tree
Reading state information... Done
Calculating upgrade... Done
The <span class="hljs-keyword">following</span> packages were automatically installed <span class="hljs-keyword">and</span> <span class="hljs-keyword">are</span> <span class="hljs-keyword">no</span> longer <span class="hljs-keyword">required</span>:
  cryptsetup-nuke-<span class="hljs-keyword">password</span> dwarfdump
  &lt;SNIP&gt;
</code></pre>
<p>Below, we have a list of common pentesting tools:</p>
<p><strong>Tools List</strong></p>
<p>&#x20; Linux</p>
<pre><code class="lang-shell-session">┌─[cry0l1t3@parrotos]─[~]
└──╼ $ <span class="hljs-keyword">cat</span> tools.<span class="hljs-keyword">list</span>
netcat
ncat
<span class="hljs-keyword">nmap</span>
wireshark
tcpdump
hashcat
ffuf
gobuster
hydra
zaproxy
proxychains
sqlmap
radare2
metasploit-framework
python2.<span class="hljs-number">7</span>
<span class="hljs-keyword">python3</span>
spiderfoot
theharvester
remmina
xfreerdp
rdesktop
crackmapexec
exiftool
curl
seclists
testssl.<span class="hljs-keyword">sh</span>
git
<span class="hljs-keyword">vim</span>
tmux
</code></pre>
<p>Most of the packages are already installed on the operating system. If there are only a few packages that we want to install, we can enter them manually with following command.</p>
<p><strong>Installing Additional Tools</strong></p>
<p>&#x20; Linux</p>
<pre><code class="lang-shell-session">┌─[cry0l1t3@parrotos]─[~]
└──╼ $ sudo apt <span class="hljs-keyword">install</span> netcat ncat nmap wireshark tcpdump ...SNIP... git vim tmux -y
[sudo] <span class="hljs-keyword">password</span> <span class="hljs-keyword">for</span> cry0l1t3:

Reading <span class="hljs-keyword">package</span> lists... Done
Building dependency tree
Reading state information... Done
The <span class="hljs-keyword">following</span> packages were automatically installed <span class="hljs-keyword">and</span> <span class="hljs-keyword">are</span> <span class="hljs-keyword">no</span> longer <span class="hljs-keyword">required</span>:
  libarmadillo9 libboost-locale1<span class="hljs-number">.71</span><span class="hljs-number">.0</span> libcfitsio8 libdap25 libgdal27 libgfapi0
  &lt;SNIP&gt;
</code></pre>
<p>However, if you&#39;re working with a longer list of tools, it&#39;s more efficient to create a tool list file and use it to automate installation. This ensures consistency and saves time during future setups:</p>
<p><strong>Installing Additional Tools from a List</strong></p>
<p>&#x20; Linux</p>
<pre><code class="lang-shell-session">┌─[cry0l1t3@parrotos]─[~]
└──╼ <span class="hljs-symbol">$</span> sudo apt install <span class="hljs-symbol">$</span>(cat tools.list | tr <span class="hljs-string">"\n"</span> <span class="hljs-string">" "</span>) -y
[sudo] password <span class="hljs-keyword">for</span> cry0l1t3:

<span class="hljs-function"><span class="hljs-title">Reading</span></span> package lists... Done
Building dependency tree
<span class="hljs-function"><span class="hljs-title">Reading</span></span> state information... Done
The following packages were automatically installed <span class="hljs-keyword">and</span> are <span class="hljs-keyword">no</span> longer required:
  libarmadillo9 libboost-locale1<span class="hljs-number">.71</span><span class="hljs-number">.0</span> libcfitsio8 libdap25 libgdal27 libgfapi0
  &lt;SNIP&gt;
</code></pre>
<hr>
<h3 id="using-github">Using Github</h3>
<p>We will likely come across tools that aren&#39;t found in the standard repositories, and therefore will need to download them manually from Github. For example, assume we are missing some tools for Privilege Escalation and want to download the <a href="https://github.com/carlospolop/privilege-escalation-awesome-scripts-suite">Privilege-Escalation-Awesome-Scripts-Suite</a>. We would use the command:</p>
<p><strong>Clone Github Repository</strong></p>
<p>&#x20; Linux</p>
<pre><code class="lang-shell-session">┌─[cry0l1t3<span class="hljs-meta">@parrotos</span>]─[~]
└──╼ $ git clone <span class="hljs-string">https:</span><span class="hljs-comment">//github.com/carlospolop/privilege-escalation-awesome-scripts-suite.git</span>

Cloning into <span class="hljs-string">'privilege-escalation-awesome-scripts-suite'</span>...
<span class="hljs-string">remote:</span> Enumerating <span class="hljs-string">objects:</span> <span class="hljs-number">29</span>, done.
<span class="hljs-string">remote:</span> Counting <span class="hljs-string">objects:</span> <span class="hljs-number">100</span>% (<span class="hljs-number">29</span>/<span class="hljs-number">29</span>), done.
<span class="hljs-string">remote:</span> Compressing <span class="hljs-string">objects:</span> <span class="hljs-number">100</span>% (<span class="hljs-number">17</span>/<span class="hljs-number">17</span>), done.
<span class="hljs-string">remote:</span> Total <span class="hljs-number">5242</span> (delta <span class="hljs-number">18</span>), reused <span class="hljs-number">22</span> (delta <span class="hljs-number">11</span>), pack-reused <span class="hljs-number">5213</span>
Receiving <span class="hljs-string">objects:</span> <span class="hljs-number">100</span>% (<span class="hljs-number">5242</span><span class="hljs-regexp">/5242), 18.65 MiB | 5.11 MiB/</span>s, done.
Resolving <span class="hljs-string">deltas:</span> <span class="hljs-number">100</span>% (<span class="hljs-number">3129</span>/<span class="hljs-number">3129</span>), done.
</code></pre>
<p><strong>List Contents</strong></p>
<p>&#x20; Linux</p>
<pre><code class="lang-shell-session">┌─[cry0l1t3@parrotos]─[~]
└──╼ $ ls -l privilege-escalation-awesome-scripts-suite/
total 16

-rwxrwxr-x<span class="hljs-number"> 1 </span>cry0l1t3 cry0l1t3<span class="hljs-number"> 1069 </span>Mar<span class="hljs-number"> 23 </span>16:41 LICENSE
drwxrwxr-x<span class="hljs-number"> 3 </span>cry0l1t3 cry0l1t3<span class="hljs-number"> 4096 </span>Mar<span class="hljs-number"> 23 </span>16:41 linPEAS
-rwxrwxr-x<span class="hljs-number"> 1 </span>cry0l1t3 cry0l1t3<span class="hljs-number"> 2506 </span>Mar<span class="hljs-number"> 23 </span>16:41 README.md
drwxrwxr-x<span class="hljs-number"> 4 </span>cry0l1t3 cry0l1t3<span class="hljs-number"> 4096 </span>Mar<span class="hljs-number"> 23 </span>16:41 winPEAS
</code></pre>
<hr>
<h3 id="snapshot">Snapshot</h3>
<p>After installing the relevant packages and repositories, it is highly recommended to take a <code>VM snapshot</code>. In the following steps, we will be making changes to specific configuration files. If we aren&#39;t careful, a human error could make parts of the system (or even the entire system) unusable. We definitely do not want to have to repeat all our previous steps., So let&#39;s now create a snapshot and name it &quot;<code>Initial Setup</code>&quot;.</p>
<p>Nevertheless, <code>before</code> we create this snapshot, we should first shut down the virtual machine. Doing so not only speeds up the snapshot process but also ensures the snapshot is taken in a clean, powered-off state, reducing the chances of system corruption or inconsistencies.</p>
<p>If any mistakes are made while performing further configurations or testing, we can simply restore the snapshot and continue from a working state. It&#39;s good practice to take a snapshot after every major configuration change, and even periodically during a penetration test, to avoid losing valuable progress.</p>
<p><strong>Create a Snapshot</strong></p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/lin12.png" alt="VirtualBox Manager showing ParrotOS VM, aborted state, with &#39;Snapshots&#39; menu open."></p>
<p><strong>Completed Tasks</strong></p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/lin13.png" alt="Snapshot dialog for virtual machine with name &#39;Initial Setup&#39; and description &#39;Completed Tasks: updated, tools installed&#39;."></p>
<hr>
<h3 id="vm-disk-encryption">VM Disk Encryption</h3>
<p>In addition to LVM encryption, we can encrypt the entire VM with another strong password. This gives us an extra layer of protection that will protect our results and any customer data residing on the system. This means that no one will be able to start the VM without the password we set.</p>
<p>Now that we have shut down and powered off the VM, we go to <code>Edit virtual machine settings</code> and select the <code>Options</code> tab.</p>
<p><strong>VirtualBox Disk Encryption Settings</strong></p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/lin14.png" alt="VirtualBox settings for ParrotOS with &#39;Enable Disk Encryption&#39; checked, showing password fields for disk encryption."></p>
<p>There we will find more additional functions and settings that we can use later. Relevant for us now is the <code>Access Control</code> settings. Once we have encrypted it, we will not be able to create a clone of it without first decrypting it. More about this can be found in the VirtualBox documentation.</p>
<hr>
<h2 id="windows">Windows</h2>
<hr>
<p>Windows computers serve an essential role in most companies, making them one of the main targets for aspiring penetration testers like ourselves. However, they can also serve as effective penetration testing platforms. There are several advantages to using Windows as our daily driver. It blends into most enterprise environments, making us appear both physically and virtually less suspicious. Additionally, navigating and communicating with other hosts on an Active Directory domain is easier when using Windows compared to Linux and some Python tooling. Traversing SMB and utilizing shares is also more straightforward in this context. With this in mind, it can be beneficial to familiarize ourselves with Windows and establish a standard configuration that ensures a stable and effective platform for conducting our activities.</p>
<p>Building our penetration testing platform can help us in multiple ways:</p>
<ol>
<li>Since we built it ourselves and installed only the tools we deemed necessary, we should have a better understanding of what is happening under the hood. This also allows us to ensure we do not have any unnecessary services running that could potentially be a risk to ourselves and the customer when on an engagement.</li>
<li>It provides us the flexibility of having multiple operating system types at our disposal if needed. These same systems used for our engagements can also serve as a testbed for payloads and exploits before launching them at the customer.</li>
<li>Having built and tested the system(s) ourselves, we know they will function as intended during the penetration test. This saves ourselves time during the engagement that would have likely been spent troubleshooting.</li>
</ol>
<p>With all this in mind, where do we start? Fortunately for us, there are many new features with Windows that weren&#39;t available years ago. <code>Windows Subsystem for Linux (WSL)</code> is an excellent example of this. It allows for Linux operating systems to run alongside our Windows install. This can help us by giving us a space to run tools developed for Linux right inside our Windows host, without the need for a hypervisor program or installation of a third-party application such as VirtualBox or Docker.</p>
<p>This section will examine and cover the installalation of the core components needed to get our systems in fighting shape, such as <code>WSL, Visual Studio Code, Python, Git, and the Chocolatey Package Manager</code>. Since we are utilizing this platform for its penetration testing functions, it will also require us to make changes to our host&#39;s security settings. Keep in mind, most exploitation tools and code are just that, <code>USED for EXPLOITATION</code>, and can be harmful to your host if not careful. Be mindful of what you install and run. If we do not isolate these tools off, Windows Defender will almost certainly delete any detected files and applications it deems harmful, breaking our setup. Now, let&#39;s dive in.</p>
<hr>
<h3 id="installation-requirements">Installation Requirements</h3>
<p>The installation of the Windows VM is done in the same way as the Linux VM. We can do this on a bare-metal host or in a hypervisor. With either option, we have certain requirements to meet and things to consider when installing Windows 10.</p>
<p><strong>Hardware Requirements</strong></p>
<ul>
<li>Processor that runs at 1GHz or greater. Dual-core or better is ideal.</li>
<li>2G of RAM minimum, 4G or more is ideal.</li>
<li>60G of Hard Drive space. This ensures there is room for the OS and some tools. Size can vary based on the number of tools we install on the host.</li>
<li>Network connectivity, if possible, two network adapters.</li>
</ul>
<p>Ideally, we want to have a moderate processor that can handle intensive loads at times. If we are attempting to run Windows virtualized, our host will need at least four cores so that two can be given to the VM. Windows can get a bit beefy with updates and tool installs, so 80G of storage or more is ideal. When it comes to RAM, 4G would be a minimum to ensure we do not have any latency or issues while performing our penetration tests.</p>
<p><strong>Software Requirements</strong></p>
<p>Unlike most Linux distributions, Windows is a licensed product. To stay in good standing, we ought to ensure that we adhere to the terms of use. For now, a great place to start is to grab a copy of a Developer VM, were available <a href="https://download.microsoft.com/download/1/4/6/1468925f-d912-4436-8582-4cfdc66e18fc/WinDev2407Eval.VirtualBox.zip">here</a>. We can use this to begin building out our platform. The Developer Evaluation platform comes pre-configured with:</p>
<table>
<thead>
<tr>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Windows 10 Version 2004</td>
</tr>
<tr>
<td>Windows 10 SDK Version 2004</td>
</tr>
<tr>
<td>Visual Studio 2019 with the UWP, .NET desktop, and Azure workflows enabled and also includes the Windows Template Studio extension</td>
</tr>
<tr>
<td>Visual Studio Code</td>
</tr>
<tr>
<td>Windows Subsystem for Linux with Ubuntu installed</td>
</tr>
<tr>
<td>Developer mode enabled</td>
</tr>
</tbody>
</table>
<p>The VM comes pre-configured with a user: <code>IEUser</code> and Password <code>Passw0rd!</code>. It is a trial virtual machine, so it has an expiration date of 90 days. Keep this in mind when configuring it. Once you have a baseline VM, take a snapshot.</p>
<hr>
<h3 id="core-changes">Core Changes</h3>
<p>To prepare our Windows host, we have to make a few changes before moving onto the fun stuff (e.g., installing our pentesting tools):</p>
<ol>
<li>We will need to update our host to ensure it is working at the required level and keep our security posture as strong as possible.</li>
<li>We will want to install the Windows Subsystem for Linux and the <a href="https://chocolatey.org/">Chocolatey Package manager</a>. Once these tasks are completed, we can make our exclusions to WindowsDefender scanning policies to ensure they will not quarantine our newly installed tools and scripts. From this point, it is now time to install our tools and scripts of choice.</li>
<li>We will finish our buildout by taking a backup or snapshot of the host to have a fallback point if something happens to it.</li>
</ol>
<hr>
<h3 id="updates">Updates</h3>
<p>To keep with our command-line use, we will make an conscious effort to utilize the command-line whenever possible. To start installing updates on our host, we will need the PSWindowsUpdate module. To acquire it, we will open an administrator Powershell window and issue the following commands:</p>
<p><strong>Updates</strong></p>
<p>&#x20; Windows</p>
<pre><code class="lang-powershell-session">PS <span class="hljs-keyword">C</span>:\htb&gt; <span class="hljs-keyword">Get</span>-ExecutionPolicy -<span class="hljs-keyword">List</span>

Scope ExecutionPolicy
----- ---------------
MachinePolicy <span class="hljs-keyword">Undefined</span>
UserPolicy <span class="hljs-keyword">Undefined</span>
Process <span class="hljs-keyword">Undefined</span>
CurrentUser <span class="hljs-keyword">Undefined</span>
LocalMachine <span class="hljs-keyword">Undefined</span>
</code></pre>
<p>We must first check our systems Execution Policy to ensure we can download, load, and run modules and scripts. The above command will output a list showing the policy set for each scope. In our case, we do not want this change to be permanent, so we will only change the ExecutionPolicy for the scope of <code>Process</code>.</p>
<p><strong>Execution Policy</strong></p>
<p>&#x20; Windows</p>
<pre><code class="lang-powershell-session">PS C:<span class="hljs-string">\htb&gt;</span> Set-ExecutionPolicy Unrestricted -Scope Process

Execution Policy Change
The execution policy helps protect you <span class="hljs-keyword">from</span> scripts <span class="hljs-literal">that</span> you <span class="hljs-keyword">do</span> <span class="hljs-keyword">not</span> trust.
Changing the execution policy might expose you <span class="hljs-keyword">to</span> the security risks described <span class="hljs-keyword">in</span> the about_Execution_Policies help topic at https:<span class="hljs-regexp">/go.microsoft.com/fwlink/</span>?LinkID=<span class="hljs-number">135170.</span> Do you want <span class="hljs-keyword">to</span> change the execution policy?
[Y] Yes [A] Yes <span class="hljs-keyword">to</span> All [N] No [L] No <span class="hljs-keyword">to</span> All [S] Suspend [?] Help (<span class="hljs-keyword">default</span> <span class="hljs-keyword">is</span> <span class="hljs-string">"N"</span>): A

PS C:<span class="hljs-string">\htb&gt;</span> Get-ExecutionPolicy -List

Scope ExecutionPolicy
----- ---------------
MachinePolicy Undefined
UserPolicy Undefined
Process Unrestricted
CurrentUser Undefined
LocalMachine Undefined
</code></pre>
<p>Once we set our ExecutionPolicy, we should recheck and make sure our change took effect. By changing the Process scope policy, we ensure that our change is temporary and only applies to the current Powershell process. Changing it for any other scope will modify a registry setting and persist until we change it back again..</p>
<p>Now that we have our ExecutionPolicy set, let us install the PSWindowsUpdate module and apply our updates. We can do so by:</p>
<p><strong>PSWindowsUpdate</strong></p>
<p>&#x20; Windows</p>
<pre><code class="lang-powershell-session">PS C:\htb&gt; Install-<span class="hljs-keyword">Module</span> PSWindowsUpdate

Untrusted repository
You are installing the modules <span class="hljs-keyword">from</span> an untrusted repository. <span class="hljs-keyword">If</span> you trust this repository,
change its InstallationPolicy value <span class="hljs-keyword">by</span> running the <span class="hljs-keyword">Set</span>-PSRepository cmdlet.
Are you sure you want <span class="hljs-keyword">to</span> install the modules <span class="hljs-keyword">from</span> <span class="hljs-comment">'PSGallery'?</span>
[Y] Yes [A] Yes <span class="hljs-keyword">to</span> All [N] No [L] No <span class="hljs-keyword">to</span> All [S] Suspend [?] Help (<span class="hljs-keyword">default</span> <span class="hljs-keyword">is</span> <span class="hljs-string">"N"</span>): A
</code></pre>
<p>Once the module installation completes, we can import it and run our updates.</p>
<p>&#x20; Windows</p>
<pre><code class="lang-powershell-session">PS <span class="hljs-keyword">C</span>:\htb&gt; <span class="hljs-keyword">Import</span>-<span class="hljs-keyword">Module</span> PSWindowsUpdate

PS <span class="hljs-keyword">C</span>:\htb&gt; <span class="hljs-keyword">Install</span>-WindowsUpdate -AcceptAll

X ComputerName Result KB Size Title
- ------------ ------ -- ---- -----
<span class="hljs-number">1</span> DESKTOP<span class="hljs-number">-3.</span>.. Accepted KB2267602 <span class="hljs-number">510</span>MB Security Intelligence <span class="hljs-keyword">Update</span> for Microsoft Defender Antivirus - KB2267602...
<span class="hljs-number">1</span> DESKTOP<span class="hljs-number">-3.</span>.. Accepted <span class="hljs-number">17</span>MB VMware, Inc. - <span class="hljs-keyword">Display</span> - <span class="hljs-number">8.17</span><span class="hljs-number">.2</span><span class="hljs-number">.14</span>
<span class="hljs-number">2</span> DESKTOP<span class="hljs-number">-3.</span>.. Downloaded KB2267602 <span class="hljs-number">510</span>MB Security Intelligence <span class="hljs-keyword">Update</span> for Microsoft Defender Antivirus - KB2267602...
<span class="hljs-number">2</span> DESKTOP<span class="hljs-number">-3.</span>.. Downloaded <span class="hljs-number">17</span>MB VMware, Inc. - <span class="hljs-keyword">Display</span> - <span class="hljs-number">8.17</span><span class="hljs-number">.2</span><span class="hljs-number">.14</span> <span class="hljs-number">3</span> DESKTOP<span class="hljs-number">-3.</span>.. Installed KB2267602 <span class="hljs-number">510</span>MB Security Intelligence <span class="hljs-keyword">Update</span> for Microsoft Defender Antivirus - KB2267602... <span class="hljs-number">3</span> DESKTOP<span class="hljs-number">-3.</span>.. Installed <span class="hljs-number">17</span>MB VMware, Inc. - <span class="hljs-keyword">Display</span> - <span class="hljs-number">8.17</span><span class="hljs-number">.2</span><span class="hljs-number">.14</span>

PS <span class="hljs-keyword">C</span>:\htb&gt; Restart-Computer -Force
</code></pre>
<p>The above Powershell example will import the <code>PSWindowsUpdate</code> module, run the update installer, and then reboot the PC to apply changes. We should make a point to run updates regularly, especially if we plan to use this host frequently and not destroy it at the end of each engagement. Now that we have our updates installed, let us get our package manager and other core tools.</p>
<hr>
<h3 id="chocolatey-package-manager">Chocolatey Package Manager</h3>
<p>Chocolatey is a free and open software package management solution that can manage the installation and dependencies of our software packages and scripts. It also allows for automation with Powershell, Ansible, and several other management solutions. Chocolatey will enable us to install the tools we need from one source, rather than downloading and installing each tool individually from the internet. Follow the Powershell commands below to learn how to install Chocolatey and use it to gather/install our tools.</p>
<p><strong>Chocolatey</strong></p>
<p>&#x20; Windows</p>
<pre><code class="lang-powershell-session">PS C:\htb&gt; Set-ExecutionPolicy Bypass -Scope Process -Force; [System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor <span class="hljs-number">3072</span>; iex ((New-Object System.Net.WebClient).DownloadString(<span class="hljs-string">'https://chocolatey.org/install.ps1'</span>))

Forcing web requests <span class="hljs-built_in">to</span> allow TLS v1<span class="hljs-number">.2</span> (Required <span class="hljs-keyword">for</span> requests <span class="hljs-built_in">to</span> Chocolatey.org)
Getting latest <span class="hljs-built_in">version</span> <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> Chocolatey package <span class="hljs-keyword">for</span> download.
Not <span class="hljs-keyword">using</span> proxy.
Getting Chocolatey <span class="hljs-built_in">from</span> <span class="hljs-keyword">https</span>://community.chocolatey.org/api/v2/package/chocolatey/<span class="hljs-number">0.10</span><span class="hljs-number">.15</span>.
Downloading <span class="hljs-keyword">https</span>://community.chocolatey.org/api/v2/package/chocolatey/<span class="hljs-number">0.10</span><span class="hljs-number">.15</span> <span class="hljs-built_in">to</span> C:\Users\DEMONS~<span class="hljs-number">1</span>\AppData\Local\Temp\chocolatey\chocoInstall\chocolatey.zip
Not <span class="hljs-keyword">using</span> proxy.
Extracting C:\Users\DEMONS~<span class="hljs-number">1</span>\AppData\Local\Temp\chocolatey\chocoInstall\chocolatey.zip <span class="hljs-built_in">to</span> C:\Users\DEMONS~<span class="hljs-number">1</span>\AppData\Local\Temp\chocolatey\chocoInstall
Installing Chocolatey <span class="hljs-keyword">on</span> <span class="hljs-title">the</span> <span class="hljs-title">local</span> <span class="hljs-title">machine</span>
Creating ChocolateyInstall <span class="hljs-keyword">as</span> <span class="hljs-keyword">an</span> environment <span class="hljs-built_in">variable</span> (targeting <span class="hljs-string">'Machine'</span>)
Setting ChocolateyInstall <span class="hljs-built_in">to</span> <span class="hljs-string">'C:\ProgramData\chocolatey'</span>

...SNIP...

Chocolatey (choco.exe) is now ready.
You can call choco <span class="hljs-built_in">from</span> <span class="hljs-keyword">the</span> <span class="hljs-keyword">command</span>-line <span class="hljs-title">or</span> <span class="hljs-title">PowerShell</span> <span class="hljs-title">by</span> <span class="hljs-title">typing</span> <span class="hljs-title">choco</span>.
Run choco /? <span class="hljs-keyword">for</span> <span class="hljs-keyword">a</span> list <span class="hljs-keyword">of</span> functions.
You may need <span class="hljs-built_in">to</span> shut down <span class="hljs-keyword">and</span> restart powershell <span class="hljs-keyword">and</span>/<span class="hljs-keyword">or</span> consoles
<span class="hljs-keyword">first</span> prior <span class="hljs-built_in">to</span> <span class="hljs-keyword">using</span> choco.
Ensuring Chocolatey commands are <span class="hljs-keyword">on</span> <span class="hljs-title">the</span> <span class="hljs-title">path</span>
Ensuring chocolatey.nupkg is <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> lib <span class="hljs-built_in">folder</span>
</code></pre>
<p>We have now installed chocolatey. The Powershell command we issued sets our ExecutionPolicy for the session, then downloads the installer from chocolatey.org and runs the script. Next, we will update chocolatey and start installing packages. To ensure no issues arise, it is recommended that we periodically restart our host.</p>
<p>&#x20; Windows</p>
<pre><code class="lang-powershell-session">PS C:\htb&gt; choco upgrade chocolatey -y

Chocolatey v0<span class="hljs-number">.10</span><span class="hljs-number">.15</span>
Upgrading <span class="hljs-keyword">the</span> following packages:
chocolatey
By upgrading, you accept licenses <span class="hljs-keyword">for</span> <span class="hljs-keyword">the</span> packages.
chocolatey v0<span class="hljs-number">.10</span><span class="hljs-number">.15</span> is <span class="hljs-keyword">the</span> latest <span class="hljs-built_in">version</span> available based <span class="hljs-keyword">on</span> <span class="hljs-title">your</span> <span class="hljs-title">source</span>(<span class="hljs-title">s</span>).

Chocolatey upgraded <span class="hljs-number">0</span>/<span class="hljs-number">1</span> packages.
See <span class="hljs-keyword">the</span> <span class="hljs-built_in">log</span> <span class="hljs-keyword">for</span> details (C:\ProgramData\chocolatey\logs\chocolatey.<span class="hljs-built_in">log</span>).
</code></pre>
<p>Now that we&#39;ve confirmed that chocolatey is up-to-date, let&#39;s manage our packages. To install packages with choco, we can issue a command such as <code>choco install pkg1 pkg2 pkg3</code>, listing out the package you need one by one separated by spaces. Alternatively, we can use the <code>packages.config</code> file for the installation. This is an XML file that chocolatey can reference to install a list of packages. Another helpful command to use is <code>choco info pkg</code>. It will show us various information about the package, if it is available in the choco repository. See the <a href="https://docs.chocolatey.org/en-us/choco/commands/install">install page</a> for more info on how to utilize chocolatey.</p>
<p>&#x20; Windows</p>
<pre><code class="lang-powershell-session">PS <span class="hljs-string">C:</span>\htb&gt; choco info vscode

Chocolatey v0<span class="hljs-number">.10</span><span class="hljs-number">.15</span>
vscode <span class="hljs-number">1.55</span><span class="hljs-number">.1</span> [Approved]
<span class="hljs-string">Title:</span> Visual Studio Code | <span class="hljs-string">Published:</span> <span class="hljs-number">4</span><span class="hljs-regexp">/9/</span><span class="hljs-number">2021</span>
Package approved <span class="hljs-keyword">as</span> a trusted <span class="hljs-keyword">package</span> on Apr <span class="hljs-number">09</span> <span class="hljs-number">2021</span> <span class="hljs-number">01</span>:<span class="hljs-number">34</span>:<span class="hljs-number">23.</span>
Package testing <span class="hljs-string">status:</span> Passing on Apr <span class="hljs-number">09</span> <span class="hljs-number">2021</span> <span class="hljs-number">00</span>:<span class="hljs-number">49</span>:<span class="hljs-number">32.</span>
Number of <span class="hljs-string">Downloads:</span> <span class="hljs-number">1999367</span> | Downloads <span class="hljs-keyword">for</span> <span class="hljs-keyword">this</span> <span class="hljs-string">version:</span> <span class="hljs-number">19751</span>
Package url
Chocolatey Package <span class="hljs-string">Source:</span> <span class="hljs-string">https:</span><span class="hljs-comment">//github.com/chocolatey-community/chocolatey-coreteampackages/tree/master/automatic/vscode</span>
Package <span class="hljs-string">Checksum:</span> <span class="hljs-string">'fTzzpEG+cspu7FUdqMbj8EqaD8cRIQ/cXtAUv7JGVB9uc23vuGNiuceqM94irt+nx8MGM0xAcBwdwBH+iE+tgQ=='</span> (SHA512)
<span class="hljs-string">Tags:</span> microsoft visualstudiocode vscode development editor ide javascript typescript admin foss cross-platform
Software <span class="hljs-string">Site:</span> <span class="hljs-string">https:</span><span class="hljs-comment">//code.visualstudio.com/</span>
Software <span class="hljs-string">License:</span> <span class="hljs-string">https:</span><span class="hljs-comment">//code.visualstudio.com/License</span>
Software <span class="hljs-string">Source:</span> <span class="hljs-string">https:</span><span class="hljs-comment">//github.com/Microsoft/vscode</span>
<span class="hljs-string">Documentation:</span> <span class="hljs-string">https:</span><span class="hljs-comment">//code.visualstudio.com/docs</span>
<span class="hljs-string">Issues:</span> <span class="hljs-string">https:</span><span class="hljs-comment">//github.com/Microsoft/vscode/issues</span>
<span class="hljs-string">Summary:</span> Visual Studio Code
<span class="hljs-string">Description:</span> Build and debug modern web and cloud applications. Code is free and available on your favorite platform - Linux, Mac OSX, and Windows.
...SNIP...
</code></pre>
<p>Above is an example of using the info option with chocolatey.</p>
<p>&#x20; Windows</p>
<pre><code class="lang-powershell-session">PS C:\htb&gt; choco install python vscode git wsl2 openssh openvpn

Chocolatey v0<span class="hljs-meta">.10</span><span class="hljs-meta">.15</span>
Installing the following packages:
python<span class="hljs-comment">;vscode;git;wsl2;openssh;openvpn</span>
...SNIP...

Chocolatey installed <span class="hljs-number">20</span>/<span class="hljs-number">20</span> packages.
See the log for details (C:\ProgramData\chocolatey\logs\chocolatey.log).
<span class="hljs-symbol">
Installed:</span>
- kb2919355 v1<span class="hljs-meta">.0</span><span class="hljs-meta">.20160915</span>
- python v3<span class="hljs-meta">.9</span><span class="hljs-meta">.4</span>
- kb3033929 v1<span class="hljs-meta">.0</span><span class="hljs-meta">.5</span>
- chocolatey-core.extension v1<span class="hljs-meta">.3</span><span class="hljs-meta">.5</span><span class="hljs-meta">.1</span>
- kb2999226 v1<span class="hljs-meta">.0</span><span class="hljs-meta">.20181019</span>
- python3 v3<span class="hljs-meta">.9</span><span class="hljs-meta">.4</span>
- openssh v8<span class="hljs-meta">.0</span><span class="hljs-meta">.0</span><span class="hljs-meta">.1</span>
- vcredist2015 v14<span class="hljs-meta">.0</span><span class="hljs-meta">.24215</span><span class="hljs-meta">.20170201</span>
- gpg4win-vanilla v2<span class="hljs-meta">.3</span><span class="hljs-meta">.4</span><span class="hljs-meta">.20191021</span>
- vscode.install v1<span class="hljs-meta">.55</span><span class="hljs-meta">.1</span>
- wsl2 v2<span class="hljs-meta">.0</span><span class="hljs-meta">.0</span><span class="hljs-meta">.20210122</span>
- kb2919442 v1<span class="hljs-meta">.0</span><span class="hljs-meta">.20160915</span>
- openvpn v2<span class="hljs-meta">.4</span><span class="hljs-meta">.7</span>
- git.install v2<span class="hljs-meta">.31</span><span class="hljs-meta">.1</span>
- vscode v1<span class="hljs-meta">.55</span><span class="hljs-meta">.1</span>
- vcredist140 v14<span class="hljs-meta">.28</span><span class="hljs-meta">.29913</span>
- kb3035131 v1<span class="hljs-meta">.0</span><span class="hljs-meta">.3</span>
- dotnet4<span class="hljs-meta">.5</span><span class="hljs-meta">.2</span> v4<span class="hljs-meta">.5</span><span class="hljs-meta">.2</span><span class="hljs-meta">.20140902</span>
- git v2<span class="hljs-meta">.31</span><span class="hljs-meta">.1</span>
- chocolatey-windowsupdate.extension v1<span class="hljs-meta">.0</span><span class="hljs-meta">.4</span>

PS C:\htb&gt; RefreshEnv
</code></pre>
<p>We can see in the terminal above that <code>choco</code> installed the packages we requested and pulled the required dependencies. Issuing the <code>RefreshEnv</code> command will update Powershell, along with any environment variables that were applied. At this point, we have the bulk of the core tools installed which enable our operations. To install other packages, the <code>choco install pkg</code> command is sufficient, pulling any additional operational tools we need. We have included a list of helpful packages that can aid us in completing a penetration test below. See the automation section further down to begin automating installing the tools and packages we commonly need and use.</p>
<hr>
<h3 id="windows-terminal">Windows Terminal</h3>
<p>Windows Terminal is Microsoft&#39;s updated release for a GUI terminal emulator. It supports the use of many different command-line tools, including Command Prompt, PowerShell, and Windows Subsystem for Linux. The terminal allows for the use of customizable themes, configurations, command-line arguments, and custom actions. It is a versatile tool for managing multiple shell types and will quickly become a staple for most.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/terminal-example.png" alt="Terminal showing command &#39;uname -a&#39; outputting Linux system details."></p>
<p>To install Terminal with Chocolatey:</p>
<p>&#x20; Windows</p>
<pre><code class="lang-powershell-session">PS C:\htb&gt; choco install microsoft-windows-terminal

Chocolatey v0<span class="hljs-number">.10</span><span class="hljs-number">.15</span>
<span class="hljs-number">2</span> validations performed. <span class="hljs-number">1</span> success(es), <span class="hljs-number">1</span> warning(s), <span class="hljs-keyword">and</span> <span class="hljs-number">0</span> error(s).

Validation Warnings:
- A pending <span class="hljs-keyword">system</span> reboot request has been detected, however, this is
being ignored due <span class="hljs-built_in">to</span> <span class="hljs-keyword">the</span> current Chocolatey configuration. If you
want <span class="hljs-built_in">to</span> halt when this occurs, <span class="hljs-keyword">then</span> either <span class="hljs-built_in">set</span> <span class="hljs-keyword">the</span> <span class="hljs-built_in">global</span> feature
<span class="hljs-keyword">using</span>:
choco feature enable -name=exitOnRebootDetected
<span class="hljs-keyword">or</span> pass <span class="hljs-keyword">the</span> option <span class="hljs-comment">--exit-when-reboot-detected.</span>

Installing <span class="hljs-keyword">the</span> following packages:
microsoft-windows-terminal
By installing you accept licenses <span class="hljs-keyword">for</span> <span class="hljs-keyword">the</span> packages.
Progress: Downloading microsoft-windows-terminal <span class="hljs-number">1.6</span><span class="hljs-number">.10571</span><span class="hljs-number">.0</span>... <span class="hljs-number">100</span>%

microsoft-windows-terminal v1<span class="hljs-number">.6</span><span class="hljs-number">.10571</span><span class="hljs-number">.0</span> [Approved]
microsoft-windows-terminal package <span class="hljs-built_in">files</span> install completed. Performing other installation steps.
Progress: <span class="hljs-number">100</span>% - Processing The install <span class="hljs-keyword">of</span> microsoft-windows-terminal was successful.
Software install location <span class="hljs-keyword">not</span> explicitly <span class="hljs-built_in">set</span>, could be <span class="hljs-keyword">in</span> package <span class="hljs-keyword">or</span>
default install location <span class="hljs-keyword">if</span> installer.

Chocolatey installed <span class="hljs-number">1</span>/<span class="hljs-number">1</span> packages.
See <span class="hljs-keyword">the</span> <span class="hljs-built_in">log</span> <span class="hljs-keyword">for</span> details (C:\ProgramData\chocolatey\logs\chocolatey.<span class="hljs-built_in">log</span>).
</code></pre>
<hr>
<h3 id="windows-subsystem-for-linux-2">Windows Subsystem for Linux 2</h3>
<p><code>Windows Subsystem for Linux 2</code> (<code>WSL2</code>) is the second iteration of Microsoft&#39;s architecture that allows users to run Linux instances, providing the ability to run Bash scripts and other apps like Vim, Python, and more. WSL also allows us to interact with the Windows operating system and file structure from a Unix instance. Best of all, it’s all done without the use of a hypervisor like VirtualBox or Hyper-V.</p>
<p>What does this mean for us? Having the ability to interact with and utilize Linux native tools/applications from our Windows host provides us with a hybrid environment, and all the flexibility that comes with it. To install the subsystem, the quickest route is to utilize chocolatey.</p>
<p><strong>Chocolatey - WSL2</strong></p>
<p>&#x20; Windows</p>
<pre><code class="lang-powershell-session">PS C:\htb&gt; choco install WSL2

Chocolatey v0.<span class="hljs-number">10.15</span>
<span class="hljs-number">2</span> validations performed. <span class="hljs-number">1</span> success(es), <span class="hljs-number">1</span> warning(s), <span class="hljs-built_in">and</span> <span class="hljs-number">0</span> error(s).
Installing the following package<span class="hljs-variable">s:</span>
wsl2
By installing you accept licenses <span class="hljs-keyword">for</span> the packages.
Progres<span class="hljs-variable">s:</span> Downloading wsl2 <span class="hljs-number">2.0</span>.<span class="hljs-number">0.20210122</span>... <span class="hljs-number">100</span>%

wsl2 v2.<span class="hljs-number">0.0</span>.<span class="hljs-number">20210122</span> [Approved]
wsl2 package <span class="hljs-keyword">files</span> install completed. Performing other installation steps.
...SNIP...
wsl2 may <span class="hljs-keyword">be</span> able <span class="hljs-keyword">to</span> <span class="hljs-keyword">be</span> automatically uninstalled.
The install of wsl2 was successful.
Software installed <span class="hljs-keyword">as</span> <span class="hljs-string">'msi'</span>, install location <span class="hljs-keyword">is</span> likely default.

Chocolatey installed <span class="hljs-number">1</span>/<span class="hljs-number">1</span> packages.
See the <span class="hljs-built_in">log</span> <span class="hljs-keyword">for</span> details (C:\ProgramData\chocolatey\logs\chocolatey.<span class="hljs-built_in">log</span>).
</code></pre>
<p>Once WSL is installed, we can add the Linux platform of our choice. The most common one to find is Ubuntu on the Microsoft store. Current Linux distributions supported for WSL are but not limited to:</p>
<ul>
<li><a href="https://www.microsoft.com/store/apps/9pjn388hp8c9">Ubuntu</a> <a href="https://www.microsoft.com/store/apps/9N9TNGVNDL3Q">18.04 LTS</a>, <a href="https://www.microsoft.com/store/apps/9n6svws3rx71">20.04 LTS</a>, and <a href="https://apps.microsoft.com/detail/9nz3klhxdjp5">24.04 LTS</a></li>
<li><a href="https://www.microsoft.com/store/apps/9NJFZK00FGKV">openSUSE Leap 15.1</a></li>
<li><a href="https://www.microsoft.com/store/apps/9MZ3D1TRP8T1">SUSE Linux Enterprise Server 12 SP5</a> and <a href="https://www.microsoft.com/store/apps/9PN498VPMF3Z">15 SP1</a></li>
<li><a href="https://www.microsoft.com/store/apps/9PKR34TNCV07">Kali Linux</a></li>
<li><a href="https://www.microsoft.com/store/apps/9MSVKQC78PK6">Debian GNU/Linux</a></li>
<li><a href="https://www.microsoft.com/store/apps/9n6gdm4k2hnc">Fedora Remix for WSL</a></li>
<li><a href="https://www.microsoft.com/store/apps/9NV1GV1PXZ6P">Pengwin</a> and <a href="https://www.microsoft.com/store/apps/9N8LP0X93VCP">Pengwin Enterprise</a></li>
<li><a href="https://www.microsoft.com/store/apps/9p804crf0395">Alpine WSL</a></li>
</ul>
<p>To install the distribution of our choice, just click the link above, and it will take us to the Microsoft Store page for the distro. Once we have it installed, we need to open a PowerShell prompt and type <code>bash</code>.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/windows-bash.png" alt="Terminal showing PowerShell command &#39;bash&#39; executed, with prompt for running commands as administrator using &#39;sudo&#39;."></p>
<p>Moving forward, we can use it as a regular OS alongside our Windows install.</p>
<hr>
<h3 id="security-configurations-and-defender-modifications">Security Configurations and Defender Modifications</h3>
<p>Since we will be using this platform as a penetration testing host, we may run into issues with Windows Defender finding our tools unsavory. Windows Defender will scan, quarantine, or remove anything it deems potentially harmful. To make sure Defender does not mess up our plans, we will add some exclusion rules to ensure our tools stay in place.</p>
<p><strong>Windows Defender Exemptions for the Tools&#39; Folders.</strong></p>
<ul>
<li><code>C:\Users\your user here\AppData\Local\Temp\chocolatey\</code></li>
<li><code>C:\Users\your user here\Documents\git-repos\</code></li>
<li><code>C:\Users\your user here\Documents\scripts\</code></li>
</ul>
<p>These three folders are just a start. As we add more tools and scripts, we may need to add more exclusions. To exclude these files, we will run the following PowerShell command.</p>
<p><strong>Adding Exclusions</strong></p>
<p>&#x20; Windows</p>
<pre><code class="lang-powershell-session">PS C:<span class="hljs-symbol">\h</span>tb&gt; Add-MpPreference -ExclusionPath "C:<span class="hljs-symbol">\U</span>sers<span class="hljs-symbol">\y</span>our user here<span class="hljs-symbol">\A</span>ppData<span class="hljs-symbol">\L</span>ocal<span class="hljs-symbol">\T</span>emp<span class="hljs-symbol">\c</span>hocolatey<span class="hljs-symbol">\"</span>
</code></pre>
<p>We can repeat the same steps for each folder we wish to exclude.</p>
<hr>
<h3 id="tool-install-automation">Tool Install Automation</h3>
<p>Chocolatey for package management is an obvious choice for automating the initial install of core tools and applications. Combined with PowerShell, it&#39;s possible to design a script that pulls everything for us in one run. Here is an example script to install some of our requirements. As usual, before executing any scripts, we need to change the execution policy. Once we have our initial script built, we can modify it as our toolkit changes and reuse it to speed up our setup process.</p>
<p><strong>Choco Build Script</strong></p>
<p>Code: powershell</p>
<pre><code class="lang-powershell"># Choco build script

<span class="hljs-keyword">write</span>-host <span class="hljs-string">"*** Initial app install for core tools and packages. ***"</span>

<span class="hljs-keyword">write</span>-host <span class="hljs-string">"*** Configuring chocolatey ***"</span>
choco feature enable -n allowGlobalConfirmation

<span class="hljs-keyword">write</span>-host <span class="hljs-string">"*** Beginning install, go grab a coffee. ***"</span>
choco upgrade wsl2 <span class="hljs-keyword">python</span> git vscode openssh openvpn netcat <span class="hljs-keyword">nmap</span> wireshark burp-suite-free-edition heidisql sysinternals putty golang neo4j-community openjdk

<span class="hljs-keyword">write</span>-host <span class="hljs-string">"*** Build complete, restoring GlobalConfirmation policy. ***"</span>
choco feature disable -n allowGlobalConfirmation
</code></pre>
<p>When scripting with Chocolatey, the developers recommend several rules for us to follow:</p>
<ul>
<li>always use <code>choco</code> or <code>choco.exe</code> as the command in your scripts. <code>cup</code> or <code>cinst</code> tends to misbehave when used in a script.</li>
<li>when utilizing options like <code>n</code>, it is recommended that we use the extended option like <code>-name</code>.</li>
<li>Do not use <code>-force</code> in scripts. It overrides Chocolatey&#39;s behavior.</li>
</ul>
<p>Not all of our packages can be acquired from Chocolatey. Fortunately for us, the majority of what is left resides in Github. We can set up a script for these as well, downloading the repositories and binaries we need and extracting them to our scripts folder. Below, we will build out a quick example of a Git script. First, let us see what it looks like to clone a repository to our local host.</p>
<p><strong>Git Clone</strong></p>
<p>&#x20; Windows</p>
<pre><code class="lang-powershell-session">PS C:<span class="hljs-tag">\<span class="hljs-name">htb</span></span>&gt; git clone https://github.com/dafthack/DomainPasswordSpray.git

Cloning into 'DomainPasswordSpray'...
remote: Enumerating objects: 149, done.
remote: Counting objects: 100<span class="hljs-comment">% (6/6), done.</span>
remote: Compressing objects: 100<span class="hljs-comment">% (5/5), done.</span>
Receiving objects:  94<span class="hljs-comment">% (141/149)(delta 1), reused 5 (delta 1), pack-reused 143</span>
Receiving objects: 100<span class="hljs-comment">% (149/149), 51.70 KiB | 3.69 MiB/s, done.</span>
Resolving deltas: 100<span class="hljs-comment">% (52/52), done.</span>
PS C:<span class="hljs-tag">\<span class="hljs-name">Users</span></span><span class="hljs-tag">\<span class="hljs-name">demonstrator</span></span><span class="hljs-tag">\<span class="hljs-name">Documents</span></span><span class="hljs-tag">\<span class="hljs-name">scripts</span></span>&gt; ls

    Directory: C:<span class="hljs-tag">\<span class="hljs-name">Users</span></span><span class="hljs-tag">\<span class="hljs-name">demonstrator</span></span><span class="hljs-tag">\<span class="hljs-name">Documents</span></span><span class="hljs-tag">\<span class="hljs-name">scripts</span></span>

Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----         4/16/2021   4:58 PM                DomainPasswordSpray

PS C:<span class="hljs-tag">\<span class="hljs-name">Users</span></span><span class="hljs-tag">\<span class="hljs-name">demonstrator</span></span><span class="hljs-tag">\<span class="hljs-name">Documents</span></span><span class="hljs-tag">\<span class="hljs-name">scripts</span></span>&gt; cd .<span class="hljs-tag">\<span class="hljs-name">DomainPasswordSpray</span></span><span class="hljs-tag">\<span class="hljs-name">
</span></span>PS C:<span class="hljs-tag">\<span class="hljs-name">Users</span></span><span class="hljs-tag">\<span class="hljs-name">demonstrator</span></span><span class="hljs-tag">\<span class="hljs-name">Documents</span></span><span class="hljs-tag">\<span class="hljs-name">scripts</span></span><span class="hljs-tag">\<span class="hljs-name">DomainPasswordSpray</span></span>&gt; ls

    Directory: C:<span class="hljs-tag">\<span class="hljs-name">Users</span></span><span class="hljs-tag">\<span class="hljs-name">demonstrator</span></span><span class="hljs-tag">\<span class="hljs-name">Documents</span></span><span class="hljs-tag">\<span class="hljs-name">scripts</span></span><span class="hljs-tag">\<span class="hljs-name">DomainPasswordSpray</span></span>

Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
-a----         4/16/2021   4:58 PM          19419 DomainPasswordSpray.ps1
-a----         4/16/2021   4:58 PM           1086 LICENSE
-a----         4/16/2021   4:58 PM           2678 README.md
</code></pre>
<p>We issued the <code>git clone</code> command with the URL to the repository we needed. From the output, we can tell it created a new folder in our scripts folder then populated it with the files from the GitHub repository.</p>
<hr>
<h3 id="testing-vms">Testing VMs</h3>
<p>It is standard practice to prepare ones penetration testing VMs against the most common operating systems and their patch levels. This is especially necessary if we want to mirror our target machines and test our exploits before applying them to real machines. For example, we can install a Windows 10 VM that is built on different <a href="https://support.microsoft.com/en-us/topic/windows-10-update-history-24ea91f4-36e7-d8fd-0ddb-d79d9d0cdbda">patches</a> and <a href="https://docs.microsoft.com/en-us/windows/release-health/release-information">releases</a>. This will save us considerable time in the course of our penetration tests, as we will likely not need to configure them again. These VMs will help us refine our approach and our exploits, and help us better understand how an interconnected system might react—because it may be that we only get one attempt to execute the exploit.</p>
<p>The good thing here is that we do not have to set up 20 VMs for this but can work with snapshots. For example, we can start with Windows 10 version 1607 (OS build 14393) and update our system step by step and create a snapshot of the clean system from each of these updates and patches. Updates and patches can be downloaded from the <a href="https://www.catalog.update.microsoft.com/Search.aspx?q=KB4550994">Microsoft Update Catalog</a>. We just need to use the <code>Kb article</code> designation, and there we will find the appropriate files to download and patch our systems.</p>
<p>Tools that can be used to install older versions of Windows:</p>
<ul>
<li><a href="https://community.chocolatey.org/">Chocolatey</a></li>
<li><a href="https://gist.github.com/AveYo/c74dc774a8fb81a332b5d65613187b15">MediaCreationTool.bat</a></li>
<li><a href="https://www.heidoc.net/joomla/technology-science/microsoft/67-microsoft-windows-and-office-iso-download-tool%EF%BB%BF">Microsoft Windows and Office ISO Download Tool</a></li>
<li><a href="https://rufus.ie/en_US/">Rufus</a></li>
</ul>
<hr>
<h2 id="backups-and-recovery">Backups and Recovery</h2>
<hr>
<p>Backups and recovery mechanisms are one of the most important safeguards against data loss, system compromise and business interruption.</p>
<p>When we simulate cyberattacks, we look at backups and recovery systems through a dual lens: as protective measures that can mitigate the damage and as high priority targets that attackers could exploit. To understand the importance of these systems, we need to examine how they perform under stress, what role they play in incident response, and in what real-world cases they have improved or degraded an organization&#39;s security. The best way to understand this is to develop our own backup and (disaster) recovery strategies.</p>
<p>For example, in a ransomware attack on <a href="https://www.cisa.gov/news-events/news/attack-colonial-pipeline-what-weve-learned-what-weve-done-over-past-two-years">Colonial Pipeline in 2021</a>, the attackers encrypted key systems and demanded millions in ransom. The company&#39;s ability to quickly restore operations depended on robust backups that were isolated from the attacked network.</p>
<p>Recovery processes are equally important as they determine how quickly a company can return to normality after an intrusion. As penetration testers, we can simulate scenarios where systems are locked down or data is exfiltrated, and assess the speed and accuracy of recovery if the events are detected at all (yes, unfortunately this still happens). A poor recovery process can exacerbate the damage, as seen with <a href="https://archive.epic.org/privacy/data-breach/equifax/">Equifax in 2017</a>, where a poor incident response exacerbated the exposure of 147 million people&#39;s data.</p>
<p>Let’s take a look at a few solution that we can use to properly backup your system and restore it if necessary.</p>
<hr>
<h3 id="pika-backup">Pika Backup</h3>
<p><a href="https://apps.gnome.org/PikaBackup/">Pika Backup</a> is a user-friendly backup solution with a GUI which allows us to create backups locally and remotely. A big advantage is that it doesn’t copy files it already copied. It copies only new files or files that have been modified since the last backup. Additionally it supports encryption which adds another layer of security and its easy to set up.</p>
<p>&#x20; Backups and Recovery</p>
<pre><code class="lang-shell-session"><span class="hljs-meta"># Update</span>
cry0l1t3<span class="hljs-symbol">@hbt[</span>/htb]$ sudo apt update -y 

<span class="hljs-meta"># Install Pika Backup</span>
cry0l1t3<span class="hljs-symbol">@hbt[</span>/htb]$ sudo apt install flatpak -y
cry0l1t3<span class="hljs-symbol">@hbt[</span>/htb]$ flatpak remote-add --<span class="hljs-keyword">if</span>-<span class="hljs-literal">not</span>-exists flathub https://flathub.org/repo/flathub.flatpakrepo
cry0l1t3<span class="hljs-symbol">@hbt[</span>/htb]$ flatpak install flathub org.gnome.World.PikaBackup

<span class="hljs-meta"># Run Pika Backup</span>
cry0l1t3<span class="hljs-symbol">@hbt[</span>/htb]$ flatpak <span class="hljs-built_in">run</span> org.gnome.World.PikaBackup
</code></pre>
<p>Once we have started Pika Backup we can setup the backup process and configure it the way we need.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/bak1.png" alt="Pika Backup screen showing &#39;No Backup Configured&#39; with a button to &#39;Setup Backup&#39;."></p>
<p>Pika Backup uses BorgBackup repositories, which are directories containing (encrypted and) deduplicated archives. Deduplicated archives is a type of data archive where redundant copies can be identified and removed to reduce storage space and improve efficiency. Each data in an archive is split into a smaller chunk and based on its content it is assigned to a unique hash. If a chunk’s hash matches an existing one it will be discarded. In production environments where the host can be access through the internet (e.g. web server) it is recommended to follow the 3-2-1 rule:</p>
<ul>
<li>3 copies of your data</li>
<li>2 on different devices</li>
<li>1 offsite</li>
</ul>
<p><img src="https://academy.hackthebox.com/storage/modules/87/bak2.png" alt="Pika Backup setup screen with options to create or use existing repository, showing &#39;Location on Disk&#39; and &#39;Remote Location&#39; for both."></p>
<p>We can specify the location where the local repository can be created. In this example, we will use a connected HDD with a directory called <code>backup</code>.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/bak3.png" alt="Pika Backup location selection screen showing &#39;Repository Base Folder&#39; set to &#39;backup&#39; and &#39;Repository Name&#39; as &#39;backup-ubuntu-cry0l1t3&#39; with a &#39;Continue&#39; button."></p>
<p>Once the directory for the repository is specified, we can setup the encryption phrase that Pika Backup uses in order to encrypt all our archives. The same way as BorgBackup, Pika Backup employs AES-256-CTR encryption which provides high security.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/bak4.png" alt="Pika Backup encryption setup screen with &#39;Use Encryption&#39; toggled to &#39;Encrypted&#39;, showing password fields for new and repeated password, and a &#39;Create&#39; button."></p>
<p>After the encryption has been set, we can move on and initiate the first backup or dive deeper into the configuration—exploring things such as the schedule, included, and excluded files and directories. In this example, we’re going to backup just the home directory as you can see in the <code>Files to Back up</code> section and exclude all <code>Caches</code>.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/bak5.png" alt="Pika Backup screen showing &#39;Backup Never Ran&#39; with options to back up &#39;Home&#39; folder and exclude &#39;Caches&#39;, and a &#39;Back Up Now&#39; button."></p>
<p>For the archives we can specify an archive index of our choice. We also can run the <code>Data Integrity Check</code> manually which checks the latest backup archives with the current status and makes updates if any files has been modified since the last backup.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/bak6.png" alt="Pika Backup archives screen showing &#39;home&#39; directory with 20.4 GB available of 52.5 GB total, options for &#39;Archive Prefix&#39; and &#39;Cleanup Archives&#39;, and &#39;No Integrity Check&#39; performed. No archives available."></p>
<p>In the <code>Schedule</code> tab we can specify how often a backup needs to be created. The recommended schedule is to do a backup daily for 2 weeks period.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/bak7.png" alt="Pika Backup schedule screen showing &#39;Waiting for Backup to Start&#39;, with options to regularly create backups daily at 21:00, and to regularly clean up archives. &#39;Save Configuration&#39; button is present."></p>
<p>Once everything is set up, we can launch the backup process and wait until its finished.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/bak8.png" alt="Pika Backup screen showing &#39;Backup Running&#39; at 4.0% for &#39;home&#39; directory, with options to abort, and lists of files to back up and exclude."></p>
<hr>
<h3 id="duplicati">Duplicati</h3>
<p><a href="https://duplicati.com/download">Duplicati</a> is a cross-platform backup solution also with strong capabilities. It also supports AES-256 for encryption, with optional asymmetric encryption using GPG (RSA or similar for key exchange). Data is encrypted client-side and it supports strong password-based key derivation. A great advantage for many people is the number of remote destinations Duplicati supports:</p>
<ul>
<li>Google Drive</li>
<li>OneDrive</li>
<li>Amazon S3</li>
<li>SFTP</li>
<li>Dropbox</li>
<li>and others.</li>
</ul>
<p>The installation process is also very simple but instead of using a GUI, Duplicati is uses a webserver for management. Let’s <a href="https://duplicati.com/download">download</a> the installation package and install it.</p>
<p>&#x20; Backups and Recovery</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@hbt</span>[<span class="hljs-regexp">/htb]$ cd ~/</span>Downloads
cry0l1t3<span class="hljs-variable">@hbt</span>[<span class="hljs-regexp">/htb]$ sudo apt install ./duplicati</span>-<span class="hljs-number">2.1</span>.<span class="hljs-number">0</span>.<span class="hljs-number">5_</span>stable_2025-<span class="hljs-number">03</span>-<span class="hljs-number">04</span>-linux-x64-gui.deb
cry0l1t3<span class="hljs-variable">@hbt</span>[<span class="hljs-regexp">/htb]$ duplicati</span>
</code></pre>
<p>Once installed, we can navigate to <a href="http://localhost:8200">http://localhost:8200</a> and will see a webpage similar to this:</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/bak9.png" alt="Duplicati interface showing &#39;Add a new backup&#39; with options to configure a new backup or import from a file, and a &#39;Next&#39; button."></p>
<p>In the <code>Add backup</code> tab we can start to specify our general backup settings, give it a name, set encryption and the passphrase for it.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/bak10.png" alt="Duplicati backup settings screen with fields for &#39;Name&#39;, &#39;Description&#39;, &#39;Encryption&#39;, &#39;Passphrase&#39;, and &#39;Repeat Passphrase&#39;, and a &#39;Next&#39; button."></p>
<p>In this example, we’ll configure Duplicati to make backups and send them to a remote server. One of the most recommended and most secure methods is the file transfer through SSH/SFTP by using SSH keys. Therefore, we need to generate a separate SSH key by using the <code>ssh-keygen</code> command.</p>
<p>&#x20; Backups and Recovery</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-meta">@hbt[/htb]$</span> ssh-keygen -t ed25519

Generating public/private ed25519 key pair.

Enter file in which to save the key (/home/cry0l1t3/.ssh/id_ed25519): duplicati
Enter passphrase (empty for no passphrase): <span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span>
Enter same passphrase again: <span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span>

Your identification has been saved in duplicati
Your public key has been saved in duplicati.pub
The key fingerprint is:
SHA256:2mKNI0ZOfVMuwkFenV4NtUv0hwiHTir0gGYfR/Lhm8Q cry0l1t3<span class="hljs-meta">@ubuntu</span>
The key's randomart image is:
+--[ED25519 256]--+
|<span class="hljs-string">     .o.+..oo+o  </span>|
|<span class="hljs-string">    +o+*..=o.o.+ </span>|
|<span class="hljs-string">   o oo=E=... + o</span>|
|<span class="hljs-string">     oooo=o  . ..</span>|
|<span class="hljs-string">    o +.S .   .  </span>|
|<span class="hljs-string">   +   B o       </span>|
|<span class="hljs-string">    + * o        </span>|
|<span class="hljs-string">   . o o         </span>|
|<span class="hljs-string">                 </span>|
+----[SHA256]-----+
</code></pre>
<p>Once the SSH key has been created we now can specify the storage type, remote IP addres and port, path on the server, username and in <code>Advanced options</code> we can add the authentication method <code>ssh-key</code>.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/bak11.png" alt="Duplicati backup destination setup with SFTP, server IP 10.129.12.122, port 50022, path &#39;/home/duplicati&#39;, username &#39;duplicati&#39;, and &#39;Test connection&#39; button."></p>
<p>After that we can select the source data that needs to be backed up. A huge advantage that Duplicati provides is the filter functionality using regular expressions.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/bak12.png" alt="Duplicati source data selection screen with folder tree for &#39;User data&#39; and &#39;Computer&#39;, option to show hidden folders, and filter settings."></p>
<p>As the last step we can configure the schedule for the backups.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/bak13.png" alt="Duplicati schedule screen with &#39;Automatically run backups&#39; checked, next run at 01:00 PM on 04/27/2025, repeating every day, with all days selected."></p>
<p>It is highly recommended that your backups (especially when they are stored on a remote server) are encrypted at rest and in transit. This means that your data should be stored in repositories and during the transfer. Both Pika Backup and Duplicati support this functionality and therefore help organizations to fullfil compliance regulations like GDPR and HIPPA.</p>
<p>We also recommend to simulate a <code>Disaster Recovery</code> situation where your server all of the sudden doesn’t work properly anymore or data has been lost and you need to recover the last state of it from scratch. While going through this process you will learn what kind of things can happen during recovery and if your process works as expected. Keep in mind that you should keep notes and document the process step-by-step so you have a continuity plan in place that you can use to restore your data. We also recommend to simulate this situation twice a year or once a quarter to ensure that the process you have set up works as expected. Because when things brake, your continuity plan is your last to restore everything you have built.</p>
<hr>
<h2 id="vps-providers">VPS Providers</h2>
<hr>
<p>A <code>Virtual Private Server</code> (<code>VPS</code>) is an isolated environment created on a physical server using virtualization technology. A VPS is fundamentally part of <code>Infrastructure-as-a-Service</code> (<code>IaaS</code>) solutions. This solution offers all the advantages of an ordinary server, with specially allocated resources and complete management freedom. We can freely choose the operating system and applications we want to use, with no configuration restrictions. This VM uses the resources of a physical server and provides users with various server functionalities comparable to those of a dedicated server. It is therefore also referred to as a <code>Virtual Dedicated Server</code> (<code>VDS</code>).</p>
<p>A VPS positions itself as a compromise between inexpensive shared hosting and the usually costly rental of dedicated server technology. This hosting model&#39;s idea is to offer users the most comprehensive possible range of functions at manageable prices. The virtual replication of individual computer systems on a standard host system involves significantly less effort for a web hoster than the provision of separate hardware components for each customer. Extensive independence of the individual guest systems is achieved through encapsulation. Each VPS on the shared hardware base acts isolated from other, parallel operating systems. In most cases, VPS is used for the following purposes, but not limited to:</p>
<table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody>
<tr>
<td>Webserver</td>
<td>LAMP/XAMPP stack</td>
<td>Mail server</td>
<td>DNS server</td>
</tr>
<tr>
<td>Development server</td>
<td>Proxy server</td>
<td>Test server</td>
<td>Code repository</td>
</tr>
<tr>
<td>Pentesting</td>
<td>VPN</td>
<td>Gaming server</td>
<td>C2 server</td>
</tr>
</tbody>
</table>
<p>We can choose from a range of Windows and Linux operating systems to provide the required operating environment for our desired application or software during installation. Windows servers can cost twice as much as Linux servers on some providers. You should keep this in mind when selecting a provider.</p>
<table data-header-hidden><thead><tr><th width="170.75"></th><th></th><th></th><th></th><th width="98"></th><th></th></tr></thead><tbody><tr><td><strong>Provider</strong></td><td><strong>Price</strong></td><td><strong>RAM</strong></td><td><strong>CPU Cores</strong></td><td><strong>Storage</strong></td><td><strong>Transfer/Bandwidth</strong></td></tr><tr><td><a href="https://www.linode.com/pricing/">Linode</a></td><td>$12/mo</td><td>2GB</td><td>1 CPU</td><td>50 GB</td><td>2 TB</td></tr><tr><td><a href="https://www.digitalocean.com/pricing">DigitalOcean</a></td><td>$10/mo</td><td>2GB</td><td>1 CPU</td><td>50 GB</td><td>2 TB</td></tr><tr><td><a href="https://onehostcloud.hosting/">OneHostCloud</a></td><td>$14.99/mo</td><td>2GB</td><td>1 CPU</td><td>50 GB</td><td>2 TB</td></tr></tbody></table>

<hr>
<h2 id="vps-setup">VPS Setup</h2>
<hr>
<p>Whether we are on an internal or external penetration test, a VPS that we can use is of great importance to us in many different cases. We can store all our resources on it and access them from almost any point with internet access. Apart from the fact that we first have to set up the VPS, we also have to prepare the corresponding folder structure and its services. In this example, we will deal with the provider called <a href="https://www.linode.com/">Linode</a> and set up our VPS there. For the other providers, the configuration options look almost identical.</p>
<p>First, we need to select the location closest to us. This will ensure an excellent connection to our server. If we need to perform a penetration test on another continent, we can also set up a VPS there using our automation scripts and perform the penetration test from there. We should still read the individual information about their components carefully and understand what kind of VPS we will be working with in the future. In Linode, we can choose one of the four different servers. For our purposes, the <code>Shared CPU</code> server is sufficient for now. For the Linux Distribution, we select which operating system should be installed on the VPS. ParrotOS is based on <code>Debian</code>, just like Ubuntu. Here we can choose one of these two or go to advanced options and upload our ISO.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/vpss1.png" alt="Linode creation screen showing region set to Frankfurt, OS as Ubuntu 24.04 LTS, and shared CPU plans with pricing for Nanode 1 GB and Linode 2 GB."></p>
<p>Linode’s Marketplace offers many different applications that have been preconfigured and can be installed right away.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/vpss2.png" alt="Linode Marketplace screen showing options to select new apps like Apache Spark, Backstage, and popular apps like WordPress and cPanel."></p>
<p>Next, we need to choose the performance level for our VPS. This is one of the points where the cost can change a lot. For our purposes, however, we can choose one of the first two options on the top. However, here we need to select the performance for which we want to use the VPS. If the VPS is to be used for advanced purposes and provides many requests and services, 1024MB memory will not be enough. Therefore, it is always advisable to first set up the installation of our OS locally in a VM and then check the services&#39; load.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/vpss3.png" alt="Linode Plan screen showing shared CPU options with pricing and specifications for Nanode 1 GB and Linode 2 GB, including RAM, storage, and transfer details."></p>
<p>After that, in the <code>Security</code> section we need to specify <code>root</code>&#39;s password and we also can add SSH keys, which we can use to log in to the VPS via SSH later. We can also generate these keys later on our VPS or our VM or own host operating system. Let&#39;s use our VM to generate the key pair. Let’s generate a new SSH key and add it to our VPS.</p>
<p><strong>Generate SSH Keys</strong></p>
<p>&#x20; VPS Setup</p>
<pre><code class="lang-shell-session">┌─[cry0l1t3@parrot]─[~]
└──╼ $ ssh-keygen -t ed25519 -f vps-ssh

Generating <span class="hljs-keyword">public</span>/<span class="hljs-keyword">private</span> rsa <span class="hljs-keyword">key</span> pair.
Enter passphrase (empty <span class="hljs-keyword">for</span> no passphrase): ******************
Enter same passphrase again: ******************
Your identification has been saved <span class="hljs-keyword">in</span> vps-ssh
Your <span class="hljs-keyword">public</span> <span class="hljs-keyword">key</span> has been saved <span class="hljs-keyword">in</span> vps-ssh.pub
The <span class="hljs-keyword">key</span> fingerprint <span class="hljs-keyword">is</span>:
SHA256:zXyVAWK00000000000000000000VS4a/f0000+ag cry0l1t3@parrot
The <span class="hljs-keyword">key</span><span class="hljs-comment">'s randomart image is:</span>
&lt;SNIP&gt;
</code></pre>
<p>With the command shown above, we generate two different keys. The <code>vps-ssh</code> is the <code>private key</code> and must not be shared anywhere or with anyone. The second <code>vps-ssh.pub</code> is the <code>public key</code> which we can now insert in the Linode control panel.</p>
<p><strong>SSH Keys</strong></p>
<p>&#x20; VPS Setup</p>
<pre><code class="lang-shell-session">┌─[cry0l1t3@parrot]─[~]
└──╼ $ ls -l vps*-rw-------<span class="hljs-number"> 1 </span>cry0l1t3 cry0l1t3<span class="hljs-number"> 3434 </span>Mar<span class="hljs-number"> 30 </span>12:23 vps-ssh
-rw-r--r--<span class="hljs-number"> 1 </span>cry0l1t3 cry0l1t3 <span class="hljs-number"> 741 </span>Mar<span class="hljs-number"> 30 </span>12:23 vps-ssh.pub

┌─[cry0l1t3@parrot]─[~]
└──╼ $ cat vps-ssh.pub
</code></pre>
<p><img src="https://academy.hackthebox.com/storage/modules/87/vpss4.png" alt="Linode SSH key setup screen with fields for &#39;Label&#39; and &#39;SSH Public Key&#39;, and options to add or cancel."></p>
<p>Once everything is set up, we can click on <code>Create Linode</code> and wait until it finished the installation. After the VPS is ready, we can access it via SSH.</p>
<p><strong>SSH Using Password</strong></p>
<p>&#x20; VPS Setup</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-meta">@htb[/htb]$</span> ssh root<span class="hljs-meta">@&lt;vps-ip-address&gt;</span>

root<span class="hljs-meta">@VPS's</span> password:

[root<span class="hljs-meta">@VPS</span> ~]<span class="hljs-comment">#</span>
</code></pre>
<p>After that, we should add a new user for the VPS to not run our services with root or administrator privileges. For this, we can then generate another SSH key and insert it for this user.</p>
<p><strong>Adding a New Sudo User</strong></p>
<p>&#x20; VPS Setup</p>
<pre><code class="lang-shell-session">[root<span class="hljs-symbol">@VPS</span> ~]<span class="hljs-meta"># adduser cry0l1t3</span>
[root<span class="hljs-symbol">@VPS</span> ~]<span class="hljs-meta"># usermod -aG sudo cry0l1t3</span>
[root<span class="hljs-symbol">@VPS</span> ~]<span class="hljs-meta"># su - cry0l1t3</span>
Password: ********

[cry0l1t3<span class="hljs-symbol">@VPS</span> ~]$
</code></pre>
<p><strong>Adding Public SSH Key to VPS</strong></p>
<p>&#x20; VPS Setup</p>
<pre><code class="lang-shell-session">[cry0l1t3<span class="hljs-meta">@VPS</span> ~]$ mkdir ~/.ssh
[cry0l1t3<span class="hljs-meta">@VPS</span> ~]$ echo <span class="hljs-string">'&lt;vps-ssh.pub&gt;'</span> &gt; <span class="hljs-regexp">~/.ssh/</span>authorized_keys
[cry0l1t3<span class="hljs-meta">@VPS</span> ~]$ chmod <span class="hljs-number">600</span> <span class="hljs-regexp">~/.ssh/</span>authorized_keys
</code></pre>
<p>Once we have added this to the <code>authorized_keys</code> file, we can use the <code>private key</code> to log in to the system via SSH.</p>
<p><strong>Using SSH Keys</strong></p>
<p>&#x20; VPS Setup</p>
<pre><code class="lang-shell-session">Cry0l1t3<span class="hljs-meta">@htb[/htb]$</span> ssh cry0l1t3<span class="hljs-meta">@&lt;vps-ip-address&gt;</span> -i vps-ssh

[cry0l1t3<span class="hljs-meta">@VPS</span> ~]$
</code></pre>
<hr>
<h2 id="server-management">Server Management</h2>
<hr>
<p>When it comes to server management, one of the most critical aspects (besides security) is to keep the server fast, reliable, and ready to handle the tasks it was build for. It is therefore highly recommended to keep the server up-to-date and set it up in such way that it has enough resources to handle everything needed. Another important aspect is the access to the server. Instead of setting up all the services we want to use, and then focusing on restricting the ways the server can be accessed—we will do it the other way around. Otherwise, certain access points to our own server might be overlooked, making ourselves vulnerable. Therefore, when we start building a remote server, first we need to ensure the server has only 1-way of access using secure protocol for communication. The best approach is to ensure that at the beginning the server can be accessed only through SSH using a authentication key and not a password.</p>
<p>Hardening SSH access is one important aspect. Another one is that we also need to focus on is key management. When we have to manage just a few servers, that might be pretty easy and straightforward. When your responsibility rises to manage a few hundred servers however, there is a high need to manage them efficiently. In such a case, organizations and businesses use a combination of <a href="https://goteleport.com/">Teleport</a> and <a href="https://docs.ansible.com/ansible/latest/index.html">Ansible</a>.</p>
<p>When configuring your server, it is recommended to keep the <code>Zero Trust</code> principle in mind - <code>No one and nothing - whether inside or outside a network - can be trusted automatically</code>. Think of it like a high-security building. Even if you&#39;re an employee, you need to show your ID and pass a checkpoint every time you enter, and you only get access to the rooms you need.</p>
<hr>
<h3 id="ssh-agent">SSH Agent</h3>
<p>SSH Agent is a program that runs in the background and is usually installed on most Linux systems by default. We use the <code>ssh</code> tool to connect to our remote servers securely and the SSH agent helps by storing and managing your SSH keys, which are like your ID used to prove your identity to the server. Let&#39;s first ensure we harden our SSH server and make it a little bit more secure. On Ubuntu and Debian distributions we can find the SSH server configuration file in <code>/etc/ssh/sshd_config</code>.</p>
<p><strong>Server Side</strong></p>
<p>&#x20; Server Management</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@MyVPS</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>vim /etc/ssh/sshd_config
</code></pre>
<p>You will see many different settings that can be enabled, but the first ones we highly recommend you to change are the following:</p>
<p>Code: bash</p>
<pre><code class="lang-bash"><span class="hljs-attribute">PermitRootLogin</span> <span class="hljs-literal">no</span>
PubkeyAuthentication <span class="hljs-literal">yes</span>
PasswordAuthentication <span class="hljs-literal">no</span>
X11Forwarding <span class="hljs-literal">no</span>
Port <span class="hljs-number">4444</span>
AllowUsers cry0l1t3
</code></pre>
<p>In this example, we disabled the access for the user <code>root</code> through SSH and allow connections on TCP port 4444 for the user <code>cry0l1t3</code> only through ssh key authentication method. Once these changes have been made we need to restart the SSH server.</p>
<p>&#x20; Server Management</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@MyVPS</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>sudo service ssh restart
</code></pre>
<p>In order to use the SSH agent there are a few things we need to do. First, we need a highly secure SSH key. One of the most effective methods is the following:</p>
<p><strong>Client Side</strong></p>
<p>&#x20; Server Management</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-meta">@htb:~$</span> ssh-keygen -t ed25519 -f ~/.ssh/cry0l1t3

Generating public/private ed25519 key pair.
Enter passphrase (empty for no passphrase): <span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span>
Enter same passphrase again: <span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span><span class="hljs-symbol">*</span>

Your identification has been saved in /home/cry0l1t3/.ssh/cry0l1t3
Your public key has been saved in /home/cry0l1t3/.ssh/cry0l1t3.pub
The key fingerprint is:
SHA256:5TNgGHaqFsIhfqbsFPxa2PllgV2NZdHacaxNddlA0WI cry0l1t3<span class="hljs-meta">@MyVPS</span>
The key's randomart image is:
+--[ED25519 256]--+
|<span class="hljs-string">. .   o ..++o.=+*</span>|
|<span class="hljs-string">oo . .o=.... oE=+</span>|
|<span class="hljs-string"> +oo..ooo . o.*. </span>|
|<span class="hljs-string">. O..o ..+ . o . </span>|
|<span class="hljs-string"> = =o  oS +      </span>|
|<span class="hljs-string">o o.. o    o     </span>|
|<span class="hljs-string"> o   .           </span>|
|<span class="hljs-string">                 </span>|
|<span class="hljs-string">                 </span>|
+----[SHA256]-----+
</code></pre>
<p>Ensure that at this point you add your SSH public key (<code>&lt;your_key&gt;.pub</code>) to the remote server into <code>~/.ssh/authorized_keys</code> and set the appropriate permissions for this file.</p>
<p>&#x20; Server Management</p>
<pre><code class="lang-shell-session"><span class="hljs-comment"># Remote Server</span>
cry0l1t3<span class="hljs-variable">@MyVPS</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>sudo chmod <span class="hljs-number">600</span> ~<span class="hljs-regexp">/.ssh/authorized</span>_keys
</code></pre>
<p>Then, we need to add the private key to the SSH agent and create a configuration file for the SSH agent in the <code>.ssh</code> directory.</p>
<p>&#x20; Server Management</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-meta">@MyVPS</span>:~$ ssh-add <span class="hljs-regexp">~/.ssh/</span>cry0l1t3
Enter passphrase <span class="hljs-keyword">for</span> <span class="hljs-regexp">/home/</span>cry0l1t3<span class="hljs-regexp">/.ssh/</span><span class="hljs-string">cry0l1t3:</span>
Identity <span class="hljs-string">added:</span> <span class="hljs-regexp">/home/</span>cry0l1t3<span class="hljs-regexp">/.ssh/</span>cry0l1t3 (cry0l1t3<span class="hljs-meta">@MyVPS</span>)

cry0l1t3<span class="hljs-meta">@MyVPS</span>:~$ vim <span class="hljs-regexp">~/.ssh/</span>config
</code></pre>
<p>In this configuration file we will setup the name we want to use for the server, its IP address or domain, the identity file, the port, the user, and tell SSH to only use the key specified. and not try other keys. This makes the connections a bit faster and substantially more secure.</p>
<p>Code: bash</p>
<pre><code class="lang-bash">Host MyVPS
    HostName <span class="hljs-tag">&lt;IP Address/domain name&gt;</span>
    IdentityFile ~/.ssh/cry0l1t3
    Port <span class="hljs-number">4444</span>
    <span class="hljs-keyword">User</span> <span class="hljs-title">cry0l1t3</span>
    IdentitiesOnly yes
</code></pre>
<p>With the next command we start the SSH agent in our terminal session. If you want to start the SSH agent automatically, you can add this command to your <code>~/.bashrc</code> or <code>~/.zshrc</code> file.</p>
<p>&#x20; Server Management</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@htb</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>eval <span class="hljs-variable">$(</span>ssh-agent)
</code></pre>
<p>Now, we can use SSH client just by typing the name (<code>MyVPS</code>) we have set for that server and connect to it.</p>
<p>&#x20; Server Management</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@htb</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>ssh MyVPS
</code></pre>
<hr>
<h3 id="password-secret-management">Password &amp; Secret Management</h3>
<p>Password management is the practice of creating, storing, and organizing passwords and secrets to keep the access to accounts and systems secure, while requiring less effort to use. Since most people use one password (which often is not even secure), having a password manager that can generate and store complex passwords is highly recommended. There are many different options that you can choose from:</p>
<table>
<thead>
<tr>
<th><a href="https://proton.me/pass">Proton</a></th>
<th><a href="https://bitwarden.com/">Bitwarden</a></th>
<th><a href="https://1password.com/">1Password</a></th>
<th><a href="https://www.passbolt.com/">Passbolt</a></th>
<th><a href="https://psono.com/">Psono</a></th>
<th><a href="https://passky.org/">Passky</a></th>
<th><a href="https://openbao.org/">OpenBao</a></th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>You can use any of these managers since all of them provide suitable solutions to securely store the data. Except for Psono and Passbolt, all of the mentioned managers utlize end-to-end-encryption (E2EE), which allows only the user to decrypt it. E2EE is a security model where data is encrypted on the sender&#39;s device and can only be decrypted by the recipient&#39;s device. No one in between (including service providers) can access the unencrypted (plaintext) data.</p>
<p>Psono uses client-side encryption and Passbolt makes use of GPG encryption. GPG encryption utilizes private and public keys like SSH. The public key (which can be shared with others) is used for encryption and only the one who holds the private key (which never should be shared with others) can decrypt the data. Client-side encryption means that the data is encrypted on the device before being sent.</p>
<p>Additionally, Linode has preconfigured images on their marketplace that can be used to quickly self-host such managers.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/servm1.png" alt="Linode Marketplace app selection screen showing options for OpenBao, HashiCorp Vault, Passbolt Community Edition, and Passky."></p>
<hr>
<h3 id="git-hosting">Git Hosting</h3>
<p>Git is a distributed version control system (DVCS) designed to help developers manage changes to files, particularly code, over time. It allows to collaborate on a project with multiple people, track the history of changes, and maintain different versions of their work efficiently.</p>
<p>For example, if you release a new version of your software or tool and something breaks, you always can jump back to the previous version. Additionally, you can work on as many features at the same time as you want without breaking the original version of your software, then merge them to the original branch as soon as it&#39;s tested. This process is also known as Continuous Integration and Continuous Delivery or Deployment (CI/CD).</p>
<p>Besides developing tools and software, we can use private repositories for our own preferences and needs. For example, we can store our dotfiles (configuration files) for our environment or services. This makes the configuration of new VMs more streamlined since we can easily clone the repository and replace the necessary configuration files.</p>
<p>There are many providers that use this technology and many of them can be self-hosted if needed.</p>
<table>
<thead>
<tr>
<th><a href="https://github.com/">Github</a></th>
<th><a href="https://about.gitlab.com/">Gitlab</a></th>
<th><a href="https://bitbucket.org/">BitBucket</a></th>
<th><a href="https://about.gitea.com/">Gitea</a></th>
<th><a href="https://onedev.io/">OneDev</a></th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>Linode also provides preconfigured images that can be used right away.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/servm2.png" alt="Linode Marketplace app selection screen showing options for Gitea and GitLab under the Development category."></p>
<hr>
<h2 id="network-security">Network Security</h2>
<hr>
<p>Network security is one of the most critical aspects of cybersecurity and requires the utmost attention. Since this part is where we set the rules for access, it is paramount we do it well. Afterwards, we mostly just need to monitor and ensure that it stays as hardened as we want. However, even this is a massive workload.</p>
<p>Since we are focusing on security (and at the same time at efficiency), we need something that allows us to configure the access to remote servers in a way that&#39;s quick and easy. Some of these solutions are offered by:</p>
<table>
<thead>
<tr>
<th><a href="https://netbird.io/">Netbird</a></th>
<th><a href="https://tailscale.com/">Tailscale</a></th>
<th><a href="https://www.twingate.com/">Twingate</a></th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p>Zero Trust Network Access (<code>ZTNA</code>) is what these providers are focusing on and it&#39;s a relatively new framework. Redefining secure access, ZTNA represents a significant departure from traditional perimeter-based models such as VPNs. Based on the principle of <code>never trust, always verify</code>, ZTNA authenticates and authorizes every user, every device and every single connection attempt based on identity, context, device and security status, ensuring granular access to resources that have been set by the administrators instead of broad network or group access.</p>
<p>On the one hand, it makes our network resources much more secure. On the other hand, it can become very complex to manage every single device and resource. Which solution to use depends on the use case.</p>
<p><a href="https://netbird.io/">Netbird</a> excels in use cases requiring simple, automated setup for secure access to cloud and on-premises resources, like connecting developer workstations to private repositories.</p>
<p><a href="https://tailscale.com/">Tailscale</a> is a WireGuard-based virtual private cloud and requires minimal configuration which makes it perfect for use cases such as securing remote employees connections to internal services (e.g., CI/CD pipelines, internal dashboards) or enabling site-to-site networking without complex firewall rules.</p>
<p><a href="https://www.twingate.com/">Twingate</a>&#39;s Relay and Connector architecture and API-first design make it ideal for things like securing access to databases, Kubernetes clusters, or legacy applications in multi-cloud or on-premises environments.</p>
<p>It is highly recommended to try each of them for free and figure out which one fits your needs best. Since these providers offer similar services, each of them has different philosophy and focus. Which one is right is a question that can only be answered once you have an idea of how your network is going to look. In this case we will go with Netbird.</p>
<hr>
<h3 id="netbird">Netbird</h3>
<p>Netbird&#39;s open-source nature and WireGuard-based peer-to-peer (P2P) mesh network make it ideal for teams with technical expertise to manage infrastructure, particularly for securing hybrid environments with distributed devices, such as remote work setups, servers, internal resources, or even small branch offices. A huge advantage of Netbird is that it can be self-hosted.</p>
<p>By visiting Netbird&#39;s page, you can register for free. Their registration process is fairly straightforward and doesn&#39;t require much explanation. Once you have confirmed your email address, you will get access to their dashboard that will look similar to this:</p>
<p><strong>Dashboard</strong></p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/net1.png" alt="Netbird interface showing a list of 5 peers with details like name, address, groups, last seen, OS, and version. Options to filter and add peers are available."></p>
<p>As you can see in the dashboard above, there are 5 peers on the network. You will see the name of each peer, its internal IP address, domain name, last seen, OS, and Netbird client version used by the system.</p>
<p>Now that we have set up our VPS, we can add it to our internal network on Netbird. To do this, we need to set up so-called &quot;Setup Keys,&quot; which tell Netbird to which network the client belongs.</p>
<p>Therefore, you can click on <code>Create Setup Key</code> and specify the name for that setup key.</p>
<p><strong>Setup Keys</strong></p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/net2.png" alt="Netbird setup key creation screen with fields for &#39;Name&#39;, &#39;Make this key reusable&#39;, &#39;Usage limit&#39;, &#39;Expires in&#39;, and toggles for &#39;Ephemeral Peers&#39; and &#39;Allow Extra DNS Labels&#39;."></p>
<p>A popup will appear showing you the setup key that you need to copy. This key will be used on the VPS to connect it to the network.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/net3.png" alt="Setup key creation confirmation with key displayed and options to &#39;Close&#39; or &#39;Install NetBird&#39;."></p>
<p>After you have copied it, you will see another popup window showing you the instructions for each operating system that you can use to connect the peer using the setup key.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/net4.png" alt="NetBird installation screen for Linux with command-line instructions to install and run using a setup key."></p>
<p>For Ubuntu in our example, we will use the <code>curl</code> command with the provided URL which downloads a shell script and executes it for automatic installation. It will ask you for a password, and after the installation it will show you that the netbird client is up and running.</p>
<p>&#x20; Network Security</p>
<pre><code class="lang-shell-session">cry0l1t3@MyVPS:~$ curl -fsSL http<span class="hljs-variable">s:</span>//pkgs.netbird.io/install.<span class="hljs-keyword">sh</span> | <span class="hljs-keyword">sh</span>

The installation will <span class="hljs-keyword">be</span> performed using apt package manager
[sudo] password <span class="hljs-keyword">for</span> cry0l1t3: *****************

<span class="hljs-symbol">&lt;SNIP&gt;</span>

NetBird service <span class="hljs-built_in">has</span> already been loaded
Netbird service <span class="hljs-built_in">has</span> been started
Installation <span class="hljs-built_in">has</span> been finished. To connect, you need <span class="hljs-keyword">to</span> run NetBird by executing the following <span class="hljs-keyword">command</span>:

netbird <span class="hljs-keyword">up</span>
</code></pre>
<p>Next, we will use the generated Setup Key and specify it in the Netbird client using the following command:</p>
<p>&#x20; Network Security</p>
<pre><code class="lang-shell-session">cry0l1t3@MyVPS:~$ netbird up --setup-key 826BC181<span class="hljs-string">-63</span>D4<span class="hljs-string">-4875</span><span class="hljs-string">-84</span>C3<span class="hljs-string">-9949</span>FDEA48EE

Connected
</code></pre>
<p>We should see a message saying that our peer is now connected to the network. When Netbird starts running, it creates a new network interface which usually is called <code>wt0</code>. We can use <code>ifconfig</code> or <code>ip addr</code> to check if there is a new network interface.</p>
<p>&#x20; Network Security</p>
<pre><code class="lang-shell-session">cry0l1t3@MyVPS:~$ ifconfig wt0

wt0: flags=209&lt;UP,POINTOPOINT,RUNNING,NOARP&gt;  mtu 1280
        inet 100.108.232.34  netmask 255.255.0.0  destination 100.108.232.34
        unspec 00<span class="hljs-string">-00</span><span class="hljs-string">-00</span><span class="hljs-string">-00</span><span class="hljs-string">-00</span><span class="hljs-string">-00</span><span class="hljs-string">-00</span><span class="hljs-string">-00</span><span class="hljs-string">-00</span><span class="hljs-string">-00</span><span class="hljs-string">-00</span><span class="hljs-string">-00</span><span class="hljs-string">-00</span><span class="hljs-string">-00</span><span class="hljs-string">-00</span><span class="hljs-string">-00</span>  txqueuelen 1000  (UNSPEC)
        RX packets 0  bytes 0 (0.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 (0.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
</code></pre>
<p>Once confirmed, we need to go to Netbird&#39;s dashboard. Here, you will see the peer appearing on the dashboard asking for approval. Keep in mind that even if someone stole your Setup Key and tried to connect to your network, this peer still would need approval by the administrator.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/net5.png" alt="MyVPS entry showing status as online, address &#39;myvps.netbird.cloud&#39;, last seen &#39;just now&#39;, version 0.41.3, with &#39;Approval required&#39; and &#39;Approve&#39; buttons."></p>
<p>After approval, we can test the connection by trying to connect to it via SSH.</p>
<p>&#x20; Network Security</p>
<pre><code class="lang-shell-session">cry0l1t3@htb:~$ ssh cry0l1t3@myvps.netbird.cloud

The authenticity <span class="hljs-keyword">of</span> host <span class="hljs-comment">'myvps.netbird.cloud (100.108.232.34)' can't be established.</span>
ED25519 <span class="hljs-keyword">key</span> fingerprint <span class="hljs-keyword">is</span> SHA256:NuxuseOH6mjejxr7dGWmBEYb4dHCi24eSFm+<span class="hljs-number">9</span>qnn4lI.
This <span class="hljs-keyword">key</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> known <span class="hljs-keyword">by</span> any other names.
Are you sure you want <span class="hljs-keyword">to</span> <span class="hljs-keyword">continue</span> connecting (yes/no/[fingerprint])? yes

Warning: Permanently added <span class="hljs-comment">'myvps.netbird.cloud' (ED25519) to the list of known hosts.</span>

cry0l1t3@myvps.netbird.cloud<span class="hljs-comment">'s password: *******************</span>

Welcome <span class="hljs-keyword">to</span> Ubuntu <span class="hljs-number">24.04</span><span class="hljs-number">.2</span> LTS (GNU/Linux <span class="hljs-number">6.11</span><span class="hljs-number">.0</span><span class="hljs-number">-21</span>-generic x86_64)

&lt;SNIP&gt;

cry0l1t3@MyVPS:~$
</code></pre>
<p>Next, since the connection works, we can configure the firewall to allow incoming connections only on the <code>wt0</code> interface and reject anything else except outgoing connections. We can use the <code>ufw</code> tool or <code>iptables</code>. For simplicity, we will use <code>ufw</code>.</p>
<p><strong>Configure Firewall</strong></p>
<p>&#x20; Network Security</p>
<pre><code class="lang-shell-session"><span class="hljs-meta"># Allow incoming connection only from the netbird interface wt0</span>
<span class="hljs-meta"># Reset ufw to default state</span>
ufw --force reset

<span class="hljs-meta"># Allow all incoming traffic on wt0 interface</span>
ufw allow in on wt0

<span class="hljs-meta"># Set default policies</span>
ufw <span class="hljs-keyword">default</span> deny incoming
ufw <span class="hljs-keyword">default</span> allow outgoing

<span class="hljs-meta"># Enable ufw</span>
ufw --force enable

<span class="hljs-meta"># Display ufw status</span>
ufw status
</code></pre>
<p>Optionally, we can harden our SSH server even further by telling it to listen only on the <code>wt0</code> interface with the following script.</p>
<p><strong>Alternative SSH Configuration</strong></p>
<p>Code: bash</p>
<pre><code class="lang-bash"><span class="hljs-meta">#!/bin/bash
</span>
<span class="hljs-comment"># Get the IP address of wt0</span>
WT0_IP=$(ip addr show wt0 | grep -oP <span class="hljs-string">'inet \K[\d.]+'</span>)

<span class="hljs-comment"># Backup current SSH configuration</span>
SSHD_CONF=<span class="hljs-string">"/etc/ssh/sshd_config"</span>
BACKUP_CONF=<span class="hljs-string">"/etc/ssh/sshd_config.bak_<span class="hljs-variable">$(date +%F_%H-%M-%S)</span>"</span>
cp /etc/ssh/sshd_config /etc/ssh/sshd_config.bak

<span class="hljs-comment"># Check if ListenAddress is already set</span>
<span class="hljs-keyword">if</span> grep -q <span class="hljs-string">"^ListenAddress"</span> <span class="hljs-string">"<span class="hljs-variable">$SSHD_CONF</span>"</span>; <span class="hljs-keyword">then</span>
    <span class="hljs-comment"># Replace existing ListenAddress</span>
    sed -i <span class="hljs-string">"s/^ListenAddress.*/ListenAddress <span class="hljs-variable">$WT0_IP</span>/"</span> <span class="hljs-string">"<span class="hljs-variable">$SSHD_CONF</span>"</span>
<span class="hljs-keyword">else</span>
    <span class="hljs-comment"># Add ListenAddress</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"ListenAddress <span class="hljs-variable">$WT0_IP</span>"</span> &gt;&gt; <span class="hljs-string">"<span class="hljs-variable">$SSHD_CONFIG</span>"</span>
<span class="hljs-keyword">fi</span>

<span class="hljs-comment"># Ensure SSH is not listening on 0.0.0.0 or ::</span>
sed -i <span class="hljs-string">'/^ListenAddress 0.0.0.0/d'</span> <span class="hljs-string">"<span class="hljs-variable">$SSHD_CONFIG</span>"</span>
sed -i <span class="hljs-string">'/^ListenAddress ::/d'</span> <span class="hljs-string">"<span class="hljs-variable">$SSHD_CONFIG</span>"</span>

<span class="hljs-comment"># Test SSH configuration</span>
<span class="hljs-keyword">if</span> sshd -t; <span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"SSH configuration is valid."</span>
<span class="hljs-keyword">else</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"Error: Invalid SSH configuration. Restoring backup."</span>
    cp <span class="hljs-string">"<span class="hljs-variable">$BACKUP_CONFIG</span>"</span> <span class="hljs-string">"<span class="hljs-variable">$SSHD_CONFIG</span>"</span>
    <span class="hljs-built_in">exit</span> 1
<span class="hljs-keyword">fi</span>

<span class="hljs-comment"># Restart SSH service</span>
systemctl restart sshd
<span class="hljs-keyword">if</span> [ $? <span class="hljs-_">-eq</span> 0 ]; <span class="hljs-keyword">then</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"SSH service restarted successfully."</span>
<span class="hljs-keyword">else</span>
    <span class="hljs-built_in">echo</span> <span class="hljs-string">"Error: Failed to restart SSH service."</span>
    <span class="hljs-built_in">exit</span> 1
<span class="hljs-keyword">fi</span>
</code></pre>
<hr>
<h2 id="vps-hardening">VPS Hardening</h2>
<hr>
<p>Another necessary step in our configuration and setup of our VPS is the hardening of the system and access. We should limit our access to the VPS to SSH and disable all other services on the VPS. Finally, we will reduce the attack vectors to a minimum and provide only one possible access to our VPS, which we will secure in the best possible way. We should keep in mind that, if possible, we should not store any sensitive data on the VPS, or at least only for a short period when we perform an internal penetration test. In doing so, we should follow the principle that someone could gain access to the system sooner or later.</p>
<p>However, since in this case, the VPS is only used as a source for our organization and tools and we can access these resources via SSH, we should secure and harden the SSH server accordingly so that no one else (or at least no one other than the team members) can access it. There are many ways to harden it, and this includes the following precautions, but not limited to:</p>
<ul>
<li>Install Fail2ban</li>
<li>Working only with SSH keys</li>
<li>Reduce Idle timeout interval</li>
<li>Disable passwords</li>
<li>Disable x11 forwarding</li>
<li>Use a different port</li>
<li>Limit users&#39; SSH access</li>
<li>Disable root logins</li>
<li>Use SSH proto 2</li>
<li>Enable 2FA Authentication for SSH</li>
</ul>
<p><code>It is highly recommended to try these settings and precautions first in a local VM we have created before making these settings on a VPS.</code></p>
<p>One of the first steps in hardening our system is updating and bringing the system <code>up-to-date</code>. We can do this with the following commands:</p>
<p><strong>Update the System</strong></p>
<p>&#x20; VPS Hardening</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@MyVPS</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>sudo apt update -y &amp;&amp; sudo apt full-upgrade -y &amp;&amp; sudo apt autoremove -y &amp;&amp; sudo apt autoclean -y
</code></pre>
<hr>
<h3 id="ssh-hardening">SSH Hardening</h3>
<p>SSH is always installed on the VPS, giving us guaranteed access to the server in advance. Now we can change some of the settings in the configuration file <code>/etc/ssh/sshd_config</code> to enforce these security measures for our SSH server. In this file, we will comment out, change or add some lines. The entire list of possible settings that can be made for the SSH daemon can be found on the <a href="https://man.openbsd.org/sshd_config">man page</a>.</p>
<p><strong>Install Fail2Ban</strong></p>
<p>&#x20; VPS Hardening</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@MyVPS</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>sudo apt install fail2ban -y
</code></pre>
<p>Once we have installed it, we can find the configuration file at <code>/etc/fail2ban/jail.conf</code>. We need to make a copy of this file to prevent our changes from being overwritten during updates.</p>
<p><strong>Fail2Ban Config Backup</strong></p>
<p>&#x20; VPS Hardening</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-meta">@MyVPS</span>:~$ sudo cp <span class="hljs-regexp">/etc/</span>fail2ban<span class="hljs-regexp">/jail.conf /</span>etc<span class="hljs-regexp">/fail2ban/</span>jail.local
</code></pre>
<p>In this file, we will find the field commented out with <code># [sshd]</code>. In most cases, we will find the first line commented out there. Otherwise, we add this and two more, as shown in the following example:</p>
<p><strong>/etc/fail2ban/jail.local</strong></p>
<p>Code: bash</p>
<pre><code class="lang-bash">...SNIP...

<span class="hljs-comment"># [sshd]</span>
<span class="hljs-attr">enabled</span> = <span class="hljs-literal">true</span>
<span class="hljs-attr">bantime</span> = <span class="hljs-number">4</span>w
<span class="hljs-attr">maxretry</span> = <span class="hljs-number">3</span>
</code></pre>
<p>With this, we enable monitoring for the SSH server, set the <code>ban time</code> to four weeks, and allow a maximum of 3 <code>attempts</code>. The advantage of this is that once we have configured our <code>2FA</code> feature for SSH, fail2ban will ban the IP address that has entered the <code>verification code</code> incorrectly three times too. We should make the following configurations in the <code>/etc/ssh/sshd_config</code> file:</p>
<p><strong>Editing OpenSSH Config</strong></p>
<p>&#x20; VPS Hardening</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@MyVPS</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>sudo cp /etc/ssh/sshd_config /etc/ssh/sshd_config.bak
cry0l1t3<span class="hljs-variable">@MyVPS</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>sudo vim /etc/ssh/sshd_config
</code></pre>
<table>
<thead>
<tr>
<th><strong>Settings</strong></th>
<th><strong>Description</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>LogLevel VERBOSE</td>
<td>Gives the verbosity level that is used when logging messages from SSH daemon.</td>
</tr>
<tr>
<td>PermitRootLogin no</td>
<td>Specifies whether root can log in using SSH.</td>
</tr>
<tr>
<td>MaxAuthTries 3</td>
<td>Specifies the maximum number of authentication attempts permitted per connection.</td>
</tr>
<tr>
<td>MaxSessions 5</td>
<td>Specifies the maximum number of open shell, login, or subsystem (e.g., SFTP) sessions allowed per network connection.</td>
</tr>
<tr>
<td>HostbasedAuthentication no</td>
<td>Specifies whether rhosts or /etc/hosts.equiv authentication together with successful public key client host authentication is allowed (host-based authentication).</td>
</tr>
<tr>
<td>PermitEmptyPasswords no</td>
<td>When password authentication is allowed, it specifies whether the server allows login to accounts with empty password strings.</td>
</tr>
<tr>
<td>ChallengeResponseAuthentication yes</td>
<td>Specifies whether challenge-response authentication is allowed.</td>
</tr>
<tr>
<td>UsePAM yes</td>
<td>Specifies if PAM modules should be used for authentification.</td>
</tr>
<tr>
<td>X11Forwarding no</td>
<td>Specifies whether X11 forwarding is permitted.</td>
</tr>
<tr>
<td>PrintMotd no</td>
<td>Specifies whether SSH daemon should print /etc/motd when a user logs in interactively.</td>
</tr>
<tr>
<td>ClientAliveInterval 600</td>
<td>Sets a timeout interval in seconds, after which if no data has been received from the client, the SSH daemon will send a message through the encrypted channel to request a response from the client.</td>
</tr>
<tr>
<td>ClientAliveCountMax 0</td>
<td>Sets the number of client alive messages which may be sent without SSH daemon receiving any messages back from the client.</td>
</tr>
<tr>
<td>AllowUsers \<username></td>
<td>This keyword can be followed by a list of user name patterns, separated by spaces. If specified, login is allowed only for user names that match one of the patterns.</td>
</tr>
<tr>
<td>Protocol 2</td>
<td>Specifies the usage of the newer protocol which is more secure.</td>
</tr>
<tr>
<td>AuthenticationMethods publickey,keyboard-interactive</td>
<td>Specifies the authentication methods that must be successfully completed for a user to be granted access.</td>
</tr>
<tr>
<td>PasswordAuthentication no</td>
<td>Specifies whether password authentication is allowed.</td>
</tr>
<tr>
<td>DebianBanner no</td>
<td>Disables the banner with its version.</td>
</tr>
</tbody>
</table>
<hr>
<h3 id="2fa-authentication">2FA Authentication</h3>
<p>With the configuration shown above, we have already taken essential steps to harden our SSH. Therefore, we can now go one step further and configure <code>2-factor authentication</code> (<code>2FA</code>). With this, we use a third-party software called Google Authenticator, which generates a six-digit code every 30 seconds that is needed to authenticate our identity. These six-digit codes represent a so-called <code>One-Time-Password</code> (OTP). <code>2FA</code> has proven itself an authentication method, not least because of its relatively high-security standard compared to the time required for implementation. Two different and independent authentication factors verify the identity of a person requesting access. We can find more information about <code>2FA</code> <a href="https://en.wikipedia.org/wiki/Multi-factor_authentication">here</a>.</p>
<p>We will use Google Authenticator as our authentication application on our Android or iOS smartphone. For this, we need to download and install the application from the Google/Apple Store. A guide on setting up Google Authenticator on our smartphone can be found <a href="https://support.google.com/accounts/answer/185839?co=GENIE.Platform%3DDesktop\&amp;hl=en">here</a>. To configure 2FA with Google Authenticator on our VPS, we need the <a href="https://github.com/google/google-authenticator-libpam">Google-Authenticator PAM module</a>. We can then install it and execute it to start configuring it as follows:</p>
<p><strong>Installing Google-Authenticator PAM Module</strong></p>
<p>&#x20; VPS Hardening</p>
<pre><code class="lang-shell-session">cry0l1t3@MyVPS:~$ sudo apt <span class="hljs-keyword">install</span> libpam-google-authenticator -y
cry0l1t3@MyVPS:~$ google-authenticator
<span class="hljs-keyword">Do</span> you want <span class="hljs-keyword">authentication</span> tokens <span class="hljs-keyword">to</span> be <span class="hljs-keyword">time</span>-based (y/n) y

<span class="hljs-keyword">Warning</span>: pasting the <span class="hljs-keyword">following</span> <span class="hljs-keyword">URL</span> <span class="hljs-keyword">into</span> your browser exposes the OTP secret <span class="hljs-keyword">to</span> Google:
  https://www.google.com/chart?chs=<span class="hljs-number">200</span>x200&amp;chld=M|<span class="hljs-number">0</span>&amp;cht=qr&amp;chl=otpauth://totp/cry0l1t3@MyVPS%<span class="hljs-number">3</span>Fsecret%...SNIP...%<span class="hljs-number">26</span>issuer%<span class="hljs-number">3</span>DMyVPS

   [ <span class="hljs-comment">---- QR Code ---- ]</span>

Your <span class="hljs-keyword">new</span> secret <span class="hljs-keyword">key</span> <span class="hljs-keyword">is</span>: ***************
Enter code <span class="hljs-keyword">from</span> app (<span class="hljs-number">-1</span> <span class="hljs-keyword">to</span> <span class="hljs-keyword">skip</span>):
</code></pre>
<p>If we follow these steps, then a <code>QR code</code> and a <code>secret key</code> will appear in our terminal, which we can then scan with the Google Authenticator app or enter the secret key there. Once we have scanned the QR code or entered the secret key, we will see the first <code>OTP</code> (six-digit number) on our smartphone. We enter this in our terminal to synchronize and authorize Google Authenticator on our smartphone and our VPS with Google.</p>
<p>The module will then generate several <code>emergency scratch codes</code> (<code>backup codes</code>), which we should save safely. These will be used in case we lose our smartphone. Should this happen, we can then log in with the <code>backup codes</code>.</p>
<p><strong>Google-Authenticator Configuration</strong></p>
<p>&#x20; VPS Hardening</p>
<pre><code class="lang-shell-session">Enter code <span class="hljs-keyword">from</span> app (<span class="hljs-number">-1</span> <span class="hljs-keyword">to</span> skip): &lt;Google-Auth Code&gt;

Code confirmed
Your emergency scratch codes are:
  <span class="hljs-number">21323478</span>
  <span class="hljs-number">43822347</span>
  <span class="hljs-number">60232018</span>
  <span class="hljs-number">73234726</span>
  <span class="hljs-number">45456791</span>

Do you want <span class="hljs-keyword">me</span> <span class="hljs-keyword">to</span> update your <span class="hljs-string">"/home/cry0l1t3/.google_authenticator"</span> <span class="hljs-built_in">file</span>? (y/n) y

Do you want <span class="hljs-keyword">to</span> disallow multiple uses <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> same authentication
token? This restricts you <span class="hljs-keyword">to</span> one login <span class="hljs-keyword">about</span> <span class="hljs-keyword">every</span> <span class="hljs-number">30</span>s, <span class="hljs-keyword">but</span> <span class="hljs-keyword">it</span> increases
your chances <span class="hljs-keyword">to</span> notice <span class="hljs-keyword">or</span> even prevent man-<span class="hljs-keyword">in</span>-<span class="hljs-keyword">the</span>-<span class="hljs-keyword">middle</span> attacks (y/n) y

By default, a new token <span class="hljs-keyword">is</span> generated <span class="hljs-keyword">every</span> <span class="hljs-number">30</span> seconds <span class="hljs-keyword">by</span> <span class="hljs-keyword">the</span> mobile app.
In order <span class="hljs-keyword">to</span> compensate <span class="hljs-keyword">for</span> possible <span class="hljs-built_in">time</span>-skew <span class="hljs-keyword">between</span> <span class="hljs-keyword">the</span> client <span class="hljs-keyword">and</span> <span class="hljs-keyword">the</span> server,
we allow an extra token <span class="hljs-keyword">before</span> <span class="hljs-keyword">and</span> <span class="hljs-keyword">after</span> <span class="hljs-keyword">the</span> current <span class="hljs-built_in">time</span>. This allows <span class="hljs-keyword">for</span> a
<span class="hljs-built_in">time</span> skew <span class="hljs-keyword">of</span> up <span class="hljs-keyword">to</span> <span class="hljs-number">30</span> seconds <span class="hljs-keyword">between</span> authentication server <span class="hljs-keyword">and</span> client. If you
experience problems <span class="hljs-keyword">with</span> poor <span class="hljs-built_in">time</span> synchronization, you can increase <span class="hljs-keyword">the</span> window
<span class="hljs-keyword">from</span> <span class="hljs-keyword">its</span> default size <span class="hljs-keyword">of</span> <span class="hljs-number">3</span> permitted codes (one previous code, <span class="hljs-keyword">the</span> current
code, <span class="hljs-keyword">the</span> next code) <span class="hljs-keyword">to</span> <span class="hljs-number">17</span> permitted codes (<span class="hljs-keyword">the</span> <span class="hljs-number">8</span> previous codes, <span class="hljs-keyword">the</span> current
code, <span class="hljs-keyword">and</span> <span class="hljs-keyword">the</span> <span class="hljs-number">8</span> next codes). This will permit <span class="hljs-keyword">for</span> a <span class="hljs-built_in">time</span> skew <span class="hljs-keyword">of</span> up <span class="hljs-keyword">to</span> <span class="hljs-number">4</span> minutes
<span class="hljs-keyword">between</span> client <span class="hljs-keyword">and</span> server.
Do you want <span class="hljs-keyword">to</span> do so? (y/n) n

If <span class="hljs-keyword">the</span> computer <span class="hljs-keyword">that</span> you are logging <span class="hljs-keyword">into</span> <span class="hljs-keyword">isn't</span> hardened <span class="hljs-keyword">against</span> brute-force
login attempts, you can enable rate-limiting <span class="hljs-keyword">for</span> <span class="hljs-keyword">the</span> authentication module.
By default, this limits attackers <span class="hljs-keyword">to</span> no more than <span class="hljs-number">3</span> login attempts <span class="hljs-keyword">every</span> <span class="hljs-number">30</span>s.
Do you want <span class="hljs-keyword">to</span> enable rate-limiting? (y/n) y
</code></pre>
<p>Next, we need to configure the <a href="https://en.wikipedia.org/wiki/Linux_PAM">PAM</a> module for the SSH daemon. To do this, we first create a backup of the file and open the file with a text editor such as Vim.</p>
<p><strong>2FA PAM Configuration</strong></p>
<p>&#x20; VPS Hardening</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@MyVPS</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>sudo cp /etc/pam.d/sshd /etc/pam.d/sshd.bak
cry0l1t3<span class="hljs-variable">@MyVPS</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>sudo vim /etc/pam.d/sshd
</code></pre>
<p>We comment out the &quot;<code>@include common-auth</code>&quot; line by putting a &quot;<code>#</code>&quot; in front of it. Besides, we add two new lines at the end of the file, as follows:</p>
<p><strong>/etc/pam.d/sshd</strong></p>
<p>Code: bash</p>
<pre><code class="lang-bash">#@include common-auth..<span class="hljs-selector-class">.SNIP</span>...

auth required pam_google_authenticator<span class="hljs-selector-class">.so</span>
auth required pam_permit.so
</code></pre>
<p>Next, we need to adjust our settings in our SSH daemon to allow this authentication method. In this configuration file (<code>/etc/ssh/sshd_config</code>), we need to add two new lines at the end of the file as follows:</p>
<p><strong>/etc/ssh/sshd_config</strong></p>
<p>Code: bash</p>
<pre><code class="lang-bash">...SNIP...

AuthenticationMethods publickey,keyboard-interactive
PasswordAuthentication no
</code></pre>
<p>Finally, we have to restart the SSH server to apply the new configurations and settings.</p>
<p><strong>Restart SSH Server</strong></p>
<p>&#x20; VPS Hardening</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@MyVPS</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>sudo service ssh restart
</code></pre>
<p>Now we can test this and try to login to the SSH server with our SSH key and check if everything works as intended.</p>
<p><strong>2FA SSH Login</strong></p>
<p>&#x20; VPS Hardening</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@MyVPS</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>ssh cry0l1t3<span class="hljs-variable">@VPS</span> -i ~<span class="hljs-regexp">/.ssh/vps</span>-ssh

Enter passphrase <span class="hljs-keyword">for</span> key <span class="hljs-string">'cry0l1t3'</span>: *************
Verification <span class="hljs-symbol">code:</span> &lt;Google-Auth Code&gt;
</code></pre>
<p>Finally, we can transfer all our resources, scripts, notes, and other components to the VPS using <a href="https://en.wikipedia.org/wiki/Secure_copy_protocol">SCP</a>.</p>
<p><strong>SCP Syntax</strong></p>
<p>&#x20; VPS Hardening</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@MyVPS</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>scp -i &lt;ssh-private-key&gt; -r &lt;directory to transfer&gt; &lt;username&gt;@&lt;IP/FQDN&gt;<span class="hljs-symbol">:&lt;path&gt;</span>
</code></pre>
<p><strong>Resources Transfer</strong></p>
<p>&#x20; VPS Hardening</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@MyVPS</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>scp -i ~<span class="hljs-regexp">/.ssh/vps</span>-ssh -r ~<span class="hljs-regexp">/HackTheBox cry0l1t3@VPS:~/</span>
Enter passphrase <span class="hljs-keyword">for</span> key <span class="hljs-string">'cry0l1t3'</span>: *************
Verification <span class="hljs-symbol">code:</span> &lt;Google-Auth Code&gt;
</code></pre>
<hr>
<p>We should now have an understanding of using common virtualization platforms such as VMWare Workstation/Player and VirtualBox and be comfortable with setting up VMs from scratch. After practicing the examples in this Module, we should also be comfortable setting up and hardening both a Windows and Linux attack machine for our penetration testing purposes. Finally, it is worth replicating the steps for standing up a VPS using a provider such as Vultr and practicing hardening it based on the steps in this section. It is important for us to be able to configure, harden, and maintain the systems that we use during our assessments.</p>
<hr>
<h2 id="the-terminal-emulator">The Terminal Emulator</h2>
<hr>
<p>For us it will be crucial to work in a terminal. The decision which terminal to use has also a great impact on our efficiency and productivity. A wide variety of terminal emulators exist, each providing different features which are great for different purposes. There are many to choose from, each developed on their own principles and focus. Some of them provide you a one-in-all solution, while others focus on speed or customization.</p>
<table>
<thead>
<tr>
<th><a href="https://alacritty.org/">Alacritty</a></th>
<th><a href="https://ghostty.org/">Ghostty</a></th>
<th><a href="https://www.waveterm.dev/">Wave Terminal</a></th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<p><a href="https://ghostty.org/">Ghostty</a> focuses on speed and performance while also allows you to customize the most necessary parts and provides many features.</p>
<p><a href="https://alacritty.org/">Alacritty</a> on the other hand focuses on minimalism and performace, which makes it very fast due to GPU acceleration but provides less options for customization.</p>
<p><a href="https://www.waveterm.dev/">Wave Terminal</a> is a visually stunning new AI-native terminal emulator designed for developer workflows, with a focus on modern UI, inline rendering, and persistent sessions but requires way more resources which can make it slower.</p>
<p>It is highly recommended to experiment with new customizations and tools on a local VM first that has a snapshot that you always can use to jump back if something goes wrong. Therefore, we will use another VM in the next examples and then apply those customization later.</p>
<hr>
<h3 id="wave-terminal">Wave Terminal</h3>
<p>Wave Terminal is a noval terminal emulator designed for developers, which is meant to enhance workflows by integrating modern AI-driven features with traditional command line functionalities. One of the biggest advantages of this terminal is that you have everything in one place (including a chromium-based browser) that reduces the aspect of switching between different windows.</p>
<p>Let’s <a href="https://www.waveterm.dev/download">download</a> this terminal, install it, and take a closer look at it.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/term1.png" alt="Download button for Linux .snap x64 with command: sudo snap install --classic waveterm."></p>
<p>To install Wave Terminal on Ubuntu we can use the <code>snap</code> package manager to install it.</p>
<p>&#x20; The Terminal Emulator</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>sudo snap install --classic waveterm
[sudo] password <span class="hljs-keyword">for</span> <span class="hljs-symbol">cry0l1t3:</span>  *********************

waveterm <span class="hljs-number">0</span>.<span class="hljs-number">11.2</span> from Command Line Inc (commandlinedev✓) installed

cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>waveterm
</code></pre>
<p>Wave Terminal provides many different shortcuts which enhance tspeed and productivity once you become familiar with it. You will be greeted by a popup window showing you some of the shortcuts which later on can be changed.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/term2.png" alt="Icons and keybindings for Wave Terminal: Connect to server, magnify block, block settings, close block, new tab, new terminal block, navigate and switch between blocks and tabs, wsh commands."></p>
<p>When we start Wave Terminal for the first time we will see the following parts:</p>
<ul>
<li>Command line</li>
<li>Performance monitor</li>
<li>Browser</li>
<li>File manager</li>
<li>Tips page</li>
<li>Help page</li>
<li>AI chat window</li>
</ul>
<p><img src="https://academy.hackthebox.com/storage/modules/87/term3.png" alt="Wave Terminal interface showing terminal, CPU graph, GitHub page, file directory, and keybindings."></p>
<p>When we look at the <a href="https://docs.waveterm.dev/">documentation</a>, there are 6 main sections covered that provide better understanding of what can be done with this terminal emulator.</p>
<ul>
<li>Customization</li>
<li>Key Bindings</li>
<li>Layout</li>
<li>Remote Connections</li>
<li>Widgets</li>
<li>Wsh Command</li>
</ul>
<p><img src="https://academy.hackthebox.com/storage/modules/87/term4.png" alt="Wave Terminal docs menu with sections: Customization, Key Bindings, Layout, Remote Connections, Widgets, wsh Command."></p>
<p>Since the Wave Terminal utilizes ReactJS components, it makes it highly customizable in terms of design. You can change the overall theme for the terminal and for the command line separately. In the command line window you will see a settings button in the top right corner which shows you many options.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/term5.png" alt="Terminal with theme selection menu showing options: Default, Default Dark, One Dark Pro, Dracula, Monokai, Campbell, Warm Yellow, Rose Pine."></p>
<p>Wave Terminal provides workspaces that hold desired collection of windows and widgets. When you right-click on the workspace tab you can customize the theme for it as well.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/term6.png" alt="Terminal with background selection menu showing options: Default, Blue, Green, Red, Rainbow, Ocean Depths, Aqua Horizon, Sunset, Enchanted Forest, Twilight Mist."></p>
<p>Having a browser in a terminal might seem a little bit too much for most people, since its affects the performance of the terminal negatively. However, having everything on one screen is one of the key aspects for productivity and efficiency. Especially, since the Wave Terminal uses tiling window management to efficiently place the windows without overlapping them.</p>
<p>Many people love to have 2, 3 or even 4 monitors and a laptop on their desk which, might look great, but turning your head 360 degrees to find the right piece of information is everything but efficient.</p>
<p>Efficiency comes from simplicity. The most efficient and simple way to solve a task (theoretically) is by using one single click. When we watch movies about “hackers” infiltrating a network within a few seconds, we are impressed not only by their knowledge but more about their efficiency and speed.</p>
<p>Therefore, when we want to be efficient and productive, we need to keep things simple. A simple point of orientation to measure your productivity and efficiency is the following:</p>
<ul>
<li><code>If you need more than 1 screen to handle your work comfortably, you didn’t optimize your setup/environment well enough.</code></li>
</ul>
<p>Now, let’s take a look at the built-in browser and download a custom background image.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/term7.png" alt="Wave Terminal with background menu and Google search for &#39;hackthebox background&#39; showing image results."></p>
<p>Once downloaded, we can use the built-in <code>wsh</code> command to control the Wave Terminal. It&#39;s important keep in mind that the <code>wsh</code> command is only available through the Wave Terminal.</p>
<p>Now, let’s change the background of the Wave Terminal with the image we have downloaded using the following command:</p>
<p>&#x20; The Terminal Emulator</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>wsh setbg ~<span class="hljs-regexp">/Downloads/krgw</span>3Cr1X7OIXLzBSB3uTh1FtKIk8hyo.jpg 

background set
</code></pre>
<p>Once done, we should see the background changed which will look similar to this:</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/term8.png" alt="Terminal with command to set background and Wave customization page showing tab themes."></p>
<p><strong>Workspaces</strong></p>
<p>As already mentioned, Wave Terminal allows you to create several workspaces which can serve for specific needs and environments. For example, we can have one workspace for our work, another one for a personal project, and a third one for private needs.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/term9.png" alt="Wave Terminal with workspace switcher showing options: Hack The Box, Another Workspace, Create new workspace."></p>
<p><strong>Resizing Blocks</strong></p>
<p>Additionally, the built-in tiling window manager makes it possible to resize the windows either by using the keyboard or by using the mouse.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/term10.png" alt="Terminal with file directory and CPU graph displayed."></p>
<p>Besides that we also can reorganize the windows by moving them to the desired position. For example, we can move the performance monitor above the file manager.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/term11.png" alt="Terminal with file directory and CPU graph overlay."></p>
<p>This will result in a new windows layout which will look similar to this:</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/term12.png" alt="Terminal with CPU graph and file directory displayed."></p>
<p>With the shortcut <code>CTRL + M</code> we can “magnify”/maximize the selected window to almost full-size. This is a great feature that helps us to focus on a single window without being distracted by others.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/term13.png" alt="CPU usage graph with time and percentage axes."></p>
<p>Now, let’s take a look at some commands that <code>wsh</code> provides.</p>
<p>&#x20; The Terminal Emulator</p>
<pre><code class="lang-shell-session">cry0l1t3@ubuntu:~$ wsh help
wsh is <span class="hljs-keyword">a</span> small utility that lets you <span class="hljs-built_in">do</span> cool things <span class="hljs-keyword">with</span> Wave Terminal, <span class="hljs-literal">right</span> <span class="hljs-built_in">from</span> <span class="hljs-keyword">the</span> <span class="hljs-keyword">command</span> <span class="hljs-title">line</span>

Usage:
  wsh [<span class="hljs-keyword">command</span>]

Available Commands:
  ai          Send <span class="hljs-keyword">a</span> message <span class="hljs-built_in">to</span> <span class="hljs-keyword">an</span> AI block
  completion  Generate <span class="hljs-keyword">the</span> autocompletion script <span class="hljs-keyword">for</span> <span class="hljs-keyword">the</span> specified <span class="hljs-built_in">shell</span>
  conn        manage Wave Terminal connections
  deleteblock <span class="hljs-built_in">delete</span> <span class="hljs-keyword">a</span> block
  edit        edit <span class="hljs-keyword">a</span> <span class="hljs-built_in">file</span>
  editconfig  edit Wave configuration <span class="hljs-built_in">files</span>
  editor      edit <span class="hljs-keyword">a</span> <span class="hljs-built_in">file</span> (blocks <span class="hljs-keyword">until</span> editor is closed)
  <span class="hljs-built_in">file</span>        manage <span class="hljs-built_in">files</span> across different storage systems
  getmeta     <span class="hljs-built_in">get</span> metadata <span class="hljs-keyword">for</span> <span class="hljs-keyword">an</span> entity
  getvar      <span class="hljs-built_in">get</span> <span class="hljs-built_in">variable</span>(s) <span class="hljs-built_in">from</span> <span class="hljs-keyword">a</span> block
  help        Help about <span class="hljs-keyword">any</span> <span class="hljs-keyword">command</span>
  launch      launch <span class="hljs-keyword">a</span> widget <span class="hljs-keyword">by</span> its ID
  notify      <span class="hljs-built_in">create</span> <span class="hljs-keyword">a</span> notification
  readfile    <span class="hljs-built_in">read</span> <span class="hljs-keyword">a</span> blockfile
  run         run <span class="hljs-keyword">a</span> <span class="hljs-keyword">command</span> <span class="hljs-title">in</span> <span class="hljs-title">a</span> <span class="hljs-title">new</span> <span class="hljs-title">block</span>
  setbg       <span class="hljs-built_in">set</span> background image <span class="hljs-keyword">or</span> color <span class="hljs-keyword">for</span> <span class="hljs-keyword">a</span> <span class="hljs-literal">tab</span>
  setconfig   <span class="hljs-built_in">set</span> config
  setmeta     <span class="hljs-built_in">set</span> metadata <span class="hljs-keyword">for</span> <span class="hljs-keyword">an</span> entity
  setvar      <span class="hljs-built_in">set</span> <span class="hljs-built_in">variable</span>(s) <span class="hljs-keyword">for</span> <span class="hljs-keyword">a</span> block
  ssh         connect this terminal <span class="hljs-built_in">to</span> <span class="hljs-keyword">a</span> remote host
  term        <span class="hljs-built_in">open</span> <span class="hljs-keyword">a</span> terminal <span class="hljs-keyword">in</span> <span class="hljs-built_in">directory</span>
  <span class="hljs-built_in">version</span>     Print <span class="hljs-keyword">the</span> <span class="hljs-built_in">version</span> <span class="hljs-built_in">number</span> <span class="hljs-keyword">of</span> wsh
  view        preview/edit <span class="hljs-keyword">a</span> <span class="hljs-built_in">file</span> <span class="hljs-keyword">or</span> <span class="hljs-built_in">directory</span>
  wavepath    Get paths <span class="hljs-built_in">to</span> various waveterm <span class="hljs-built_in">files</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">directories</span>
  web         web commands
  workspace   Manage workspaces
  wsl         connect this terminal <span class="hljs-built_in">to</span> <span class="hljs-keyword">a</span> <span class="hljs-built_in">local</span> wsl connection

Flags:
  -b, <span class="hljs-comment">--block string   for commands which require a block id</span>
  -h, <span class="hljs-comment">--help           help for wsh</span>
</code></pre>
<p>With the <code>wsh view .</code> command, we can open the file manager for the specified directory (<code>.</code> - current directory). This opens up a new window right next to the command line with all the necessary information we usually would type <code>ls</code> for.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/term14.png" alt="Terminal with command &#39;wsh view&#39; and file directory listing."></p>
<p>We now can select the <code>.bashrc</code> file in the file manager and it will open the file in a built-in text editor which allows us to modify the file right away.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/term15.png" alt="Terminal with command &#39;wsh view&#39; and .bashrc file content displayed."></p>
<p>Again, maximizing/magnifying the window makes it easier and more comfortable to work with.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/term16.png" alt="Terminal displaying .bashrc file content with comments and settings."></p>
<p>Next, let’s take a quick look at the <a href="https://docs.waveterm.dev/config">configuration documentation</a>. By using the <code>wsh editconfig</code> we can edit the configuration file without the need to search for it. In the documentation page we will see many different keys that can be set, like <code>web:defaulturl</code> for the built-in browser. Let’s set it to <a href="https://academy.hackthebox.com">https://academy.hackthebox.com</a>.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/term17.png" alt="Terminal with command &#39;wsh editconfig&#39; and settings.json file showing autoupdate, telemetry, and web URL settings."></p>
<p>Once saved, let’s click on the <code>Web</code> widget on the right side panel and check if it’s opening the right page.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/term18.png" alt="Terminal with &#39;wsh editconfig&#39; command, settings.json file showing configuration, and HTB Academy webpage."></p>
<p>Let’s adapt the entire terminal theme to the style of Hack The Box.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/term19.png" alt="Terminal with &#39;wsh editconfig termthemes.json&#39; command and JSON theme configuration for Hack The Box."></p>
<p>Code: bash</p>
<pre><code class="lang-bash">{
  <span class="hljs-attr">"hackthebox"</span>: {
    <span class="hljs-attr">"display:name"</span>: <span class="hljs-string">"Hack The Box"</span>,
    <span class="hljs-attr">"display:order"</span>: <span class="hljs-number">1</span>,
    <span class="hljs-attr">"black"</span>: <span class="hljs-string">"#000000"</span>,
    <span class="hljs-attr">"red"</span>: <span class="hljs-string">"#ff3e3e"</span>,
    <span class="hljs-attr">"green"</span>: <span class="hljs-string">"#9fef00"</span>,
    <span class="hljs-attr">"yellow"</span>: <span class="hljs-string">"#ffaf00"</span>,
    <span class="hljs-attr">"blue"</span>: <span class="hljs-string">"#004cff"</span>,
    <span class="hljs-attr">"magenta"</span>: <span class="hljs-string">"#9f00ff"</span>,
    <span class="hljs-attr">"cyan"</span>: <span class="hljs-string">"#2ee7b6"</span>,
    <span class="hljs-attr">"white"</span>: <span class="hljs-string">"#ffffff"</span>,
    <span class="hljs-attr">"brightBlack"</span>: <span class="hljs-string">"#666666"</span>,
    <span class="hljs-attr">"brightRed"</span>: <span class="hljs-string">"#ff8484"</span>,
    <span class="hljs-attr">"brightGreen"</span>: <span class="hljs-string">"#c5f467"</span>,
    <span class="hljs-attr">"brightYellow"</span>: <span class="hljs-string">"#ffcc5c"</span>,
    <span class="hljs-attr">"brightBlue"</span>: <span class="hljs-string">"#5cb2ff"</span>,
    <span class="hljs-attr">"brightMagenta"</span>: <span class="hljs-string">"#c16cfa"</span>,
    <span class="hljs-attr">"brightCyan"</span>: <span class="hljs-string">"#5cecc6"</span>,
    <span class="hljs-attr">"brightWhite"</span>: <span class="hljs-string">"#ffffff"</span>,
    <span class="hljs-attr">"gray"</span>: <span class="hljs-string">"#a4b1cd"</span>,
    <span class="hljs-attr">"cmdtext"</span>: <span class="hljs-string">"#a4b1cd"</span>,
    <span class="hljs-attr">"foreground"</span>: <span class="hljs-string">"#a4b1cd"</span>,
    <span class="hljs-attr">"selectionBackground"</span>: <span class="hljs-string">"#313f55"</span>,
    <span class="hljs-attr">"background"</span>: <span class="hljs-string">"#1a2332"</span>,
    <span class="hljs-attr">"cursorAccent"</span>: <span class="hljs-string">"#313f55"</span>
  }
}
</code></pre>
<p>Now, let’s download another <a href="https://github.com/ParrotSec/parrot-wallpapers/blob/master/backgrounds/hackthebox.jpg">HTB wallpaper</a> and set it as the new background for the terminal.</p>
<p>&#x20; The Terminal Emulator</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>wsh setbg ~<span class="hljs-regexp">/Downloads/hackthebox</span>.jpg 

background set
</code></pre>
<p>Once all the settings have been saved, the terminal should look like following:</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/term20.png" alt="Terminal with command &#39;wsh setbg \~/Downloads/hackthebox.jpg&#39; and background set message."></p>
<hr>
<h2 id="the-shell">The Shell</h2>
<hr>
<p>The shell is the main environment that we work with from our pentesting VM. Because of this, we need to ensure that the environment suits all our needs and is configured exactly the way we want. Even better, we could use a configuration script to set it up on other machines in the same way. So, spinning up a new VM will need just require a few commands in order to configure the shell the way we need and our work, productivity, and efficiency won’t suffer.</p>
<p>One of the most customizable and feature-rich shells is the <code>Z Shell (ZSH)</code>.</p>
<hr>
<h3 id="zsh">ZSH</h3>
<p>Zsh includes many features and extensions it can utilize. These include advanced tab completion, syntax highlighting, autosuggestions, and several others. However, some of these features require initial configuration, although the installation process and integration are relatively simple. First, let us access our Ubuntu VPS and install Zsh.</p>
<p>&#x20; The Shell</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>sudo apt install zsh -y
cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>zsh
</code></pre>
<p>After <code>Zsh</code> is installed and executed for the first time, a configuration page will appear. In this case, you may type <code>q</code> to exit without making changes, as the configuration will be performed manually.</p>
<p>&#x20; The Shell</p>
<pre><code class="lang-shell-session">This is <span class="hljs-keyword">the</span> Z Shell configuration <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">for</span> <span class="hljs-title">new</span> <span class="hljs-title">users</span>,</span>
zsh-newuser-install.
You are seeing this message because you have no zsh startup <span class="hljs-built_in">files</span>
(<span class="hljs-keyword">the</span> <span class="hljs-built_in">files</span> .zshenv, .zprofile, .zshrc, .zlogin <span class="hljs-keyword">in</span> <span class="hljs-keyword">the</span> <span class="hljs-built_in">directory</span>
~).  This <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">can</span> <span class="hljs-title">help</span> <span class="hljs-title">you</span> <span class="hljs-title">with</span> <span class="hljs-title">a</span> <span class="hljs-title">few</span> <span class="hljs-title">settings</span> <span class="hljs-title">that</span> <span class="hljs-title">should</span></span>
make your use <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> <span class="hljs-built_in">shell</span> easier.

You can:

(q)  Quit <span class="hljs-keyword">and</span> <span class="hljs-built_in">do</span> nothing.  The <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">will</span> <span class="hljs-title">be</span> <span class="hljs-title">run</span> <span class="hljs-title">again</span> <span class="hljs-title">next</span> <span class="hljs-title">time</span>.</span>

(<span class="hljs-number">0</span>)  Exit, creating <span class="hljs-keyword">the</span> <span class="hljs-built_in">file</span> ~/.zshrc containing just <span class="hljs-keyword">a</span> comment.
     That will prevent this <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">being</span> <span class="hljs-title">run</span> <span class="hljs-title">again</span>.</span>

(<span class="hljs-number">1</span>)  Continue <span class="hljs-built_in">to</span> <span class="hljs-keyword">the</span> main menu.

(<span class="hljs-number">2</span>)  Populate your ~/.zshrc <span class="hljs-keyword">with</span> <span class="hljs-keyword">the</span> configuration recommended
     <span class="hljs-keyword">by</span> <span class="hljs-keyword">the</span> <span class="hljs-keyword">system</span> administrator <span class="hljs-keyword">and</span> exit (you will need <span class="hljs-built_in">to</span> edit
     <span class="hljs-keyword">the</span> <span class="hljs-built_in">file</span> <span class="hljs-keyword">by</span> hand, <span class="hljs-keyword">if</span> so desired).

<span class="hljs-comment">--- Type one of the keys in parentheses ---</span>
</code></pre>
<p>Now, you should see a shell prompt like this:</p>
<p>&#x20; The Shell</p>
<pre><code class="lang-shell-session">ubuntu<span class="hljs-comment">%</span>
</code></pre>
<p>One of the most used extensions (framework) is the so called <a href="https://github.com/ohmyzsh/ohmyzsh/wiki">ohmyzsh</a>. OhMyZsh is a framework that manages and extends the configuration and functionality of zsh. It simplifies the process of customizing Zsh even further by providing a collection of plugins, themes, and tools.</p>
<p>The installation of <code>OhMyZsh</code> is straightforward as well, and only requires a single command.</p>
<p><strong>Oh-my-zsh</strong></p>
<p>&#x20; The Shell</p>
<pre><code class="lang-shell-session">ubuntu% sh -c <span class="hljs-string">"$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)"</span>

Cloning Oh My Zsh...
<span class="hljs-string">remote:</span> Enumerating <span class="hljs-string">objects:</span> <span class="hljs-number">1439</span>, done.
<span class="hljs-string">remote:</span> Counting <span class="hljs-string">objects:</span> <span class="hljs-number">100</span>% (<span class="hljs-number">1439</span>/<span class="hljs-number">1439</span>), done.
<span class="hljs-string">remote:</span> Compressing <span class="hljs-string">objects:</span> <span class="hljs-number">100</span>% (<span class="hljs-number">1374</span>/<span class="hljs-number">1374</span>), done.
<span class="hljs-string">remote:</span> Total <span class="hljs-number">1439</span> (delta <span class="hljs-number">42</span>), reused <span class="hljs-number">1250</span> (delta <span class="hljs-number">37</span>), pack-reused <span class="hljs-number">0</span> (from <span class="hljs-number">0</span>)
Receiving <span class="hljs-string">objects:</span> <span class="hljs-number">100</span>% (<span class="hljs-number">1439</span><span class="hljs-regexp">/1439), 3.28 MiB | 20.34 MiB/</span>s, done.
Resolving <span class="hljs-string">deltas:</span> <span class="hljs-number">100</span>% (<span class="hljs-number">42</span>/<span class="hljs-number">42</span>), done.
From <span class="hljs-string">https:</span><span class="hljs-comment">//github.com/ohmyzsh/ohmyzsh</span>
 * [<span class="hljs-keyword">new</span> branch]      master     -&gt; origin/master
branch <span class="hljs-string">'master'</span> set up to track <span class="hljs-string">'origin/master'</span>.
Already on <span class="hljs-string">'master'</span>
<span class="hljs-regexp">/home/</span>cry0l1t3

Looking <span class="hljs-keyword">for</span> an existing zsh config...
Found <span class="hljs-regexp">/home/</span>cry0l1t3<span class="hljs-regexp">/.zshrc. Backing up to /</span>home<span class="hljs-regexp">/cry0l1t3/</span>.zshrc.pre-oh-my-zsh
Using the Oh My Zsh template file and adding it to <span class="hljs-regexp">/home/</span>cry0l1t3/.zshrc.


Time to change your <span class="hljs-keyword">default</span> shell to <span class="hljs-string">zsh:</span>
Do you want to change your <span class="hljs-keyword">default</span> shell to zsh? [Y/n] y

Changing your shell to /usr/bin/zsh...
[sudo] password for cry0l1t3: ********************

Shell successfully changed to <span class="hljs-string">'/usr/bin/zsh'</span>.

         __                                     __   
  ____  <span class="hljs-regexp">/ /</span>_     ____ ___  __  __   ____  _____<span class="hljs-regexp">/ /</span>_  
 <span class="hljs-regexp">/ __ \/</span> __ \   <span class="hljs-regexp">/ __ `__ \/</span> <span class="hljs-regexp">/ /</span> <span class="hljs-regexp">/  /</span>_  <span class="hljs-regexp">/ /</span> ___/ __ \ 
<span class="hljs-regexp">/ /</span>_<span class="hljs-regexp">/ /</span> <span class="hljs-regexp">/ /</span> <span class="hljs-regexp">/  /</span> <span class="hljs-regexp">/ /</span> <span class="hljs-regexp">/ /</span> <span class="hljs-regexp">/ /</span>_<span class="hljs-regexp">/ /</span>    <span class="hljs-regexp">/ /</span>_(__  ) <span class="hljs-regexp">/ /</span> / 
\____<span class="hljs-regexp">/_/</span> <span class="hljs-regexp">/_/</span>  <span class="hljs-regexp">/_/</span> <span class="hljs-regexp">/_/</span> <span class="hljs-regexp">/_/\_</span>_, <span class="hljs-regexp">/    /</span>___<span class="hljs-regexp">/____/</span>_<span class="hljs-regexp">/ /</span>_/  
                        <span class="hljs-regexp">/____/</span>                       ....is now installed!

Before you scream Oh My Zsh! look over the `.zshrc` file to select plugins, themes, and options.

• Follow us on <span class="hljs-string">X:</span> <span class="hljs-string">https:</span><span class="hljs-comment">//x.com/ohmyzsh</span>
• Join our Discord <span class="hljs-string">community:</span> <span class="hljs-string">https:</span><span class="hljs-comment">//discord.gg/ohmyzsh</span>
• Get stickers, t-shirts, coffee mugs and <span class="hljs-string">more:</span> <span class="hljs-string">https:</span><span class="hljs-comment">//shop.planetargon.com/collections/oh-my-zsh</span>


➜  ~
</code></pre>
<p>Once installed, you will see a new shell prompt with an arrow.</p>
<p>Next, let’s download the <code>autosuggestions</code> and <code>syntax-highlighting</code> plugins and install them. These plugins we will place in the <code>~/.oh-my-zsh/custom</code> directory, where we store custom plugins.</p>
<p>These plugins will be placed in the <code>~/.oh-my-zsh/custom</code> directory, where custom plugins are stored.</p>
<p>&#x20; The Shell</p>
<pre><code class="lang-shell-session">➜  ~ git clone https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/zsh-users/</span>zsh-autosuggestions <span class="hljs-variable">${ZSH_CUSTOM:-~/.oh-my-zsh/custom}</span><span class="hljs-regexp">/plugins/</span>zsh-autosuggestions
➜  ~ git clone https:<span class="hljs-regexp">//gi</span>thub.com<span class="hljs-regexp">/zsh-users/</span>zsh-syntax-highlighting.git <span class="hljs-variable">${ZSH_CUSTOM:-~/.oh-my-zsh/custom}</span><span class="hljs-regexp">/plugins/</span>zsh-syntax-highlighting
</code></pre>
<p>After we have the plugins downloaded, we need to configure Zsh to use them. We can do this by editing the <code>~/.zshrc</code> file and searching for the <code>plugins</code> section. Inside of <code>plugins</code> we “activate” the installed plugins but putting the plugin names inside the brackets.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/sh1.png" alt="Zsh configuration file showing plugin setup and user configuration settings."></p>
<p>A full list of available plugins for Zsh you can find <a href="https://github.com/ohmyzsh/ohmyzsh/wiki/plugins-overview">here</a>. It is highly recommended to go through this list and grab all the necessary plugins you need.</p>
<p>Another very beneficial addition to Zsh is the Powerlevel10k theme which makes the shell look great and comfortable to the eye. It’s one of the most popular themes for Zsh, known for its speed, flexibility, and visually appealing prompts that display contextual information like Git status, directory paths, and system details.</p>
<p>To install it we can use the following commands:</p>
<p><strong>Powerlevel10k</strong></p>
<p>&#x20; The Shell</p>
<pre><code class="lang-shell-session">➜  ~ git <span class="hljs-built_in">clone</span> --depth=1 https://github.com/romkatv/powerlevel10k.git ~/powerlevel10k
➜  ~ <span class="hljs-built_in">echo</span> <span class="hljs-string">'source ~/powerlevel10k/powerlevel10k.zsh-theme'</span> &gt;&gt;~/.zshrc
➜  ~ <span class="hljs-built_in">exec</span> zsh
</code></pre>
<p>You will be prompted with a configuration page for powerlevel10k, which will ask a series of questions in order to produce desired theme . Feel free to design it the way you want, and remember you always can reconfigure it again. After going through this process, you will see a similar shell like this:</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/sh2.png" alt="Terminal with Hack The Box background and command prompt."></p>
<p>We highly suggest exploring the documentation of Powerlevel10k so you can learn about the various plugins and determine which ones are right for you. If you install too many plugins, it can slow down the shell dramatically which again, reduces the speed and efficiency of your work.</p>
<hr>
<h2 id="the-multiplexer">The Multiplexer</h2>
<hr>
<p>A terminal multiplexer is a tool that allows multiple terminal sessions to be managed within a single terminal window or session. We can create, switch between, and organize multiple terminal instances simultaneously, enhancing our productivity on the command line. A multiplexer allows us to split the terminal into multiple windows, create panes (tabs), and quickly navigate between them using simple shortcuts.</p>
<p>For example, we can open an SSH connection in one command-line window, split it vertically, and open the manual page in another. Additionally, we can create a third window to write a script that automates the current process. Essentially, this setup allows us to maintain the SSH session, read the manual while configuring a service, and take notes—all within the same terminal.</p>
<hr>
<h3 id="wave-terminal">Wave Terminal</h3>
<p>As we have seen with the Wave Terminal, having everything organized on one single screen makes it possible work on many different environments at the same time without the need of having multiple monitors. Additionally, having a functionality that allows us to pick one of the windows and concentrate on it increases the focus for our work without being distracted by any other windows.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/multi1.png" alt="HTB Academy webpage with &#39;Your cybersecurity journey starts here&#39; and terminal running cowsay command."></p>
<hr>
<h3 id="ghostty">Ghostty</h3>
<p>Ghostty is one of the fastest terminal emulators available. In addition to its speed, it is highly customizable and includes a built-in multiplexer. Let us install it on our VPS and test it. The easiest way to install Ghostty on an Ubuntu system is by using the Snap package manager:</p>
<p>&#x20; The Multiplexer</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>snap install ghostty --classic

ghostty v1.<span class="hljs-number">1.3</span> from Ken VanDine✪ installed
</code></pre>
<p>Once installed, we can launch Ghostty and be greeted with a terminal that looks similar to the following:</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/multi2.png" alt="Terminal with command prompt on a dark background."></p>
<p>Inside the home directory, there is a hidden subdirectory named <code>~/.config</code>. Within it, the <code>ghostty</code> folder contains a configuration file that can be edited to customize Ghostty. More information can be found in the <a href="https://ghostty.org/docs/config">Ghostty documentation</a>.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/multi3.png" alt="Configuration file in terminal showing color settings and keybindings for new environment, movement, toggle, and reload config."></p>
<p>This configuration enables us to use simple shortcuts to navigate and manage windows and panes within the Ghostty terminal.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/multi4.png" alt="Terminal showing directory listing, configuration settings for colors and keybindings, and system monitor with CPU and memory usage."></p>
<p>You can use the Ghostty configuration by Zerebos to design your Ghostty configuration using a web application <a href="https://ghostty.zerebos.com/">here</a>.</p>
<p>We can also configure a preferred theme for Ghostty. Navigate to <code>~/.config/ghostty</code> and create a new directory named <code>themes</code> to store your desired themes. For example, to create a <code>HackTheBox</code> theme, use the following steps:</p>
<p>&#x20; The Multiplexer</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>cd .config/ghostty
cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~/</span>.config/ghostty<span class="hljs-variable">$ </span>mkdir themes
cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~/</span>.config/ghostty<span class="hljs-variable">$ </span>vim HackTheBox
</code></pre>
<p>Add the following color palette to the file and save it. This tells the Ghostty terminal which colors it should use for each component.</p>
<p>Code: bash</p>
<pre><code class="lang-bash"><span class="hljs-attr">palette</span> = <span class="hljs-number">0</span>=#<span class="hljs-number">41444</span>d
<span class="hljs-attr">palette</span> = <span class="hljs-number">1</span>=#fc2f52
<span class="hljs-attr">palette</span> = <span class="hljs-number">2</span>=#<span class="hljs-number">25</span>a45c
<span class="hljs-attr">palette</span> = <span class="hljs-number">3</span>=#ff936a
<span class="hljs-attr">palette</span> = <span class="hljs-number">4</span>=#<span class="hljs-number">3476</span>ff
<span class="hljs-attr">palette</span> = <span class="hljs-number">5</span>=#<span class="hljs-number">7</span>a82da
<span class="hljs-attr">palette</span> = <span class="hljs-number">6</span>=#<span class="hljs-number">4483</span>aa
<span class="hljs-attr">palette</span> = <span class="hljs-number">7</span>=#cdd4e0
<span class="hljs-attr">palette</span> = <span class="hljs-number">8</span>=#<span class="hljs-number">8</span>f9aae
<span class="hljs-attr">palette</span> = <span class="hljs-number">9</span>=#ff6480
<span class="hljs-attr">palette</span> = <span class="hljs-number">10</span>=#<span class="hljs-number">3</span>fc56b
<span class="hljs-attr">palette</span> = <span class="hljs-number">11</span>=#f9c859
<span class="hljs-attr">palette</span> = <span class="hljs-number">12</span>=#<span class="hljs-number">10</span>b1fe
<span class="hljs-attr">palette</span> = <span class="hljs-number">13</span>=#ff78f8
<span class="hljs-attr">palette</span> = <span class="hljs-number">14</span>=#<span class="hljs-number">5</span>fb9bc
<span class="hljs-attr">palette</span> = <span class="hljs-number">15</span>=#ffffff
<span class="hljs-attr">background</span> = #<span class="hljs-number">282</span>c34
<span class="hljs-attr">foreground</span> = #b9c0cb
<span class="hljs-attr">cursor-color</span> = #ffcc00
<span class="hljs-attr">cursor-text</span> = #<span class="hljs-number">282</span>c34
<span class="hljs-attr">selection-background</span> = #b9c0ca
<span class="hljs-attr">selection-foreground</span> = #<span class="hljs-number">272</span>b33
</code></pre>
<p>Once the file is saved, execute the following command to list available themes. The newly created <code>HackTheBox</code> theme will now appear with your custom color palette.</p>
<p>&#x20; The Multiplexer</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~/</span>.config/ghostty/themes<span class="hljs-variable">$ </span>ghostty +list-themes
</code></pre>
<p><img src="https://academy.hackthebox.com/storage/modules/87/multi5.png" alt="Theme selection menu with HackTheBox theme preview, color palette, and code snippet."></p>
<p>Having a clean, well constructor terminal emulator in our workspace increases the satisfaction and joy during our work process. If we are immersed in an environment that&#39;s pleasing and fun to us at the same time, it will boost our effectiveness and productivity as a side effect.</p>
<p>However, there is still a problem we haven&#39;t addressed yet. The limitation of Ghostty is that it does not support session reattachment over SSH. Since the multiplexing is local to the instance, remote users must re-create their sessions from scratch when reconnecting.</p>
<hr>
<h3 id="tmux">Tmux</h3>
<p>In contrast, Terminal Multiplexer (Tmux) is a terminal multiplexer that allows users to create, manage, detach, and reattach terminal sessions—even across SSH connections. Tmux is structured into three main components:</p>
<ul>
<li>Sessions</li>
<li>Windows (tabs)</li>
<li>Panes</li>
</ul>
<p>Sessions represents an independent Tmux instance with its own set of windows and panes that can run in the background. Those sessions can be detached/reattached and shared with others for collaborative work. A Window is a single screen within a session, similar to a tab in a browser that contains one or more panes. A Pane is a subdivision of a window that can run side-by-side where we can have multiple command lines open at the same window.</p>
<p>Let’s install Tmux and test it using the following commands:</p>
<p>&#x20; The Multiplexer</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>sudo apt install tmux -y
cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>tmux
</code></pre>
<p>Once Tmux is launched, you will see a new green status bar at the bottom. This bar shows you the session name, window index and name, pane title, time, and date.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/multi6.png" alt="Terminal with Hack The Box background and command prompt, showing session and time details at the bottom."></p>
<p>The learning curve to use Tmux is a little bit larger and requires more time. However, if you really get familiar with Tmux it will change the way you work and enhance your producitivity a lot. Having the same Tmux config in place on all the servers you are working on, creates for you an environment that feels the same no matter at which server you are connected to. Since you’re working always in the same environment, navigation, creation, modification, and management will increase in a short period of time. Besides, setting up a new server will feel like you have worked with it for a long period of time.</p>
<p>You will no longer need to reorient yourself with a new server setup. Once configured, servers will feel like directories you simply navigate and manage.</p>
<p>Now, let’s create the Tmux configuration file that we can store in our home directory as <code>.tmux.conf</code> with the following settings:</p>
<p>Code: bash</p>
<pre><code class="lang-bash"><span class="hljs-meta"># Config Management</span>
unbind r
bind r source-file ~/.tmux.conf \; display <span class="hljs-string">"Config reloaded."</span>

<span class="hljs-meta"># Control</span>
<span class="hljs-keyword">set</span> -g prefix C-space
<span class="hljs-keyword">set</span> -g mouse <span class="hljs-keyword">on</span>

<span class="hljs-meta"># History</span>
<span class="hljs-keyword">set</span>-<span class="hljs-keyword">option</span> -g history-limit <span class="hljs-number">50000</span>

<span class="hljs-meta"># Numbering</span>
<span class="hljs-keyword">set</span> -g base-index <span class="hljs-number">1</span>
setw -g pane-base-index <span class="hljs-number">1</span>

<span class="hljs-meta"># Panes</span>
bind x split-window -v
bind y split-window -h

bind-<span class="hljs-keyword">key</span> h <span class="hljs-keyword">select</span>-pane -L
bind-<span class="hljs-keyword">key</span> j <span class="hljs-keyword">select</span>-pane -D
bind-<span class="hljs-keyword">key</span> k <span class="hljs-keyword">select</span>-pane -U
bind-<span class="hljs-keyword">key</span> l <span class="hljs-keyword">select</span>-pane -R
</code></pre>
<p>After saving the configuration file, reload the Tmux session to apply changes:</p>
<p>&#x20; The Multiplexer</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>tmux source .tmux.conf
</code></pre>
<p>With the configuration in place, we can now use the defined shortcuts to split windows and create panes. For example, pressing <code>Ctrl + Space</code> activates the Tmux prefix, after which pressing <code>x</code> splits the window vertically.</p>
<p>Tmux supports a wide array of plugins. The most essential is the Tmux Plugin Manager (TPM), which simplifies plugin installation and management. We can clone the TPM repository from Github using:</p>
<p>&#x20; The Multiplexer</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-meta">@ubuntu</span>:~$ git clone <span class="hljs-string">https:</span><span class="hljs-comment">//github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm</span>
cry0l1t3<span class="hljs-meta">@ubuntu</span>:~$ vim .tmux.conf
</code></pre>
<p>At the bottom of the configuration file we should add the following lines:</p>
<p>Code: bash</p>
<pre><code class="lang-bash">&lt;SNIP&gt;

# List of plugins
<span class="hljs-keyword">set</span> -g <span class="hljs-comment">@plugin</span> <span class="hljs-comment">'tmux-plugins/tpm'</span>
<span class="hljs-keyword">set</span> <span class="hljs-comment">-g @plugin</span> <span class="hljs-comment">'tmux-plugins/tmux-sensible'</span>

# Other <span class="hljs-comment">examples:</span>
# <span class="hljs-keyword">set</span> <span class="hljs-comment">-g @plugin</span> <span class="hljs-comment">'github_username/plugin_name'</span>
# <span class="hljs-keyword">set</span> <span class="hljs-comment">-g @plugin</span> <span class="hljs-comment">'github_username/plugin_name#branch'</span>
# <span class="hljs-keyword">set</span> <span class="hljs-comment">-g @plugin</span> <span class="hljs-comment">'git@github.com:user/plugin'</span>
# <span class="hljs-keyword">set</span> <span class="hljs-comment">-g @plugin</span> <span class="hljs-comment">'git@bitbucket.com:user/plugin'</span>

# Initialize <span class="hljs-comment">TMUX plugin manager (keep this line at the very bottom of tmux.conf)</span>
run <span class="hljs-comment">'~/.tmux/plugins/tpm/tpm'</span>
</code></pre>
<p>Once we&#39;ve saved the changes, we need to press the prefix key (<code>CTROL + Space</code>) and tell Tmux to install the plugins by pressing <code>SHIFT + i</code>.</p>
<p>Code: bash</p>
<pre><code class="lang-bash"><span class="hljs-symbol">CTRL</span> + <span class="hljs-meta">Space</span>
<span class="hljs-symbol">SHIFT</span> + i
</code></pre>
<p>After the installation Tmux will ask you to press <code>ESCAPE</code> to continue with your session.</p>
<p>&#x20; The Multiplexer</p>
<pre><code class="lang-shell-session">Already installed <span class="hljs-string">"tpm"</span>
Installing <span class="hljs-string">"tmux-sensible"</span>
  <span class="hljs-string">"tmux-sensible"</span> download success

TMUX environment reloaded.

Done, press ESCAPE <span class="hljs-keyword">to</span> <span class="hljs-keyword">continue</span>.
</code></pre>
<p>When we look at the structure of Tmux`s plugin directory, it will appear similar to this:</p>
<p>&#x20; The Multiplexer</p>
<pre><code class="lang-shell-session">cry0l1t3@<span class="hljs-symbol">ubuntu:</span>~$ tree -d .tmux

.tmux
└── plugins
    ├── tmux-sensible
    └── tpm
        ├── bin
        ├── bindings
        ├── docs
        ├── <span class="hljs-class"><span class="hljs-keyword">lib</span></span>
        │   └── tmux-test
        ├── scripts
        │   └── helpers
        └── tests
            └── helpers

<span class="hljs-number">13</span> directories
</code></pre>
<hr>
<h3 id="tmux-themes">Tmux Themes</h3>
<p>Tmux themes customize the visual interface of the terminal, including the status bar, message prompts, and pane borders. Themes are defined in the <code>.tmux.conf</code> file and integrate well with Zsh, Oh-My-Zsh, and Powerlevel10k. Some of the most popular theme plugins are:</p>
<p>Code: bash</p>
<pre><code class="lang-bash"><span class="hljs-symbol">'wfxr/tmux-power</span>'
<span class="hljs-symbol">'jimeh/tmux-themepack</span>'
<span class="hljs-symbol">'dracula/tmux</span>'
<span class="hljs-symbol">'arcticicestudio/nord-tmux</span>'
<span class="hljs-symbol">'catppuccin/tmux</span>'
</code></pre>
<p>Let us extend our Tmux configuration with the <code>catppuccin</code> theme and custom color variables by reproducing the <code>Tmux.conf</code> file shown below:</p>
<p><strong>Tmux.conf</strong></p>
<p>Code: bash</p>
<pre><code class="lang-bash"><span class="hljs-comment"># Config Management</span>
unbind r
bind r source-file ~/.tmux.conf <span class="hljs-string">\;</span> display <span class="hljs-string">"Config reloaded."</span>

<span class="hljs-comment"># Control</span>
set -g prefix C-space
set -g mouse <span class="hljs-literal">on</span>

<span class="hljs-comment"># History</span>
set-option -g history-limit <span class="hljs-number">50000</span>

<span class="hljs-comment"># Numbering &amp; Naming</span>
set -g base-index <span class="hljs-number">1</span>
setw -g pane-base-index <span class="hljs-number">1</span>
set-option -g automatic-rename <span class="hljs-literal">on</span>
set-option -g automatic-rename-format <span class="hljs-string">'#{b:pane_current_path}'</span>

<span class="hljs-comment"># Windows</span>
unbind W
bind-key W command-prompt -p <span class="hljs-string">"Window name:"</span> <span class="hljs-string">"new-window -n '%%'"</span> <span class="hljs-comment"># New Window</span>
bind-key t command-prompt -p <span class="hljs-string">"New name:"</span> <span class="hljs-string">"rename-window '%%'"</span>   <span class="hljs-comment"># Rename Window</span>

<span class="hljs-comment"># Switch Windows</span>
bind-key <span class="hljs-number">0</span> select-<span class="hljs-built_in">window</span> -t <span class="hljs-number">0</span>
bind-key <span class="hljs-number">1</span> select-<span class="hljs-built_in">window</span> -t <span class="hljs-number">1</span>
bind-key <span class="hljs-number">2</span> select-<span class="hljs-built_in">window</span> -t <span class="hljs-number">2</span>
bind-key <span class="hljs-number">3</span> select-<span class="hljs-built_in">window</span> -t <span class="hljs-number">3</span>
bind-key <span class="hljs-number">4</span> select-<span class="hljs-built_in">window</span> -t <span class="hljs-number">4</span>
bind-key <span class="hljs-number">5</span> select-<span class="hljs-built_in">window</span> -t <span class="hljs-number">5</span>
bind-key <span class="hljs-number">6</span> select-<span class="hljs-built_in">window</span> -t <span class="hljs-number">6</span>
bind-key <span class="hljs-number">7</span> select-<span class="hljs-built_in">window</span> -t <span class="hljs-number">7</span>
bind-key <span class="hljs-number">8</span> select-<span class="hljs-built_in">window</span> -t <span class="hljs-number">8</span>
bind-key <span class="hljs-number">9</span> select-<span class="hljs-built_in">window</span> -t <span class="hljs-number">9</span>

<span class="hljs-comment"># Panes</span>
bind-key P command-prompt -p <span class="hljs-string">"Rename pane:"</span> <span class="hljs-string">"select-pane -T '%%'"</span>

bind x split-<span class="hljs-built_in">window</span> -v
bind y split-<span class="hljs-built_in">window</span> -h

bind-key h select-pane -L
bind-key j select-pane -D
bind-key k select-pane -U
bind-key l select-pane -R

<span class="hljs-comment"># List of plugins</span>
set -g @plugin <span class="hljs-string">'tmux-plugins/tpm'</span>

<span class="hljs-comment"># Theme</span>
set -g @plugin <span class="hljs-string">'catppuccin/tmux#v2.1.3'</span>
run ~/.config/tmux/plugins/catppuccin/tmux/catppuccin.tmux

<span class="hljs-comment"># Options to make tmux more pleasant</span>
set -g mouse <span class="hljs-literal">on</span>
set -g <span class="hljs-keyword">default</span>-terminal <span class="hljs-string">"tmux-256color"</span>

<span class="hljs-comment"># Configure the catppuccin plugin</span>
set -g @catppuccin_flavor <span class="hljs-string">"mocha"</span>
set -g @catppuccin_window_status_style <span class="hljs-string">"rounded"</span>

<span class="hljs-comment">#----------------------------- Custom Theme</span>
<span class="hljs-comment"># Define color variables inspired by Catppuccin Mocha, mapped to HackTheBox colors</span>
set -g @rosewater <span class="hljs-string">"<span class="hljs-subst">#ffffff</span>"</span>       <span class="hljs-comment"># BrightWhite</span>
set -g @flamingo <span class="hljs-string">"<span class="hljs-subst">#ff8484</span>"</span>        <span class="hljs-comment"># BrightRed</span>
set -g @pink <span class="hljs-string">"<span class="hljs-subst">#c16cfa</span>"</span>            <span class="hljs-comment"># BrightPurple</span>
set -g @mauve <span class="hljs-string">"#9f00ff"</span>           <span class="hljs-comment"># Purple</span>
set -g @red <span class="hljs-string">"<span class="hljs-subst">#ff3e3e</span>"</span>             <span class="hljs-comment"># Red</span>
set -g @maroon <span class="hljs-string">"<span class="hljs-subst">#ff8484</span>"</span>          <span class="hljs-comment"># BrightRed</span>
set -g @peach <span class="hljs-string">"<span class="hljs-subst">#ffcc5c</span>"</span>           <span class="hljs-comment"># BrightYellow</span>
set -g @yellow <span class="hljs-string">"<span class="hljs-subst">#ffaf00</span>"</span>          <span class="hljs-comment"># Yellow</span>
set -g @green <span class="hljs-string">"#9fef00"</span>           <span class="hljs-comment"># Green</span>
set -g @teal <span class="hljs-string">"#2ee7b6"</span>            <span class="hljs-comment"># Cyan</span>
set -g @sky <span class="hljs-string">"#5cecc6"</span>             <span class="hljs-comment"># BrightCyan</span>
set -g @sapphire <span class="hljs-string">"#5cb2ff"</span>        <span class="hljs-comment"># BrightBlue</span>
set -g @blue <span class="hljs-string">"#004cff"</span>            <span class="hljs-comment"># Blue</span>
set -g @lavender <span class="hljs-string">"<span class="hljs-subst">#ffffff</span>"</span> <span class="hljs-comment">#"#c16cfa"        # BrightPurple</span>
set -g @text <span class="hljs-string">"<span class="hljs-subst">#a4b1cd</span>"</span>            <span class="hljs-comment"># Foreground</span>
set -g @subtext1 <span class="hljs-string">"#666666"</span>        <span class="hljs-comment"># BrightBlack</span>
set -g @subtext0 <span class="hljs-string">"#313f55"</span>        <span class="hljs-comment"># SelectionBackground</span>
set -g @overlay2 <span class="hljs-string">"#666666"</span>        <span class="hljs-comment"># BrightBlack</span>
set -g @overlay1 <span class="hljs-string">"#313f55"</span>        <span class="hljs-comment"># SelectionBackground</span>
set -g @overlay0 <span class="hljs-string">"#313f55"</span>        <span class="hljs-comment"># CursorColor</span>
set -g @surface2 <span class="hljs-string">"#666666"</span>        <span class="hljs-comment"># BrightBlack</span>
set -g @surface1 <span class="hljs-string">"#313f55"</span>        <span class="hljs-comment"># SelectionBackground</span>
set -g @surface0 <span class="hljs-string">"#313f55"</span>        <span class="hljs-comment"># CursorColor</span>
set -g @base <span class="hljs-string">"#1a2332"</span>            <span class="hljs-comment"># Background</span>
set -g @mantle <span class="hljs-string">"#000000"</span>          <span class="hljs-comment"># Black</span>
set -g @crust <span class="hljs-string">"#000000"</span>           <span class="hljs-comment"># Black</span>
set -g @thm_bg <span class="hljs-string">"#1a2332"</span>

<span class="hljs-comment"># Plugins</span>
set -g @plugin <span class="hljs-string">'tmux-plugins/tmux-online-status'</span>
set -g @plugin <span class="hljs-string">'tmux-plugins/tmux-battery'</span>

<span class="hljs-comment"># Configure Online</span>
set -g @online_icon <span class="hljs-string">"ok"</span>
set -g @offline_icon <span class="hljs-string">"nok"</span>

<span class="hljs-comment"># Status bar position and transparency</span>
set -g status-position bottom
set -g status-style <span class="hljs-string">"bg=<span class="hljs-subst">#{@thm_bg}</span>,fg=<span class="hljs-subst">#{@text}</span>"</span>  <span class="hljs-comment"># Transparent background</span>

<span class="hljs-comment"># Status left: Session name, pane command, and path</span>
set -g status-left-length <span class="hljs-number">100</span>
set -g status-left <span class="hljs-string">""</span>
set -ga status-left <span class="hljs-string">"<span class="hljs-subst">#{?client_prefix,#{#[bg=#{@red}</span>,fg=<span class="hljs-subst">#{@base}</span>,bold]  <span class="hljs-subst">#S</span> },<span class="hljs-subst">#{#[bg=<span class="hljs-keyword">default</span>,fg=#{@mauve}</span>]  <span class="hljs-subst">#S</span> }}"</span>
set -ga status-left <span class="hljs-string">"#[bg=default,fg=<span class="hljs-subst">#{@overlay0}</span>] │ "</span>
set -ga status-left <span class="hljs-string">"#[bg=default,fg=<span class="hljs-subst">#{@blue}</span>]  <span class="hljs-subst">#{pane_current_command}</span> "</span>
set -ga status-left <span class="hljs-string">"#[bg=default,fg=<span class="hljs-subst">#{@overlay0}</span>] │ "</span>
set -ga status-left <span class="hljs-string">"#[bg=default,fg=<span class="hljs-subst">#{@teal}</span>]  <span class="hljs-subst">#{=<span class="hljs-regexp">/-32/</span>...:#{s|$USER|~|:#{b:pane_current_path}</span>}} "</span>
set -ga status-left <span class="hljs-string">"#[bg=default,fg=<span class="hljs-subst">#{@overlay0}</span>]<span class="hljs-subst">#{?window_zoomed_flag, │ ,}</span>"</span>
set -ga status-left <span class="hljs-string">"#[bg=default,fg=<span class="hljs-subst">#{@yellow}</span>]<span class="hljs-subst">#{?window_zoomed_flag,  zoom ,}</span>"</span>

<span class="hljs-comment"># Status right: Battery, online status, VPN status, date/time</span>
set -g status-right-length <span class="hljs-number">100</span>
set -g status-right <span class="hljs-string">""</span>
set -ga status-right <span class="hljs-string">"<span class="hljs-subst">#{?#{e|&gt;=:<span class="hljs-number">10</span>,#{battery_percentage}</span>},<span class="hljs-subst">#{#[bg=#{@red}</span>,fg=<span class="hljs-subst">#{@base}</span>]},<span class="hljs-subst">#{#[bg=<span class="hljs-keyword">default</span>,fg=#{@peach}</span>]}} <span class="hljs-subst">#{battery_icon}</span> <span class="hljs-subst">#{battery_percentage}</span> "</span>
set -ga status-right <span class="hljs-string">"#[bg=default,fg=<span class="hljs-subst">#{@overlay0}</span>] │ "</span>
set -ga status-right <span class="hljs-string">"#[bg=default]<span class="hljs-subst">#{?#{==:#{online_status}</span>,ok},#[fg=<span class="hljs-subst">#{@sapphire}</span>] 󰖩 on ,#[fg=<span class="hljs-subst">#{@red}</span>,bold] 󰖪 off }"</span>
set -ga status-right <span class="hljs-string">"#[bg=default,fg=<span class="hljs-subst">#{@overlay0}</span>] │ "</span>
set -ga status-right <span class="hljs-string">"#[bg=default,fg=<span class="hljs-subst">#{@green}</span>]  #(~/vpn_status.sh) "</span>
set -ga status-right <span class="hljs-string">"#[bg=default,fg=<span class="hljs-subst">#{@overlay0}</span>] │ "</span>
set -ga status-right <span class="hljs-string">"#[bg=default,fg=<span class="hljs-subst">#{@sky}</span>] 󰭦 %Y-%m-%d 󰅐 %H:%M "</span>

<span class="hljs-comment"># Window status with rounded tabs and extra padding</span>
set -g <span class="hljs-built_in">window</span>-status-format <span class="hljs-string">"#[fg=<span class="hljs-subst">#{@overlay0}</span>]#[fg=<span class="hljs-subst">#{@text}</span>,bg=<span class="hljs-subst">#{@overlay0}</span>]  <span class="hljs-subst">#I</span>:<span class="hljs-subst">#W</span>  #[fg=<span class="hljs-subst">#{@overlay0}</span>,bg=default]"</span>
set -g <span class="hljs-built_in">window</span>-status-current-format <span class="hljs-string">"#[fg=<span class="hljs-subst">#{@green}</span>]#[fg=<span class="hljs-subst">#{@base}</span>,bg=<span class="hljs-subst">#{@green}</span>]  <span class="hljs-subst">#I</span>:<span class="hljs-subst">#W</span>  #[fg=<span class="hljs-subst">#{@green}</span>,bg=default]"</span>
set -g <span class="hljs-built_in">window</span>-status-style <span class="hljs-string">"bg=default"</span>
set -g <span class="hljs-built_in">window</span>-status-last-style <span class="hljs-string">"bg=default,fg=<span class="hljs-subst">#{@green}</span>"</span>
set -g <span class="hljs-built_in">window</span>-status-activity-style <span class="hljs-string">"bg=<span class="hljs-subst">#{@red}</span>,fg=<span class="hljs-subst">#{@base}</span>"</span>
set -g <span class="hljs-built_in">window</span>-status-bell-style <span class="hljs-string">"bg=<span class="hljs-subst">#{@red}</span>,fg=<span class="hljs-subst">#{@base}</span>,bold"</span>
set -gF <span class="hljs-built_in">window</span>-status-separator <span class="hljs-string">"  "</span>  <span class="hljs-comment"># Add space between window tabs</span>

<span class="hljs-comment"># Pane borders</span>
setw -g pane-border-status <span class="hljs-literal">off</span>  <span class="hljs-comment"># Hide pane border status</span>
setw -g pane-active-border-style <span class="hljs-string">"bg=default,fg=<span class="hljs-subst">#{@green}</span>"</span>
setw -g pane-border-style <span class="hljs-string">"bg=default,fg=<span class="hljs-subst">#{@surface0}</span>"</span>
setw -g pane-border-lines single

<span class="hljs-comment"># Automatic window renaming</span>
set -wg automatic-rename <span class="hljs-literal">on</span>
set -g automatic-rename-format <span class="hljs-string">"Window"</span>

<span class="hljs-comment"># Justify window status</span>
set -g status-justify <span class="hljs-string">"absolute-centre"</span>

<span class="hljs-comment"># Simulate bottom padding by adding a blank line</span>
set -g status-format[<span class="hljs-number">1</span>] <span class="hljs-string">""</span>

<span class="hljs-comment"># Bootstrap tpm</span>
<span class="hljs-keyword">if</span> <span class="hljs-string">"test ! -d ~/.tmux/plugins/tpm"</span> <span class="hljs-string">\</span>
   <span class="hljs-string">"run 'git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm &amp;&amp; ~/.tmux/plugins/tpm/bin/install_plugins'"</span>

<span class="hljs-comment"># Initialize TMUX plugin manager</span>
run <span class="hljs-string">'~/.tmux/plugins/tpm/tpm'</span>
</code></pre>
<p>Now, let’s save it and initiate the installation of the plugins.</p>
<p>Code: bash</p>
<pre><code class="lang-bash"><span class="hljs-symbol">Ctrl</span> + <span class="hljs-meta">Space</span>
<span class="hljs-symbol">Shift</span> + i
</code></pre>
<p>Once installed and reloaded, we will see a status bar that looks like following:</p>
<p><strong>Wave Terminal</strong></p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/multi7.png" alt="Terminal with three split panes, each showing a command prompt, and session details at the bottom."></p>
<p><strong>Ghostty</strong></p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/multi8.png" alt="Screenshot of a tmux session with four panes, each showing a command prompt. The top right pane has an error indicator, while the others show successful status. The background features a stylized fox logo."></p>
<p>We highly recommend you to go through the <a href="https://github.com/tmux/tmux/wiki/Getting-Started">Tmux Getting Started</a> documentation and get your hands dirty with tmux. Remember, the learning curve will be a little steeper, but the result will be more than worth the effort and time you invested in the end.</p>
<hr>
<h2 id="the-code-editor">The Code Editor</h2>
<hr>
<p>We will often encounter situations where we need to modify and/or write our own code. Code development, with Python for example, involves writing, testing, and debugging in order to solve problems or automate complex tasks. This demands our complete focus as it requires us to apply concentrated, logical thinking while maintaining an astute technical awareness. We will certainly have a hard time if our working environment is not setup properly.</p>
<p>We have three different options we can go with. Either we use a GUI editor, or we use an terminal-based editor, or we use both. Since we mainly work in the terminal, having a feature-rich terminal-based code editor is more efficient than any other solution. However, the GUI editors are more user-friendly and require less time to become familiar with. The improved learning curve comes at the cost of consuming more computer resources. For example, it may cause memory issues with multiple instances on 16GB RAM.</p>
<p>Let&#39;s take a look at one of the most widely used (and appreciated) GUI editors on the market.</p>
<hr>
<h3 id="vscode">VSCode</h3>
<p><a href="https://code.visualstudio.com/">VSCode</a> is a graphical integrated development environment (IDE) that is known for being user-friendly and has an extensive list of extensions. It also provides many built-in tools for debugging, Git, and numerous language support features. At the same time, its highly customizable and has an integrated terminal. Let’s download VSCode and install it.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/code1.png" alt="Visual Studio Code interface showing a file explorer with project files and a code editor with CSS code, alongside a chat panel."></p>
<p>In our example, we are using Ubuntu, and therefore have chosen to download and install the debian-based package.</p>
<p>&#x20; The Code Editor</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>sudo apt install ./code_1.<span class="hljs-number">99.3</span>-<span class="hljs-number">1744761595_</span>amd64.deb
cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>code
</code></pre>
<p>The first launch may take several seconds. Once it&#39;s fully started, you will see the following window where you can begin to configure and customize your VSCode IDE.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/code2.png" alt="Visual Studio Code setup screen with options to use AI features with Copilot, alongside a code editor displaying a project file."></p>
<p>Let&#39;s set the color scheme of the IDE to HackTheBox. First, run the commands shown below:</p>
<p>Code: bash</p>
<pre><code class="lang-bash">Ctrl + p
<span class="hljs-keyword">ext </span><span class="hljs-keyword">install </span>silofy.hackthebox
</code></pre>
<p>This will install the HackTheBox color scheme, which you can set as your preferred theme for VSCode.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/code3.png" alt="Visual Studio Code showing HackTheBox theme extension with options to set color theme, disable, or uninstall."></p>
<p>After that, your VSCode will look similar to this:</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/code4.png" alt="Visual Studio Code showing HackTheBox theme extension with options to set color theme, disable, or uninstall, and installation details."></p>
<p>When we paste a snippet of python code into a new file, the beautiful color set accentuates the structure of the code, making it much easier to read and edit.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/code5.png" alt="Visual Studio Code with a Python script demonstrating dictionary value extraction and unique value sorting."></p>
<p>For python development in particular, we have curated a list of useful extensions that will further enhance your experience with VSCode.</p>
<h3 id="installing-extensions">Installing Extensions</h3>
<table>
<thead>
<tr>
<th><strong>General</strong></th>
<th><strong>Python</strong></th>
<th><strong>Docker</strong></th>
<th><strong>Git</strong></th>
<th><strong>AI</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="https://marketplace.visualstudio.com/items/?itemName=aaron-bond.better-comments">Better Comments</a></td>
<td><a href="https://marketplace.visualstudio.com/items/?itemName=ms-python.python">Python</a></td>
<td><a href="https://marketplace.visualstudio.com/items/?itemName=ms-azuretools.vscode-docker">Docker</a></td>
<td><a href="https://marketplace.visualstudio.com/items/?itemName=eamodio.gitlens">Gitlens</a></td>
<td><a href="https://marketplace.visualstudio.com/items/?itemName=Continue.continue">Continue</a></td>
</tr>
<tr>
<td><a href="https://marketplace.visualstudio.com/items/?itemName=PKief.material-icon-theme">Material Icon Theme</a></td>
<td><a href="https://marketplace.visualstudio.com/items/?itemName=WolfiesHorizon.python-auto-venv">Python Auto VENV</a></td>
<td><a href="https://marketplace.visualstudio.com/items/?itemName=ms-vscode-remote.remote-containers">Remote Containers</a></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="https://marketplace.visualstudio.com/items/?itemName=Postman.postman-for-vscode">Postman for VSCode</a></td>
<td><a href="https://marketplace.visualstudio.com/items/?itemName=KevinRose.vsc-python-indent">Python Indent</a></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="https://marketplace.visualstudio.com/items/?itemName=ms-vscode-remote.remote-ssh">Remote SSH</a></td>
<td><a href="https://marketplace.visualstudio.com/items/?itemName=oderwat.indent-rainbow">Indent Rainbow</a></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="https://marketplace.visualstudio.com/items/?itemName=quicktype.quicktype">Quicktype</a></td>
<td><a href="https://marketplace.visualstudio.com/items/?itemName=almenon.arepl">Arepl</a></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="https://marketplace.visualstudio.com/items/?itemName=esbenp.prettier-vscode">Prettier</a></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><a href="https://marketplace.visualstudio.com/items/?itemName=johnpapa.vscode-peacock">Peacock</a></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>It is highly recommended to read through their documentations and see how each of the extension can be configured and adapted to your needs.</p>
<hr>
<h3 id="neovim">NeoVIM</h3>
<p>Neovim is a terminal-based text editor that offers a high degree of customization and wide range of extensions. It is significantly faster than VSCode and emphasizes keyboard-driven workflows, which is ideal for users who prefer to manage everything within a single screen. Neovim is also very lightweight, requiring minimal RAM and CPU resources—making it well-suited for handling multiple sessions or working with large codebases. However, Neovim depends on additional plugins, such as DAP for debugging, which are less intuitive and require manual configuration.</p>
<p>Now, let&#39;s download and install Neovim with the commands shown below:</p>
<p>&#x20; The Code Editor</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-meta">@ubuntu</span>:~$ curl -LO <span class="hljs-string">https:</span><span class="hljs-comment">//github.com/neovim/neovim/releases/latest/download/nvim-linux-x86_64.tar.gz</span>
cry0l1t3<span class="hljs-meta">@ubuntu</span>:~$ sudo rm -rf <span class="hljs-regexp">/opt/</span>nvim
cry0l1t3<span class="hljs-meta">@ubuntu</span>:~$ sudo tar -C /opt -xzf nvim-linux-x86_64.tar.gz
cry0l1t3<span class="hljs-meta">@ubuntu</span>:~$ echo <span class="hljs-string">'export PATH="$PATH:/opt/nvim-linux-x86_64/bin"'</span> &gt;&gt; ~/.zshrc
</code></pre>
<p>There is a pre-configured Neovim framework called <code>NvChad</code> that includes an enhanced UI, startup time, and curated plugins to make it an IDE-like experience. Let’s download it and replace the default Neovim configuration with the new one.</p>
<p>&#x20; The Code Editor</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span><span class="hljs-comment"># NvChad</span>
cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>git clone <span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/github.com/</span>NvChad/starter ~<span class="hljs-regexp">/.config/nvim</span>
</code></pre>
<p>If you are not familiar with Neovim/Vim and it’s functionalities, we recommend you to go through the built-in tutor which teaches the basics of Neovim/Vim. In order to start the <code>vimtutor</code> you can use the following command:</p>
<p>&#x20; The Code Editor</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>vimtutor
</code></pre>
<p>Skipping the tutor might result in the awkward situation, where you realize you cannot exit Neovim/Vim.</p>
<p>Fearlessly moving onwards, when we start Neovim by running the command <code>nvim</code>, we are met with the following screen.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/code6.png" alt="Neovim interface showing plugin management with options like Install, Update, and Sync. Displays NvChad news and plugin status updates."></p>
<p>Once again, we recommend reading the documentation to become familiar with using vim, as Neovim/Vim will allow you to write and edit code or files <code>very fast</code> once you are proficient. Also, NvChad provides a theme selection that we can open with the key <code>Space + t + h</code> . Here, we will find a variety of prebuilt themes and can select the one that suits our tastes.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/code7.png" alt="Tmux interface displaying a color scheme selection menu with various themes like &#39;jabuti&#39; and &#39;material-deep-ocean&#39;."></p>
<hr>
<h2 id="productivity-utilities">Productivity Utilities</h2>
<hr>
<p>In this section we will cover a few more tools to further enhance your productivity and efficiency. Specifically, we will be focusing on tools that supplement:</p>
<ul>
<li>finding specific information, files, or directories</li>
<li>listing directory contents</li>
<li>printing the contents of files in much more efficient way</li>
<li>getting a quick look at our system performance</li>
</ul>
<hr>
<h2 id="fzf">FZF</h2>
<p>First, let’s start with <a href="https://github.com/junegunn/fzf">FZF</a>. FZF is a terminal-based fuzzy finder designed to interactively filter and search lists with fuzzy matching. It allows us to search for strings to match items scattered across another string with instant feedback. Also, it allows us to integrate other tools like <code>batcat</code> or <code>eza</code> (that will be discussed later in this section) to see the contents of our matches, without the need to exit the FZF window.</p>
<p>Basically, it replaces the find command, which often produces a lot of input for us to sift through without being able to filter out certain strings. To install FZF we can use the following commands:</p>
<p>&#x20; FZF</p>
<pre><code class="lang-shell-session">cry0l1t3@ubuntu:~$ git clone --depth <span class="hljs-number">1</span> https://github.com/junegunn/fzf.git ~/.fzf

<span class="hljs-symbol">Cloning</span> into <span class="hljs-string">'/home/cry0l1t3/.fzf'</span>...
remote: <span class="hljs-symbol">Enumerating</span> objects: <span class="hljs-number">145</span>, done.
remote: <span class="hljs-symbol">Counting</span> objects: <span class="hljs-number">100</span><span class="hljs-comment">% (145/145), done.</span>
remote: <span class="hljs-symbol">Compressing</span> objects: <span class="hljs-number">100</span><span class="hljs-comment">% (136/136), done.</span>
remote: <span class="hljs-symbol">Total</span> <span class="hljs-number">145</span> (delta <span class="hljs-number">5</span>), reused <span class="hljs-number">58</span> (delta <span class="hljs-number">2</span>), pack-reused <span class="hljs-number">0</span> (from <span class="hljs-number">0</span>)
<span class="hljs-symbol">Receiving</span> objects: <span class="hljs-number">100</span><span class="hljs-comment">% (145/145), 347.52 KiB | 1.96 MiB/s, done.</span>
<span class="hljs-symbol">Resolving</span> deltas: <span class="hljs-number">100</span><span class="hljs-comment">% (5/5), done.</span>
<span class="hljs-symbol">Downloading</span> bin/fzf ...
  <span class="hljs-comment">% Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span>
                                 <span class="hljs-symbol">Dload</span>  <span class="hljs-symbol">Upload</span>   <span class="hljs-symbol">Total</span>   <span class="hljs-symbol">Spent</span>    <span class="hljs-symbol">Left</span>  <span class="hljs-symbol">Speed</span>
  <span class="hljs-number">0</span>     <span class="hljs-number">0</span>    <span class="hljs-number">0</span>     <span class="hljs-number">0</span>    <span class="hljs-number">0</span>     <span class="hljs-number">0</span>      <span class="hljs-number">0</span>      <span class="hljs-number">0</span> --:--:-- --:--:-- --:--:--     <span class="hljs-number">0</span>
<span class="hljs-number">100</span> <span class="hljs-number">1571</span>k  <span class="hljs-number">100</span> <span class="hljs-number">1571</span>k    <span class="hljs-number">0</span>     <span class="hljs-number">0</span>  <span class="hljs-number">1728</span>k      <span class="hljs-number">0</span> --:--:-- --:--:-- --:--:-- <span class="hljs-number">9685</span>k
  - <span class="hljs-symbol">Checking</span> fzf executable ... <span class="hljs-number">0.61</span><span class="hljs-number">.3</span>


cry0l1t3@ubuntu:~$ ~/.fzf/install

<span class="hljs-symbol">Do</span> you want to enable fuzzy auto-completion? ([y]/n) y
<span class="hljs-symbol">Do</span> you want to enable key bindings? ([y]/n) y

<span class="hljs-symbol">Generate</span> /home/cry0l1t3/.fzf.bash ... <span class="hljs-symbol">OK</span>
<span class="hljs-symbol">Generate</span> /home/cry0l1t3/.fzf.zsh ... <span class="hljs-symbol">OK</span>

<span class="hljs-symbol">Do</span> you want to update your shell configuration files? ([y]/n) y

<span class="hljs-symbol">Update</span> /home/cry0l1t3/.bashrc:
  - [ -f ~/.fzf.bash ] &amp;&amp; source ~/.fzf.bash
    + <span class="hljs-symbol">Added</span>

<span class="hljs-symbol">Update</span> /home/cry0l1t3/.zshrc:
  - [ -f ~/.fzf.zsh ] &amp;&amp; source ~/.fzf.zsh
    + <span class="hljs-symbol">Added</span>

<span class="hljs-symbol">Finished</span>. <span class="hljs-symbol">Restart</span> your shell or reload config file.
   source ~/.bashrc  # bash
   source ~/.zshrc   # zsh

<span class="hljs-symbol">Use</span> uninstall script to remove fzf.

<span class="hljs-symbol">For</span> more information, see: https://github.com/junegunn/fzf
</code></pre>
<p>Once installed, we can edit the <code>.zshrc</code> file and assign an alias to the <code>fzf</code> command.</p>
<p>&#x20; FZF</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>vim .zshrc
</code></pre>
<p>Code: bash</p>
<pre><code class="lang-bash"><span class="hljs-section">&lt;SNIP&gt;</span>

<span class="hljs-comment"># Aliases</span>
<span class="hljs-attribute">alias</span> ff=<span class="hljs-string">"fzf --style full --preview 'fzf-preview.sh {}' --bind 'focus:transform-header:file --brief {}'"</span>

<span class="hljs-section">&lt;SNIP&gt;</span>
</code></pre>
<p>Now, we need to reload the <code>.zshrc</code> file for the Zsh.</p>
<p>&#x20; FZF</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>source ~<span class="hljs-regexp">/.zshrc</span>
</code></pre>
<p>After that, if you type <code>ff</code> it will open up an interactive interface where you can see the contents of the current directory with the contents of the <code>mycode.py</code> file.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/prod1.png" alt="Tmux interface with a split view showing a Python script for extracting unique dictionary values on the right and a file list on the left."></p>
<hr>
<h3 id="eza">EZA</h3>
<p>Eza is a modern alternative to the command <code>ls</code>. It provides colorful, detailed file listings with Git status, icons, and advanced features like hyperlinks. Also, it distinguishes file types with colors and optional icons if you are using the <a href="https://www.nerdfonts.com/">Nerd Font</a>. We can even edit the theme and the colors that Eza uses.</p>
<p>Since <code>ls</code> is one of the most common commands we use on Linux systems, having a better and more efficient tool makes our lives much easier long-term. To install it we can run the following commands:</p>
<p>&#x20; FZF</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>sudo apt install eza -y
cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>vim ~<span class="hljs-regexp">/.zshrc</span>
</code></pre>
<p>Now, we can assign different aliases to the <code>eza</code> command to get different representations of the listings.</p>
<p>Code: bash</p>
<pre><code class="lang-bash">&lt;SNIP&gt;

# Aliases
<span class="hljs-keyword">alias</span> ff=<span class="hljs-string">"fzf --style full --preview 'fzf-preview.sh {}' --bind 'focus:transform-header:file --brief {}'"</span>
<span class="hljs-keyword">alias</span> ls=<span class="hljs-symbol">'eza</span> $eza_params'
<span class="hljs-keyword">alias</span> l=<span class="hljs-symbol">'eza</span> <span class="hljs-comment">--git-ignore $eza_params'</span>
<span class="hljs-keyword">alias</span> ll=<span class="hljs-symbol">'eza</span> <span class="hljs-comment">--all --header --long $eza_params'</span>
<span class="hljs-keyword">alias</span> llm=<span class="hljs-symbol">'eza</span> <span class="hljs-comment">--all --header --long --sort=modified $eza_params'</span>
<span class="hljs-keyword">alias</span> la=<span class="hljs-symbol">'eza</span> -lbhHigUmuSa'
<span class="hljs-keyword">alias</span> lx=<span class="hljs-symbol">'eza</span> -lbhHigUmuSa@'
<span class="hljs-keyword">alias</span> lt=<span class="hljs-symbol">'eza</span> <span class="hljs-comment">--tree $eza_params'</span>
<span class="hljs-keyword">alias</span> tree=<span class="hljs-symbol">'eza</span> <span class="hljs-comment">--tree $eza_params'</span>

&lt;SNIP&gt;
</code></pre>
<p>Once again, after editing the <code>.zshrc</code> file we need to reload it.</p>
<p>&#x20; FZF</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>source ~<span class="hljs-regexp">/.zshrc</span>
</code></pre>
<p>Now, we can test the different commands and check the results.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/prod2.png" alt="Tmux interface showing directory listings with file permissions, sizes, and modification dates for &#39;.oh-my-zsh&#39; plugins."></p>
<hr>
<h3 id="bat">Bat</h3>
<p><a href="https://github.com/sharkdp/bat">Bat</a> is a cat with wings. It provides syntax highlighting for a large number of languages and comes with built-in git integration that allows us to see modifications within the files.</p>
<p>&#x20; FZF</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>sudo apt install bat
</code></pre>
<p>Here you can see the difference between the standard tool <code>cat</code> and <code>batcat</code>. Feel free to add an alias for <code>cat</code> which is replaced by <code>batcat</code> with necessary options that you can find at their repository.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/prod3.png" alt="Tmux interface with split view showing Python script for extracting unique dictionary values in two panes."></p>
<hr>
<h3 id="btop">Btop</h3>
<p>Btop is a system monitor tool for the terminal which replaces the <code>htop</code> and <code>top</code> tools. It is also colorful and can be customized depending on your needs and preferences. It can monitor CPU, memory, disk, network and processes which makes it a great tool for debugging performance issues. You can install the tool with the following command:</p>
<p>&#x20; FZF</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>sudo apt install btop -y
</code></pre>
<p><img src="https://academy.hackthebox.com/storage/modules/87/prod4.png" alt="Tmux interface displaying system monitoring with CPU, memory, disk usage, network activity, and process list."></p>
<hr>
<h2 id="remote-desktop">Remote Desktop</h2>
<hr>
<p>Remote desktop connections allow users to access and control a computer, a server, or its desktop environment remotely over a network. It is used in cases where physical access is impractical and inconvenient. For example, if an employee needs help with certain settings on his Windows machine, we can provide assistance without having to go to the office. All we would need to do is to connect to his computer remotely using the Remote Desktop Protocol.</p>
<p>In order to do this, we need an RDP client that can handle the task. They are many different tools available for this, but we will cover only three of them:</p>
<table>
<thead>
<tr>
<th><code>XfreeRDP</code></th>
<th><code>RDesktop</code></th>
<th><code>Rustdesk</code></th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
</tr>
</tbody>
</table>
<hr>
<h3 id="xfreerdp">XFREERDP</h3>
<p>Xfreerdp is a command line client that allows us to connect to RDP servers that support network level authentication, TLS encryption, and credential passing. It is optimized for low-latency connection with the support for H.264 compression, ensuring that even if the connection is not at its best state, we most likely will be able to do the work we need.</p>
<p>Pwnbox has <code>xfreerdp</code> pre-installed and can be used from the terminal. If you want to install it on another Debian based distribution, you can use the following command:</p>
<p>&#x20; Remote Desktop</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>sudo apt install xfreerdp -y
</code></pre>
<p>Once installed, we can specify the username (<code>/u:</code>), the password (<code>/p:</code>) and the remote RDP host (<code>/v:</code>) we wish to connect to. This will initialize the RDP connection, where you will be asked if you want to trust this device. After you have confirmed this, a new window will appear that displays desktop of the remote host.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/rdp1.png" alt="Split screen showing a Windows desktop via FreeRDP on the left and a terminal with xfreerdp command output on the right, including certificate verification details and logon error."></p>
<hr>
<h3 id="rdesktop">RDESKTOP</h3>
<p>Rdesktop is an older, open-source RDP client which is lightweight but also less actively maintained than FreeRDP. This results in limited support for modern RDP features like network level authentication and modern TLS encryption. It can be installed using the following command:</p>
<p>&#x20; Remote Desktop</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>sudo apt install rdesktop -y
</code></pre>
<p>To establish an RDP connection, like with <code>xfreerdp</code> we can specify a username (<code>-u</code>), a password (<code>-p</code>) and the target domain (<code>-d</code>) if needed. The remote host IP address doesn’t need a flag but will be added at the end of the command.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/rdp2.png" alt="Split screen with Windows desktop via rdesktop on the left and terminal output on the right showing certificate warnings and connection details."></p>
<hr>
<h3 id="rustdesk">Rustdesk</h3>
<p><a href="https://rustdesk.com/">Rustdesk</a> is an open-source alternative to TeamViewer and AnyDesk, but serves a different purpose. By default you cannot connect to an RDP server right away, as it requires a session ID and password that&#39;s generated on each host. This requires user interaction on both the administrator and user sides. On the one hand, an administrator cannot manage the host without the user giving him access to it. But on the other side, if RDP is deactivated, a remote session to a Windows or Linux host will be much harder to achieve from attacker’s perspective.</p>
<p>We can visit their homepage and download the necessary package. You can either use the client only or self-host the service.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/rdp3.png" alt="RustDesk homepage promoting open-source remote access software with download and self-hosting options."></p>
<p>Once we have downloaded the client we can install it by using the following command:</p>
<p>&#x20; Remote Desktop</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-symbol">@ubuntu</span>:~$ cd ~/Downloads
cry0l1t3<span class="hljs-symbol">@ubuntu</span>:~$ sudo apt install ./rustdesk<span class="hljs-number">-1.3</span><span class="hljs-number">.9</span>-x86_64.deb -y
</code></pre>
<p>After the installation, we can run it and will see the following screen with a session ID and a one-time password.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/rdp4.png" alt="Remote desktop interface showing ID 161 824 388, password wq3jzr, and a warning about Wayland support. No recent sessions available."></p>
<p>In this example, we also have downloaded the same client to a Windows machine and launched it. Now, we will take the session ID and the one-time password from the Windows host and use it on our Linux host to connect.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/rdp5.png" alt="Remote desktop interface with ID 153 069 124, password 575twm, and a UAC warning for RustDesk installation. No recent sessions available."></p>
<p>After entering the session ID we will be asked for the one-time password of the Windows host.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/rdp6.png" alt="Password prompt for RustDesk verification with options to enter password, remember password, and buttons to cancel or confirm."></p>
<p>When the credentials are provided correctly we will see a new window showing the remove desktop connection.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/rdp7.png" alt="Remote desktop interface with ID 161 824 388, password wq3jzr, Wayland support warning, and connection to ID 153 069 124."></p>
<p>This is especially useful when we need to help someone remotely. Rustdesk is one of the best solutions for such tasks, since all connections use end-to-end encryption (E2EE) based on NaCl by default—ensuring data privacy and security during all remote sessions. Additionally, it supports file transfers, clipboard sharing, multi-monitor setups, session recording, live chat, and TCP tunneling. This set of features make this tool both secure and efficient, which is ideal for our purposes.</p>
<hr>
<h2 id="containers">Containers</h2>
<hr>
<p>A <code>container</code> cannot be defined as a virtual machine, but rather an isolated group of <code>processes</code>—running on a single host—that corresponds to a complete application, including its configuration and dependencies. This application is packaged in a precisely defined, reusable format. Unlike a typical VM on VMware Workstation, a container does not include its own operating system or kernel. It is, therefore, not a virtualized operating system. For this reason, containers are significantly slimmer than conventional virtual machines. Due to not actually being virtual machines, they are referred to as application virtualization in this context.</p>
<p><img src="https://wiki.geant.org/download/attachments/184549510/containers-vs-virtual-machines.jpg?version=1\&amp;modificationDate=1607437321973\&amp;api=v2" alt="Diagram comparing virtual machines and containers. Virtual machines have separate guest OS for each app, running on a hypervisor. Containers share an OS, using a container engine for app isolation."></p>
<p>Resource: <a href="https://wiki.geant.org/download/attachments/184549510/containers-vs-virtual-machines.jpg?version=1\&amp;modificationDate=1607437321973\&amp;api=v2">https://wiki.geant.org</a></p>
<p>A significant issue when rolling out new applications or new releases is that each application depends on certain aspects of its environment. These include, for example, local settings or function libraries. Often, the settings in the development environment differ from those in the test environment and production. It can then happen quickly that, contrary to expectations, an application works differently or not at all in production.</p>
<table>
<thead>
<tr>
<th><strong>Virtual Machine</strong></th>
<th><code>Container</code></th>
</tr>
</thead>
<tbody>
<tr>
<td>Contain applications and the complete operating system</td>
<td><code>Contain applications and only the necessary operating system components such as libraries and binaries</code></td>
</tr>
<tr>
<td>A hypervisor such as VMware ESXi provides virtualization</td>
<td><code>The operating system with the container engine provides its own virtualization</code></td>
</tr>
<tr>
<td>Multiple VMs run in isolation from each other on a physical server</td>
<td><code>Several containers run isolated from each other on one operating system</code></td>
</tr>
</tbody>
</table>
<p>Application containers are technically based on functions that have been available under the Linux operating system for some time. The kernel uses these functions to <code>isolate</code> applications. Thus, applications run isolated from each other as a process in different user accounts. However, they belong at the same time to a familiar Linux environment. The cooperation of various applications is also possible, and if the containers run on the same system, a container daemon is used—for example, the <code>Linux Container Daemon</code> (<code>LXD</code>). LXD is a similar technology to <code>Linux Containers</code> (<code>LXC</code>). LXC is a container-based virtualization technology at the operating system level. Technically, LXC combines isolated namespaces and the Linux kernel &quot;cgroups&quot; to implement isolated environments for code execution. Historically, LXC was also the basis for the widely used Docker virtualization technology. Using LXD, Linux operating system containers can be configured and controlled via a defined set of commands. It is therefore suitable for automating mass container management and is used in cloud computing and data centers.</p>
<p>An image of the file system forms the basis of each container. We can choose whether to use an image that has already been created or to create one ourselves. Containers are also characterized by outstanding scalability. Improved scalability is ideally suited to the requirements of the now highly dynamic IT infrastructure in companies. Indeed, the high scalability of containers makes it possible to ideally adapt the capacities for the users&#39; provision of applications. Meanwhile, even large container setups can be managed without any problems because of orchestration systems such as <code>Apache Mesos</code> or <code>Google Kubernetes</code>. These systems distribute the containers over the existing hardware based on predefined rules and monitor them.</p>
<hr>
<h3 id="introduction-to-docker">Introduction to Docker</h3>
<p><a href="https://www.docker.com/get-started">Docker</a> is open-source software that can isolate applications in containers, similar to operating system virtualization. This approach significantly simplifies the deployment of applications. The application data stored in the containers can be transported and installed easily. The use of containers ensures that computer resources are strictly separated from each other. Docker stores programs together with their dependencies in images. These form the basis for virtualized containers that can run on almost any operating system. This makes applications portable and uncomplicated, whether during development or when scaling <a href="https://en.wikipedia.org/wiki/Software_as_a_service">SaaS</a> clusters.</p>
<p><a href="https://docs.docker.com/engine/">Docker Engine</a> is the main component of container virtualization. The software provides the interface between host resources and running containers. Any system that has Docker Engine installed can use Docker containers. Originally, Docker was designed to be used on Linux systems. However, with virtualization via VMware or Hyper-V, the engine also works on Windows or Mac OS devices. Docker can therefore be used in virtually all common scenarios.</p>
<p><strong>Docker Installation</strong></p>
<p>&#x20; Containers</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@htb</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>sudo apt update -y 
cry0l1t3<span class="hljs-variable">@htb</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>sudo apt install docker.io -y
</code></pre>
<p>&#x20; Containers</p>
<pre><code class="lang-powershell-session"><span class="hljs-string">C:</span>\&gt; IEX((<span class="hljs-keyword">new</span>-object net.webclient).DownloadString(<span class="hljs-string">'https://chocolatey.org/install.ps1'</span>))
<span class="hljs-string">C:</span>\&gt; choco upgrade chocolatey
<span class="hljs-string">C:</span>\&gt; choco install docker-desktop
</code></pre>
<hr>
<h3 id="introduction-to-vagrant">Introduction to Vagrant</h3>
<p><a href="https://www.vagrantup.com/">Vagrant</a> is a tool that can create, configure and manage virtual machines or virtual machine environments. The VMs are not created and configured manually but are described as code within a <code>Vagrantfile</code>. To better structure the program code, the Vagrant file can include additional code files. The code can then be processed using the Vagrant CLI. In this way, we can create, provision, and start our own VMs. Moreover, if the VMs are no longer needed, they can be destroyed just as quickly and easily. Out of the box, Vagrant offers providers for VMware and Docker.</p>
<p><img src="https://stefanscherer.github.io/content/images/2016/03/windows_swarm_demo.png" alt="Diagram of Docker Swarm setup with Vagrant and VirtualBox on host, registry, and three Windows nodes (sw-win-01, sw-win-02, sw-win-03)."> Resource: <a href="https://stefanscherer.github.io/content/images/2016/03/windows\_swarm\_demo.png">https://stefanscherer.github.io/content/images/2016/03/windows\_swarm\_demo.png</a></p>
<p><strong>Vagrant Installation</strong></p>
<p>&#x20; Containers</p>
<pre><code class="lang-shell-session"><span class="hljs-comment"># Linux</span>
cry0l1t3<span class="hljs-variable">@htb</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>sudo apt update -y 
cry0l1t3<span class="hljs-variable">@htb</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>sudo apt install virtualbox virtualbox-dkms vagrant
</code></pre>
<p>&#x20; Containers</p>
<pre><code class="lang-powershell-session"><span class="hljs-comment"># Windows</span>
C:<span class="hljs-string">\&gt;</span> IEX((<span class="hljs-keyword">new</span>-object net.webclient).DownloadString(<span class="hljs-string">'https://chocolatey.org/install.ps1'</span>))
C:<span class="hljs-string">\&gt;</span> choco upgrade chocolatey
C:<span class="hljs-string">\&gt;</span> cinst virtualbox cyg-get vagrant
</code></pre>
<hr>
<p>It is highly recommended to play around with different containers and experiment to get a feel for them. We should look at the documentation and read through it to understand how the containers work and what they depend on. It will also help us understand what advantages and disadvantages they bring.</p>
<hr>
<h2 id="isolation-sandboxing">Isolation &amp; Sandboxing</h2>
<hr>
<p>Sandboxing and isolation are security techniques that are used to restrict and control the execution environment of applications like browsers, preventing unauthorized access to system resources, data, or other processes. For example, if we receive a suspicious link, we can launch a browser in a sandbox which doesn’t have access to any files on our system and open the link in that isolated browser.</p>
<p>Isolation is a security concept that involves separating processes, applications, or entire environments to prevent them from interacting with each other or accessing unauthorized resources.</p>
<p>Sandboxing is part of isolation and is a security mechanism that runs the processes and applications in a restricted environment.</p>
<hr>
<h3 id="firejail">Firejail</h3>
<p>Firejail is a sandboxing tool which creates and restricts a running environment of untrusted applications and processes. It is lightweight and it uses kernel security features to isolate the processes. It comes with many pre-configured profiles for thousands of applications and its very easy to use.</p>
<p>In order to install it we need to add a new repository and download it using the APT package manager. Once installed we can launch it by using <code>firejail</code>.</p>
<p>&#x20; Isolation &amp; Sandboxing</p>
<pre><code class="lang-shell-session">cry0l1t3@ubuntu:~$ sudo<span class="hljs-built_in"> add-apt-repository </span>ppa:deki/firejail
cry0l1t3@ubuntu:~$ sudo apt-get update
cry0l1t3@ubuntu:~$ sudo apt-get install firejail firejail-profiles

firejail
</code></pre>
<p>Next, we can install <code>firetools</code> which is a simple GUI to manage the sandboxes. Let’s install it:</p>
<p>&#x20; Isolation &amp; Sandboxing</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>sudo apt install firetools -y
cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>firetools
</code></pre>
<p>You will see a new sidebar showing a few applications with the corresponding profiles. When you click on one of the applications it will launch it in a sandbox with the preconfigured profile.</p>
<p>At the top left corner you will see an icon to launch the configuration board for firejail.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/iso1.png" alt="Desktop showing Firejail application running in terminal and Firetools config window for selecting applications to sandbox."></p>
<p>At this point we can select the application we want to sandbox and launch it.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/iso2.png" alt="Firejail config window with application selection menu and filesystem browsing showing RustDesk in /usr/bin."></p>
<p>This will create a new sandbox and execute the application inside this sandbox.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/iso3.png" alt="Desktop showing Firejail terminal output, RustDesk interface with ID 161 824 388, password 8gd7ky, and Wayland support warning."></p>
<p>However, like any other application, firejail is not 100% bulletproof. Firejail’s reliance on <code>namespaces</code> and <code>seccomp</code> has known vulnerabilities—especially if syscalls aren’t properly filtered—and a kernel exploit exists that could bypass firejail’s restrictions.</p>
<hr>
<h3 id="kasm">KASM</h3>
<p><a href="https://kasmweb.com/">Kasm Workspaces</a> on the other hand is a containerized virtual desktop and application streaming platform that delivers secure, isolated workspaces through a browser. It focuses on zero-trust principles and remote browser isolation (RBI). Unlike Firejail, which runs locally on Linux, Kasm is a server-based solution using Docker containers to isolate applications and desktops which can be self-hosted as well.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/iso4.png" alt="Kasm Workspaces homepage with text &#39;The Workspace Streaming Platform&#39; and options for Linux Desktop, Windows Desktop, and Cloud Browser."></p>
<p>In order to install it, we need to download a <code>.tar.gz</code> archive and execute the script with the following commands:</p>
<p>&#x20; Isolation &amp; Sandboxing</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>cd /tmp
cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>curl -O <span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/kasm-static-content.s3.amazonaws.com/kasm</span>_release_1.<span class="hljs-number">17.0</span>.bbc15c.tar.gz
cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>tar -xf kasm_release_1.<span class="hljs-number">17.0</span>.bbc15c.tar.gz
cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>sudo bash kasm_release/install.sh
</code></pre>
<p>Once the installation is finished, you will see a set of different credentials for different users, database, and tokens.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/iso5.png" alt="Terminal showing Kasm installation complete with login, database, Redis credentials, manager token, and service registration token."></p>
<p>When we visit the <a href="https://localhost">https://localhost</a> page to access the login page of KASM, we will use the administrator credentials generated by the installation script to login.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/iso6.png" alt="Login page for Kasm Workspaces with fields for email and password, and logo with text &#39;The Container Streaming Platform&#39;."></p>
<p>In the main dashboard we will see all the statistics about users, successful logins, failed logs, workspaces, and much more.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/iso7.png" alt="Dashboard interface showing usage statistics, current statistics, and image usage with navigation menu on the left."></p>
<p>When we go to <code>Workspaces (sidebar) &gt; Registry</code>, we will find a set of pre-configured images available for download. These images are used to launch an isolated environment inside a Docker container whenever we initiate it.</p>
<p>KASM Workspaces also provide an image of Parrot OS.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/iso8.png" alt="Workspace registry interface showing available workspaces with Parrot OS filtered, navigation menu on the left."></p>
<p>For demonstration purposes we will download an image of the Brave browser.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/iso9.png" alt="Workspace registry interface showing installed workspaces with Brave browser, navigation menu on the left."></p>
<p>Once installed, we can switch over to the <code>Workspaces (at the top)</code> and see the available image of the Brave browser that we just downloaded. When we click on it, it will create a new isolated container.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/iso10.png" alt="Mountain landscape with Brave browser icon, navigation options for Workspaces and Admin at the top."></p>
<p>After the container has been loaded, we can use it as a default browser.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/iso11.png" alt="HTB Academy homepage with text &#39;Your cybersecurity journey starts here&#39; and options to start for free or for business."></p>
<p>These disposable workspaces are ephemeral environments that are destroyed after each session, ensuring no persistent data or tracking. More about KASM seamless integration can be found <a href="https://kasmweb.com/docs/latest/guide/browser_isolation.html">here</a>.</p>
<hr>
<h2 id="http-utilities">HTTP Utilities</h2>
<hr>
<p>Since nearly every modern business relies on the internet in some way—whether through web servers, APIs, or HTTP(S) requests—it is essential to have tools in our environment that make interacting with these technologies efficient, fast, and easy to manage.</p>
<p>These tools should be capable of handling the following tasks for us:</p>
<ul>
<li>Testing and exploring APIs with various HTTP methods and payloads</li>
<li>Debugging HTTP requests by inspecting headers and responses</li>
<li>Automating API interactions in scripts or pipelines</li>
<li>Handling complex requests with authentication, file uploads, or custom headers</li>
<li>Downloading files or transferring data over HTTP/HTTPS</li>
</ul>
<hr>
<h3 id="curlie">Curlie</h3>
<p><a href="https://github.com/rs/curlie">Curlie</a> is one of the best tools that we can use for such purposes. It is built upon <code>curl</code> and <code>httpie</code> which enhances the overall functionality. We can download the tool using the following command:</p>
<p>&#x20; HTTP Utilities</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>curl -sS <span class="hljs-symbol">https:</span>/<span class="hljs-regexp">/webinstall.dev/curlie</span> | bash
</code></pre>
<p>Now, let’s compare <code>curlie</code> with <code>curl</code> by requesting the same API endpoint.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/http1.png" alt="Terminal showing API request to thecatapi.com with JSON response containing image URL and dimensions."></p>
<p>As you can see, it provides a colorful and structured output in a user-friendly way with way more information than <code>curl</code>. Additionally, it makes analysis of requests and debugging much easier.</p>
<hr>
<h3 id="postman">Postman</h3>
<p><a href="https://www.postman.com/downloads/">Postman</a> is a widely used platform and tool for API development, testing, and collaboration. It offers both a graphical user interface (GUI) and a command line interface to streamline workflows. Postman is designed to simplify the process of designing, testing, documenting, and monitoring APIs, making it a go-to tool for many developers and testers working with REST, GraphQL, gRPC, and other API types. While Postman is well-suited for collaborative work, in our case—where we primarily perform one-off API requests—it is somewhat excessive. Compared to <code>curlie</code>, it is slower and includes many features that are unnecessary for simple API endpoint testing.</p>
<p>However, if your use case involves more than basic testing, Postman is an excellent tool to consider. The installation package can be downloaded from the official website.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/http2.png" alt="Download Postman page with options for Linux (x64) and Linux (arm64), and a preview of the Postman interface."></p>
<p>After downloading the package, we can extract the contents and run the binary.</p>
<p>&#x20; HTTP Utilities</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-symbol">@ubuntu</span>:~$ cd ~/Downloads
cry0l1t3<span class="hljs-symbol">@ubuntu</span>:~$ tar -xzvf ./postman-linux-x64.tar.gz
cry0l1t3<span class="hljs-symbol">@ubuntu</span>:~$ cd Postman
cry0l1t3<span class="hljs-symbol">@ubuntu</span>:~$ ./Postman
</code></pre>
<p>We should see a registration/login page in a new window. However, registration is not required initially, and we can subsequently skip the registration/login process.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/http3.png" alt="Postman API Platform login page with fields for email, options to create a free account, continue with Google, or use Single Sign-On."></p>
<p>Now, we should see a dashboard with history requests, a URL input field for the API endpoint, a table for the query parameters, and a response field where the results of our requests are displayed.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/http4.png" alt="Postman interface with options to create a request, showing sections for Params, Authorization, Headers, and Body."></p>
<p>Let&#39;s provide a URL, add the headers, and send the request.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/http5.png" alt="Postman interface showing a GET request to urlscan.io with headers and query parameters."></p>
<p>In the response window below, we will see the entire response received from the API (which we can analyze step by step.)</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/http6.png" alt="Postman interface showing a GET request to urlscan.io API with JSON response details, including server info and domain data."></p>
<hr>
<h3 id="posting-sh">Posting.sh</h3>
<p>A terminal-based alternative to Postman is <a href="https://posting.sh/">Posting.sh</a>. This lightweight tool provides a terminal based user interface with an intuitive keyboard-centric workflow. This means that we can quickly perform all of our HTTP-related actions and requests via keyboard, never touching the mouse.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/http7.png" alt="Terminal-based API client interface showing a POST request to jsonplaceholder.typicode.com with JSON response, headers, and request details."></p>
<p>Let&#39;s install it, then create a new directory where all our requests will be stored:</p>
<p>&#x20; HTTP Utilities</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>sudo apt install pipx -y
cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>pipx install posting
cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>mkdir myrequests &amp;&amp; cd myrequests
cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>posting
</code></pre>
<p>At the bottom, you will see a new panel showing the shortcuts that can be used to control the user interface, which is The similar to Postman’s. Once we have sent out our request, the response window will display the contents of the data we receive from the API.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/http8.png" alt="Terminal interface showing a GET request to v1.cveapi.com with JSON response details for CVE-2019-9956."></p>
<hr>
<h2 id="self-hosting-ai">Self Hosting AI</h2>
<hr>
<p>Using an AI/LLM locally comes with a lot of benefits. One of the most reasons people use local AI is privacy since all the data that the AI/LLM model is processing doesn’t require an internet connection. A local setup also ensures offline accessibility which is a critical feature for those in regions with unstable internet connectivity.</p>
<p>Another important aspect is that the model can be customized and fine-tuned which enhances the efficiency and align with our needs. But it also comes with a drawback because it requires local CPU/GPU resources and older graphic cards will barely able to handle the huge amount of computing to serve as a stable resource for the local AI/LLM. However, on the other hand you won’t have any additional costs except the ones used to produce the electricity.</p>
<hr>
<h3 id="lm-studio">LM Studio</h3>
<p>One of the most efficient and easiest application that can be used to host a local AI/LLM is <a href="https://lmstudio.ai/">LM Studio</a>. It allows us to discover a diverse array of models from different resources like <a href="https://huggingface.co/">Hugging Face</a>, download them and let those models solve our tasks. Another advantages is that it eliminates the need and dependency of an external server which at the same time allows us to use the locally hosted server with the AI/LLM for terminal based applications. It also offers three different modes:</p>
<ul>
<li>User</li>
<li>Power User</li>
<li>Developer</li>
</ul>
<p>The developer mode is the one where the most customization and configuration is available. Let’s visit their homepage and download LM Studio.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/self1.png" alt="LM Studio homepage with download options for AI tools like Llama and DeepSeek."></p>
<p>Once downloaded, let’s go into the Downloads directory and run it with the following commands:</p>
<p>&#x20; Self Hosting AI</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-symbol">@ubuntu</span>:~$ cd ~/Downloads
cry0l1t3<span class="hljs-symbol">@ubuntu</span>:~$ ./LM-Studio
</code></pre>
<p>A new window will appear which will ask you to download your first LLM and load it.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/self2.png" alt="Downloading Llama model, progress at 17%, optimized for multilingual dialogue."></p>
<p>After the LLM has been downloaded, we will need to tell LM Studio which model it needs to use. In the middle at the top you will see a select field that you can click and will show you models that you have downloaded. At the bottom you will see the modes. It’s recommended to change to the <code>developer</code> mode since it enables the most functions. Then at the top right, you will see a button that expands a sidebar with even more configuration options.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/self3.png" alt="LM Studio interface with a chat about Hack The Box Academy, using Llama model."></p>
<p>On the left sidebar, you will see a search button that will open a new window with a list of available LLMs. Feel free to look around and check which model fit your hardware. LM Studio will tell if your hardware meets the requirements for a specific LLM or not.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/self4.png" alt="LM Studio interface showing model search for Gemma 3 4B QAT with download option."></p>
<p>When we click on the shell button in the left sidebar we will see an option with settings to launch a local API server. This allows us to make API requests through the terminal or code to ask the locally hosted LLM to process certain information.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/self5.png" alt="LM Studio settings interface with server status stopped and model information displayed."></p>
<p>Let’s run the server and use <code>curlie</code> to make a simple request.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/self6.png" alt="Terminal and LM Studio interface showing a curl command for chat completion with JSON response, indicating today is Thursday."></p>
<hr>
<h2 id="ai-in-the-terminal">AI in the Terminal</h2>
<hr>
<p>LM Studio also comes with a python library which allows us to use downloaded LLMs to programmatically utilize them in our code. Therefore, we need to create a virtual environment with <code>venv</code> first and activate it using the following commands:</p>
<p>&#x20; AI in the Terminal</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>python3 -m venv .
cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>source ./bin/activate
</code></pre>
<p>After that, you will see the name of the virtual environment that we just created in your prompt which indicates that we currently are working in it. It allows us to install python libraries in an isolated environment instead of globally on the system.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/ai1.png" alt="Terminal showing commands to create and activate a Python virtual environment in lmstudio directory."></p>
<p>Next, let’s install the <code>lmstudio</code> python library and write a simple python code using the following commands:</p>
<p>&#x20; AI in the Terminal</p>
<pre><code class="lang-shell-session">cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>pip install lmstudio
cry0l1t3<span class="hljs-variable">@ubuntu</span><span class="hljs-symbol">:~</span><span class="hljs-variable">$ </span>nvim mycode.py
</code></pre>
<p>The python code consists of importing the <code>lmstudio</code> library that we’ve just installed, the assignment of the LLM model that we have downloaded with LM Studio before, and a request that we send to the LLM to process. At the end we print the result of the generated response from the LLM.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/ai2.png" alt="Code editor showing Python script using lmstudio to query Llama model about Hack The Box Academy."></p>
<p>Let’s see how it works by executing it.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/ai3.png" alt="Terminal displaying Python script output analyzing Hack The Box, highlighting its engaging challenges and community support."></p>
<p>As you can see, it will reply in the markdown format but can be enhanced further if needed. More information about configuration and advanced use cases like configuring the LLM for structured output can be found <a href="https://lmstudio.ai/docs/app/api/structured-output">here</a>.</p>
<p>Now, we have a simple program that allows us to use a locally hosted AI/LLM in our terminal.</p>
<hr>
<h3 id="wave-terminal">Wave Terminal</h3>
<p>Now, let’s connect the Wave Terminal with LM Studio server. In Wave Terminal, we can click on the AI widget in the right sidebar and a new chat window will appear. At the top of this chat window we can select an AI preset that we want to use. Presets are configuration files that tell Wave Terminal which AI model you want to use and where it should send requests to. At this stage, we can create a new preset and configure it like following:</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/ai4.png" alt="Code editor with JSON configuration for a local LLM and LM Studio interface showing model status and endpoints."></p>
<p>Make sure that your LM Studio server is running. Once you have added all the necessary details and saved them, you will find a new preset in the list.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/ai5.png" alt="Terminal and LM Studio interface showing a local LLM configuration with model status and endpoints."></p>
<p>More information about preset settings can be found <a href="https://docs.waveterm.dev/ai-presets">here</a>. Once we have selected the Local LLM preset, we can interact with it just as we would with Grok, Claude, or ChatGPT. The main difference is that it runs locally, and no data is submitted to third parties.</p>
<p><img src="https://academy.hackthebox.com/storage/modules/87/ai6.png" alt="Wave AI interface discussing Hack The Box Academy&#39;s hands-on learning and LM Studio showing model status and endpoints."></p>
<hr>
<h3 id="warp-terminal">Warp Terminal</h3>
<p><a href="https://www.warp.dev/">Warp Terminal</a> is a relatively new terminal emulator designed to enhance productivity through AI integration and collaboration tools. It features an IDE-like interface and is available for Windows, macOS, and Linux systems. One of its standout features is Warp AI, which leverages natural language processing to offer real-time command suggestions, explanations, and error debugging. For example, typing &quot;list&quot; might prompt Warp to suggest <code>ls -al</code>, along with a plain-language explanation of its function. Users can also interact with Warp AI conversationally, asking it to generate code or troubleshoot issues without leaving the terminal.</p>
<p>However, a huge disadvantage is that you (as a non-enterprise user) cannot use your own LLM without subscribing to the Enterprise plan. However, if you want to install Warp Terminal and try it out, you can download the installation package from the homepage and install it with the following commands:</p>
<p>&#x20; AI in the Terminal</p>
<pre><code class="lang-shell-session"><span class="hljs-symbol">cry0l1t3@ubuntu:</span>~$ cd ~/Downloads
<span class="hljs-symbol">cry0l1t3@ubuntu:</span>~$ sudo apt install ./warp-terminal_0<span class="hljs-meta">.2025</span><span class="hljs-meta">.04</span><span class="hljs-meta">.23</span><span class="hljs-meta">.08</span><span class="hljs-meta">.11</span>.stable.01_amd64.deb
<span class="hljs-symbol">cry0l1t3@ubuntu:</span>~$ warp-terminal
</code></pre>
<p><img src="https://academy.hackthebox.com/storage/modules/87/ai7.png" alt="Parrot Linux desktop for Hack The Box with guidelines on internet access, data storage, and customization options."></p>
<p>Finally, use whatever tool and setup that feels best for you and meets your needs. Setting up a cross-platform environment will increase your productivity and efficiency dramatically. The best outcome is when you can work on a single screen without needing to use your mouse. Optimize your environment in such a way that you can move around and make changes to files and systems quickly and efficiently.</p>
<p>We also highly recommend you to apply/set up the same settings for all systems Windows, Linux, and MacOS. Prepare a script for each and store these scripts on Github or your VPS. Ensure that the keystrokes are cross-platform compatible and consistent so you don’t need to remember what settings you set for each of your systems. Take your time to configure your setup and get familiar with it. Design it the way you want and make it look beautiful and comfortable for you.</p>
<p>This will greatly enhance your productivity and efficiency in the long run—and make your work more enjoyable as well.</p>
<hr>

